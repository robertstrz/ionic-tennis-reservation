/*!CK:93036455!*//*1433852123,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["yVCbU"]); }

__d("FBRTCCallConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FBRTCCallConnectionType:{MISSED_CALL:4,CONNECTED_CALL:5},FBRTCCallType:{VOICE_CALL:1,VIDEO_CALL:2}};},null);
__d("StarsInput.react",["React","TooltipLink.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g,l=k.PropTypes,m=g.createClass({displayName:"StarsInput",propTypes:{allowMultipleSubmissions:l.bool,onClick:l.func.isRequired,starLabels:l.array},getDefaultProps:function(){return {allowMultipleSubmissions:false,starLabels:[j._("\u0179le"),j._("W miar\u0119 dobrze"),j._("Dobrze"),j._("Bardzo dobrze"),j._("Wspaniale")]};},getInitialState:function(){return {starRating:0,starsShown:0,canUpdate:true};},_getStarRating:function(n){return parseInt(n.split('.').pop(),10)+1;},onMouseEnter:function(event){if(this.state.canUpdate)this.setState({starsShown:this._getStarRating(event.dispatchMarker)});},onMouseLeave:function(event){if(this.state.canUpdate){var n=this.state.starRating;this.setState({starsShown:n});}},onClick:function(event){if(this.state.canUpdate){var n=this._getStarRating(event.dispatchMarker);this.setState({starRating:n,starsShown:n,canUpdate:this.props.allowMultipleSubmissions});this.props.onClick(n);}},getStars:function(){var n=this.props.starLabels.length,o=[];for(var p=0;p<n;p++)o.push(g.createElement(h,{className:(("mls")+(' '+"_22mm")+(p>=this.state.starsShown?' '+"_22mn":'')+(p<this.state.starsShown?' '+"_22mo":'')+(!this.state.canUpdate?' '+"_1g87":'')),tooltip:this.props.starLabels[p],onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,position:"above",alignH:"center"}));return o;},render:function(){return (g.createElement("div",null,this.getStars()));}});e.exports=m;},null);
__d("XVideoCallAdminMessageController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/videocall\/admin_msg\/",{});},null);
__d("FBRTCAdminMessage",["FBRTCCallConstants","FBRTCLogger","FBRTCUtils","XVideoCallAdminMessageController","emptyFunction","performanceNow"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(n,o){"use strict";this.$FBRTCAdminMessage0=n;this.$FBRTCAdminMessage1=o;this.$FBRTCAdminMessage2=Date.now();this.$FBRTCAdminMessage3=null;this.$FBRTCAdminMessage4=null;}m.prototype.onCallConnected=function(){"use strict";if(!this.$FBRTCAdminMessage3)this.$FBRTCAdminMessage3=l();};m.prototype.onCallEnded=function(){"use strict";if(!this.$FBRTCAdminMessage4)this.$FBRTCAdminMessage4=l();};m.prototype.submit=function(n){"use strict";if(!this.$FBRTCAdminMessage4)this.onCallEnded();var o=0,p=g.FBRTCCallConnectionType.MISSED_CALL;if(this.$FBRTCAdminMessage3){o=Math.ceil(this.$FBRTCAdminMessage4-this.$FBRTCAdminMessage3);p=g.FBRTCCallConnectionType.CONNECTED_CALL;}this.$FBRTCAdminMessage5({peer_id:this.$FBRTCAdminMessage0,call_id:this.$FBRTCAdminMessage1,start_time:this.$FBRTCAdminMessage2,call_duration:o,message_type:p,call_category:n});};m.prototype.$FBRTCAdminMessage5=function(n){"use strict";var o=j.getURIBuilder().getURI();i.sendServerRequest(o,k,this.$FBRTCAdminMessage6.bind(this,n.peer_id,n.call_id),false,null,n);};m.prototype.$FBRTCAdminMessage6=function(n,o,p){"use strict";var q;if(p){q='Fail to log admin message, error '+p.error;}else q='Server timed out on logging admin message';h.getInstance().logError(n,o,q);};e.exports=m;},null);
__d("FBRTCPCConfig",["FBRTCVersionDetection"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h="stun:stun.fbsbx.com:3478",i=function(k,l,m){if(g.isChrome()&&g.webrtcVersion()>=34){var n={urls:k};if(l&&m){n.username=l;n.credential=m;}return [n];}var o=[];for(var p=0;p<k.length;p++)if(l&&m){o.push({url:k[p],username:l,credential:m});}else o.push({url:k[p]});return o;},j={setTurnCredentials:function(k){this.turnIP=k.ip;this.udpPort=k.udp_port;this.tcpPort=k.tcp_port;this.sslPort=k.ssl_tcp_port;this.turnUsername=k.username;this.turnPassword=k.password;},getConfig:function(){var k=i([h]).concat(i(this._turnUrls(),this.turnUsername,this.turnPassword));return {iceServers:k};},getConstraints:function(){return {mandatory:{},optional:[{DtlsSrtpKeyAgreement:'true'}]};},_turnUrls:function(){if(g.isFirefox()&&g.webrtcVersion()<27){return [("turn:"+this.turnIP+":"+this.udpPort)];}else return [("turn:"+this.turnIP+":"+this.udpPort+"?transport=udp"),("turn:"+this.turnIP+":"+this.tcpPort+"?transport=tcp"),("turn:"+this.turnIP+":"+this.sslPort+"?transport=tcp")];}};e.exports=j;},null);
__d("FBRTCSdpUtils",["UserAgent"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h='m=video 0',i=function(l){return l.match(/^a=rtpmap:(\d+)\s/)[1];},j=function(l,m,n){var o=i(l[m]),p=l[n].split('RTP/SAVPF'),q=p[1].split(/\s+/),r=q.indexOf(o);q.splice(r,1);p[1]=q.join(' ');l[n]=p.join('RTP/SAVPF');l.splice(m,1);},k={addIceOptionToSdp:function(l,m){"use strict";var n="a=ice-options:",o=l.indexOf(n);if(o>=0){var p=l.indexOf("\r",o);return [l.slice(0,p)," ",m,l.slice(p)].join('');}var q=n+m,r=l.split("\r\n"),s=false,t=-1;for(var u=0;u<r.length;u++){var v=r[u].slice(0,2);if(v=="s="){s=true;continue;}if(s&&v=="a="){t=u;break;}}if(t>=0){r.splice(t,0,q);return r.join("\r\n");}return [l,q,"\r\n"].join('');},preferIsac:function(l){var m=l.split("\r\n"),n=-1,o=-1,p=-1;for(var q=0;q<m.length;q++){var r=m[q];if(r.match(/m=audio\s+\d+\s+RTP\/SAVPF(\s+\d+)+/))n=q;if(p===-1&&n>-1&&r.match(/^a=rtpmap:/))p=q;if(r.match(/^a=rtpmap:\d+\s+ISAC\/16000/))o=q;}if(n===-1||o===-1||p===-1)return m.join("\r\n");var s=m[o];j(m,o,n);m.splice(p,0,s);m[n]=m[n].replace('RTP/SAVPF','RTP/SAVPF '+i(s));return m.join("\r\n");},disableVideo:function(l){var m=/m=video\s+\S+/;l=l.replace(m,h);if(g.isBrowser('Firefox <= 37'))l=this._makeDisabledVideoReceiveOnly(l);return l;},_makeDisabledVideoReceiveOnly:function(l){if(l.indexOf(h)>-1){var m=l.split(h);m[1]=m[1].replace(/send(recv|only)/,'recvonly');l=m.join(h);}return l;},removeBadCodecLines:function(l){var m=l.split("\r\n"),n=-1,o=[],p;for(p=0;p<m.length;p++){var q=m[p];if(q.match(/m=audio\s+\d+\s+RTP\/SAVPF(\s+\d+)+/)){n=p;continue;}if(q.match(/^a=rtpmap:\d+\s+\/\d+/))o.push(p);}if(n===-1||!o)return m.join("\r\n");o.sort(function(r,s){return (s-r);});if(o)for(p=0;p<o.length;p++)j(m,o[p],n);return m.join("\r\n");},fixMobileIceSdp:function(l){l=l.replace(/^a=/,'');l=l.split(/\s+username\s+.+password.+/)[0];var m=l.match(/\s+relay\s+|\s+srflx\s+/),n=l.match(/raddr.+rport.+/);if(m&&!n){m=m[0];var o=l.split(m),p=o[1].match(/^(\d+\.\d+\.\d+\.\d+)\s+(\d+)\s+/),q,r;if(p){q=p[1];r=p[2];o[1]=o[1].replace(p[0],'');}else{p=o[0].split(/\s+/);q=p[4];r=p[5];}l=(""+o[0]+m+"raddr "+q+" rport "+r+" "+o[1]);}return l;},isVideoSupported:function(l){return (l&&l.indexOf('m=video')>-1&&l.indexOf(h)===-1);},setDtlsRole:function(l,m){if(!l.match(/setup:(active|passive|actpass)/)){return l.replace(/(a=fingerprint:.+)/g,("$1\r\na=setup:"+m));}else return l.replace(/setup:actpass/g,("setup:"+m));},removeSdparta:function(l){var m=l.split('\r\n'),n='audio',o=false,p=-1;for(var q=0;q<m.length;q++){var r=m[q];if(r.indexOf('m=audio')===0)n='audio';if(r.indexOf('m=video')===0){o=true;n='video';}if(r.indexOf('a=mid:sdparta_')===0)m[q]=("a=mid:"+n);if(r.indexOf('a=group:BUNDLE sdparta_')===0)p=q;}if(p>-1)if(o){m[p]='a=group:BUNDLE audio video';}else m[p]='a=group:BUNDLE audio';return m.join('\r\n');}};e.exports=k;},null);
__d("FBRTCStatsHelpers",["FBRTCLogger"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=function(j){if(j==='host'||j==='local')return 'local';if(j==='serverreflexive')return 'srflx';if(j==='peerreflexive')return 'prflx';if(j==='relayed'||j==='relay')return 'relay';return 'unknown';},i={connectionType:function(j,k,l,m){return ['l:',h(j),'-',k,';','r:',h(l),'-',m].join('');},logReport:function(j){var k=g.getInstance(),l=['connectionType','audioCodec','videoCodec','audioRtt','videoRtt','audioPacketsLost','videoPacketsLost','audioBytesSent','videoBytesSent','audioPacketsSent','videoPacketsSent'];for(var m=0;m<l.length;m++){var n=j[l[m]].call(j);k.logToConsole(l[m]+' => '+n);}}};e.exports=i;},null);
__d("FBRTCMozStatsReport",["Map","FBRTCLogger","FBRTCStatsHelpers"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(){"use strict";this.$FBRTCMozStatsReport0=null;this.$FBRTCMozStatsReport1=null;this.$FBRTCMozStatsReport2=null;this.$FBRTCMozStatsReport3=null;this.candidates=new g();this.candidatePairs=new g();this.$FBRTCMozStatsReport4=h.getInstance();}j.prototype.parseReport=function(k){"use strict";k.forEach(function(l){switch(l.type){case 'inboundrtp':if(!l.remoteId)break;var m={inbound:l,outbound:k[l.remoteId]};if(l.isRemote){if(m.outbound.hasOwnProperty('framerateMean')){this.$FBRTCMozStatsReport1=m;}else this.$FBRTCMozStatsReport0=m;}else if(m.outbound.hasOwnProperty('framerateMean')){this.$FBRTCMozStatsReport3=m;}else this.$FBRTCMozStatsReport2=m;break;case 'outboundrtp':break;case 'candidatepair':if(l.state==='succeeded')this.candidatePairs.set(l.id,l);break;case 'localcandidate':this.candidates.set(l.id,l);break;case 'remotecandidate':this.candidates.set(l.id,l);break;default:this.$FBRTCMozStatsReport4.logToConsole('unrecognized webrtc stats type '+l.type);break;}}.bind(this));};j.prototype.isConnected=function(){"use strict";return !!this.$FBRTCMozStatsReport0;};j.prototype.audioRtt=function(){"use strict";if(!this.$FBRTCMozStatsReport0)return 0;return this.$FBRTCMozStatsReport0.inbound.mozRtt;};j.prototype.videoRtt=function(){"use strict";if(!this.$FBRTCMozStatsReport1)return 0;return this.$FBRTCMozStatsReport1.inbound.mozRtt;};j.prototype.audioCodec=function(){"use strict";return 'opus';};j.prototype.videoCodec=function(){"use strict";return 'VP8';};j.prototype.audioPacketsLost=function(){"use strict";if(!this.$FBRTCMozStatsReport0)return 0;return this.$FBRTCMozStatsReport0.inbound.packetsLost;};j.prototype.setVideoPacketsLost=function(k){"use strict";};j.prototype.videoPacketsLost=function(){"use strict";if(!this.$FBRTCMozStatsReport1)return 0;return this.$FBRTCMozStatsReport1.inbound.packetsLost;};j.prototype.audioBytesSent=function(){"use strict";if(!this.$FBRTCMozStatsReport0)return 0;return this.$FBRTCMozStatsReport0.outbound.bytesSent;};j.prototype.videoBytesSent=function(){"use strict";if(!this.$FBRTCMozStatsReport1)return 0;return this.$FBRTCMozStatsReport1.outbound.bytesSent;};j.prototype.audioPacketsSent=function(){"use strict";if(!this.$FBRTCMozStatsReport0)return 0;return this.$FBRTCMozStatsReport0.outbound.packetsSent;};j.prototype.videoPacketsSent=function(){"use strict";if(!this.$FBRTCMozStatsReport1)return 0;return this.$FBRTCMozStatsReport1.outbound.packetsSent;};j.prototype.videoFrameRateSent=function(){"use strict";if(!this.$FBRTCMozStatsReport1)return 0;return this.$FBRTCMozStatsReport1.outbound.framerateMean;};j.prototype.videoFrameRateCaptured=function(){"use strict";if(!this.$FBRTCMozStatsReport1)return 0;return 30;};j.prototype.connectionType=function(){"use strict";var k='unknown',l='unknown',m='unknown',n='unknown';this.candidatePairs.forEach(function(o){var p=this.candidates.get(o.localCandidateId),q=this.candidates.get(o.remoteCandidateId);k=p.transport;m=q.transport;l=p.candidateType;n=q.candidateType;}.bind(this));return i.connectionType(l,k,n,m);};e.exports=j;},null);
__d("FBRTCChromeStatsReport",["FBRTCStatsHelpers"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=function(j,k){return parseInt(j.stat(k),10);};function i(){"use strict";this.$FBRTCChromeStatsReport0=[];this.$FBRTCChromeStatsReport1=null;this.$FBRTCChromeStatsReport2=null;this.$FBRTCChromeStatsReport3=null;this.$FBRTCChromeStatsReport4=null;this.$FBRTCChromeStatsReport5=null;}i.prototype.parseReport=function(j){"use strict";j.result().forEach(function(k){if(k.type==="googCandidatePair"&&k.stat('googActiveConnection')==='true')this.$FBRTCChromeStatsReport0.push(k);if(this.$FBRTCChromeStatsReport6(k))this.$FBRTCChromeStatsReport1=k;if(this.$FBRTCChromeStatsReport7(k))this.$FBRTCChromeStatsReport2=k;if(this.$FBRTCChromeStatsReport8(k))this.$FBRTCChromeStatsReport3=k;if(this.$FBRTCChromeStatsReport9(k))this.$FBRTCChromeStatsReport4=k;if(k.type==='VideoBwe')this.$FBRTCChromeStatsReport5=k;}.bind(this));};i.prototype.isConnected=function(){"use strict";return true;};i.prototype.audioRtt=function(){"use strict";if(!this.$FBRTCChromeStatsReport1)return 0;return h(this.$FBRTCChromeStatsReport1,'googRtt');};i.prototype.videoRtt=function(){"use strict";if(!this.$FBRTCChromeStatsReport2)return 0;return h(this.$FBRTCChromeStatsReport2,'googRtt');};i.prototype.audioCodec=function(){"use strict";if(!this.$FBRTCChromeStatsReport1)return 'unknown';return this.$FBRTCChromeStatsReport1.stat('googCodecName');};i.prototype.videoCodec=function(){"use strict";if(!this.$FBRTCChromeStatsReport2)return 'unknown';return this.$FBRTCChromeStatsReport2.stat('googCodecName');};i.prototype.audioPacketsLost=function(){"use strict";if(!this.$FBRTCChromeStatsReport1)return 0;return h(this.$FBRTCChromeStatsReport1,'packetsLost');};i.prototype.setVideoPacketsLost=function(j){"use strict";this.$FBRTCChromeStatsReporta=j;};i.prototype.videoPacketsLost=function(){"use strict";if(!this.$FBRTCChromeStatsReport2)return 0;if(this.$FBRTCChromeStatsReporta)return this.$FBRTCChromeStatsReporta;return h(this.$FBRTCChromeStatsReport2,'packetsLost');};i.prototype.audioBytesSent=function(){"use strict";if(!this.$FBRTCChromeStatsReport1)return 0;return h(this.$FBRTCChromeStatsReport1,'bytesSent');};i.prototype.videoBytesSent=function(){"use strict";if(!this.$FBRTCChromeStatsReport2)return 0;return h(this.$FBRTCChromeStatsReport2,'bytesSent');};i.prototype.audioPacketsSent=function(){"use strict";if(!this.$FBRTCChromeStatsReport1)return 0;return h(this.$FBRTCChromeStatsReport1,'packetsSent');};i.prototype.videoPacketsSent=function(){"use strict";if(!this.$FBRTCChromeStatsReport2)return 0;return h(this.$FBRTCChromeStatsReport2,'packetsSent');};i.prototype.videoFrameRateSent=function(){"use strict";if(!this.$FBRTCChromeStatsReport2)return 0;return h(this.$FBRTCChromeStatsReport2,'googFrameRateSent');};i.prototype.videoFrameRateCaptured=function(){"use strict";if(!this.$FBRTCChromeStatsReport2)return 0;return h(this.$FBRTCChromeStatsReport2,'googFrameRateInput');};i.prototype.connectionType=function(){"use strict";var j='unknown',k='unknown',l='unknown';for(var m=0;m<this.$FBRTCChromeStatsReport0.length;m++){var n=this.$FBRTCChromeStatsReport0[m];k=n.stat('googLocalCandidateType');l=n.stat('googRemoteCandidateType');j=n.stat('googTransportType');}return g.connectionType(k,j,l,j);};i.prototype.$FBRTCChromeStatsReport6=function(j){"use strict";return j.type==='ssrc'&&j.names().indexOf('audioInputLevel')>-1;};i.prototype.$FBRTCChromeStatsReport7=function(j){"use strict";return j.type==='ssrc'&&j.names().indexOf('googFrameHeightInput')>-1;};i.prototype.$FBRTCChromeStatsReport8=function(j){"use strict";return j.type==='ssrc'&&j.names().indexOf('audioOutputLevel')>-1;};i.prototype.$FBRTCChromeStatsReport9=function(j){"use strict";return j.type==='ssrc'&&j.names().indexOf('googFrameHeightReceived')>-1;};e.exports=i;},null);
__d("FBRTCStatsReportFactory",["FBRTCMozStatsReport","FBRTCChromeStatsReport","FBRTCLogger","FBRTCVersionDetection"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=function(n,o){n.getStats(null,function(p){var q=new g();q.parseReport(p);o(q);},function(){i.getInstance().logToConsole('Firefox stats collection failed');});},l=function(n,o){n.getStats(function(p){var q=new h();q.parseReport(p);o(q);});},m={getStats:function(n,o){if(j.isFirefox())k(n,o);if(j.isChrome())l(n,o);}};e.exports=m;},null);
__d("FBRTCCallConnection",["FBRTCConfig","FBRTCLogger","FBRTCPCConfig","FBRTCSdpUtils","FBRTCStatsReportFactory","Queue","UserAgent","invariant","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=300000,q=12000,r=10000,s='data';function t(){"use strict";this.$FBRTCCallConnection0=h.getInstance();this.$FBRTCCallConnection1();this.$FBRTCCallConnection2=null;this.$FBRTCCallConnection3=null;this.$FBRTCCallConnection4=new l({interval:1,processor:this.$FBRTCCallConnection5.bind(this)});this.$FBRTCCallConnection6=null;this.$FBRTCCallConnection7=null;this.$FBRTCCallConnection8=false;this.$FBRTCCallConnection9=0;this.$FBRTCCallConnectiona=[];this.$FBRTCCallConnectionb=false;this.$FBRTCCallConnectionc='passive';this.$FBRTCCallConnectiond=true;}t.prototype.init=function(u){"use strict";this.$FBRTCCallConnection0.logToConsole('Creating a new peer connection with: '+JSON.stringify(i.getConfig())+', '+JSON.stringify(i.getConstraints()));this.$FBRTCCallConnectione=u;};t.prototype.setStream=function(u){"use strict";this.$FBRTCCallConnectione=u;};t.prototype.addScreenStream=function(u){"use strict";if(u&&u.getStream()){this.$FBRTCCallConnection0.logToConsole('Screen stream added');this.$FBRTCCallConnectionf=u;}else this.$FBRTCCallConnection0.logToConsole('Trying to add invalid stream');};t.prototype.removeScreenStream=function(u){"use strict";if(u&&u.getStream()){this.$FBRTCCallConnection0.logToConsole('Screen stream removed');this.$FBRTCCallConnection2.removeStream(u.getStream());}else this.$FBRTCCallConnection0.logToConsole('Trying to remove invalid stream');this.$FBRTCCallConnectionf=null;};t.prototype.setPeerSupportsVideo=function(u){"use strict";this.$FBRTCCallConnectiond=u;};t.prototype.$FBRTCCallConnectiong=function(u,v){"use strict";this.$FBRTCCallConnectionh(null);u.onaddstream=null;u.onremovestream=null;u.onicecandidate=null;u.oniceconnectionstatechange=null;this.$FBRTCCallConnectiona=[];var w=v?5000:1;setTimeout(function(){if(u.iceConnectionState!=='closed')u.close();},w);};t.prototype.$FBRTCCallConnectioni=function(){"use strict";if(this.$FBRTCCallConnection2)this.$FBRTCCallConnectiong(this.$FBRTCCallConnection2,true);var u=new this.nativePeerConnection(i.getConfig(),i.getConstraints());this.$FBRTCCallConnectionc='passive';u.onaddstream=this.$FBRTCCallConnectionj.bind(this);u.onremovestream=this.$FBRTCCallConnectionk.bind(this);u.onicecandidate=this.$FBRTCCallConnectionl.bind(this);u.oniceconnectionstatechange=this.$FBRTCCallConnectionm.bind(this);u.addStream(this.$FBRTCCallConnectione.getStream());return u;};t.prototype.$FBRTCCallConnectionh=function(u){"use strict";this.$FBRTCCallConnection4.stop(true);if(this.isDataChannelOpen())this.$FBRTCCallConnection3.close();this.$FBRTCCallConnection3=u;if(!u)return;this.$FBRTCCallConnection3.onopen=this.$FBRTCCallConnectionn.bind(this);this.$FBRTCCallConnection3.onclose=this.$FBRTCCallConnectiono.bind(this);this.$FBRTCCallConnection3.onerror=this.$FBRTCCallConnectionp.bind(this);this.$FBRTCCallConnection3.onmessage=this.$FBRTCCallConnectionq.bind(this);};t.prototype.$FBRTCCallConnectionn=function(event){"use strict";this.$FBRTCCallConnection4.start();this.emit('data_opened',event);};t.prototype.$FBRTCCallConnectiono=function(event){"use strict";this.$FBRTCCallConnectionh(null);this.emit('data_closed',event);};t.prototype.$FBRTCCallConnectionp=function(event){"use strict";this.$FBRTCCallConnectionh(null);this.emit('data_error',event);};t.prototype.$FBRTCCallConnectionq=function(event){"use strict";this.emit('data_message',JSON.parse(event.data).msg);};t.prototype.isDataChannelOpen=function(){"use strict";return (!!this.$FBRTCCallConnection3&&this.$FBRTCCallConnection3.readyState==='open');};t.prototype.sendData=function(u){"use strict";this.$FBRTCCallConnection4.enqueue(JSON.stringify({msg:u}));};t.prototype.$FBRTCCallConnection5=function(u){"use strict";if(!this.isDataChannelOpen()){n(false);return;}this.$FBRTCCallConnection3.send(u);};t.prototype.createOffer=function(){"use strict";this.$FBRTCCallConnection2=this.$FBRTCCallConnectioni();if(g.shouldCreateDataChannel())this.$FBRTCCallConnectionh(this.$FBRTCCallConnection2.createDataChannel(s));this.$FBRTCCallConnectionr('offer');this.$FBRTCCallConnectionc='active';};t.prototype.createSdpUpdate=function(){"use strict";var u=this.$FBRTCCallConnection2.getLocalStreams();for(var v=0;v<u.length;v++)this.$FBRTCCallConnection2.removeStream(u[v]);this.$FBRTCCallConnection2.addStream(this.$FBRTCCallConnectione.getStream());if(this.$FBRTCCallConnectionf)this.$FBRTCCallConnection2.addStream(this.$FBRTCCallConnectionf.getStream());this.$FBRTCCallConnectionr('sdp_update');};t.prototype.$FBRTCCallConnectionr=function(u){"use strict";this.$FBRTCCallConnectionb=true;this.$FBRTCCallConnection2.createOffer(this.$FBRTCCallConnections.bind(this,u),this.$FBRTCCallConnectiont.bind(this,'CreateOfferFailed'),this.$FBRTCCallConnectionu());};t.prototype.$FBRTCCallConnectionu=function(){"use strict";if(m.isBrowser('Chrome <= 37')||m.isBrowser('Opera <= 25'))return {mandatory:{OfferToReceiveAudio:true,OfferToReceiveVideo:this.$FBRTCCallConnectiond}};return {offerToReceiveAudio:true,offerToReceiveVideo:this.$FBRTCCallConnectiond};};t.prototype.end=function(){"use strict";this.$FBRTCCallConnection0.logToConsole('Ending connection...');if(this.$FBRTCCallConnection2){this.emit('isEnding');this.$FBRTCCallConnectiong(this.$FBRTCCallConnection2,false);this.$FBRTCCallConnection2=null;}};t.prototype.onReceivedOfferSDP=function(u){"use strict";this.$FBRTCCallConnection2=this.$FBRTCCallConnectioni();if(g.shouldCreateDataChannel())this.$FBRTCCallConnection2.ondatachannel=function(event){this.$FBRTCCallConnectionh(event.channel);}.bind(this);var v=new this.nativeSessionDescription({type:'offer',sdp:u});this.$FBRTCCallConnection2.setRemoteDescription(v,this.$FBRTCCallConnectionv.bind(this,v),this.$FBRTCCallConnectiont.bind(this,'SetRemoteOfferFailed'));};t.prototype.onReceivedAnswerSDP=function(u){"use strict";var v=new this.nativeSessionDescription({type:'answer',sdp:u});this.$FBRTCCallConnection2.setRemoteDescription(v,this.$FBRTCCallConnectionv.bind(this,v),this.$FBRTCCallConnectiont.bind(this,'SetRemoteAnswerFailed'));};t.prototype.onReceivedSdpUpdate=function(u){"use strict";if(this.$FBRTCCallConnectionb)setTimeout(function(){this.onReceivedSdpUpdate(u);}.bind(this),200);switch(this.$FBRTCCallConnection2.signalingState){case 'stable':this.$FBRTCCallConnectionw(u,'offer');break;case 'have-local-offer':u=j.setDtlsRole(u,this.$FBRTCCallConnectionc);this.$FBRTCCallConnectionw(u,'answer');break;case 'have-remote-offer':setTimeout(function(){this.onReceivedSdpUpdate(u);}.bind(this),1000);break;case 'have-local-pranswer':case 'have-remote-pranswer':break;case 'closed':break;}};t.prototype.$FBRTCCallConnectionw=function(u,v){"use strict";var w=new this.nativeSessionDescription({type:v,sdp:u});this.$FBRTCCallConnectionb=true;this.$FBRTCCallConnection2.setRemoteDescription(w,function(){this.$FBRTCCallConnection0.logToConsole('sdp update '+w.type+' set');if(this.$FBRTCCallConnection2&&w.type==='offer'){this.$FBRTCCallConnection2.createAnswer(this.$FBRTCCallConnections.bind(this,'sdp_update'),this.$FBRTCCallConnectiont.bind(this,'CreateSdpUpdateFailed'));}else this.$FBRTCCallConnectionb=false;}.bind(this),this.$FBRTCCallConnectiont.bind(this,'SetRemoteSdpUpdateFailed'));};t.prototype.onReceivedRemoteIceCandidate=function(u){"use strict";u.sdp=j.fixMobileIceSdp(u.sdp);var v=new this.nativeIceCandidate({sdpMLineIndex:u.label,candidate:u.sdp,sdpMid:u.sdp_mid});this.$FBRTCCallConnection2.addIceCandidate(v);};t.prototype.getStats=function(u){"use strict";k.getStats(this.$FBRTCCallConnection2,u);};t.prototype.getCreatedIceCandidates=function(){"use strict";return this.$FBRTCCallConnectiona;};t.prototype.$FBRTCCallConnections=function(u,v){"use strict";this.$FBRTCCallConnection0.logToConsole('Created '+u+' sdp');if(!this.$FBRTCCallConnection2){this.$FBRTCCallConnection0.logToConsole('_onSDPCreated: pc has been deallocated');return;}if(!this.$FBRTCCallConnectiond&&u==='sdp_update')v.sdp=j.disableVideo(v.sdp);v.sdp=j.addIceOptionToSdp(v.sdp,"fb-force-5245");v.sdp=j.preferIsac(v.sdp);v.sdp=j.removeSdparta(v.sdp);this.$FBRTCCallConnection2.setLocalDescription(v,function(){this.$FBRTCCallConnectionb=false;this.$FBRTCCallConnection0.logToConsole('Local '+u+' set');this.emit('sdpCreated',{type:u,sdp:v.sdp});}.bind(this),this.$FBRTCCallConnectiont.bind(this,("SetLocalDescriptionFailed:"+u)));};t.prototype.$FBRTCCallConnectionv=function(u){"use strict";this.$FBRTCCallConnection0.logToConsole('Remote '+u.type+' set');if(!this.$FBRTCCallConnection2){this.$FBRTCCallConnection0.logToConsole('_onRemoteDescriptionSet: pc has been deallocated');return;}if(u.type==='offer')this.$FBRTCCallConnection2.createAnswer(this.$FBRTCCallConnections.bind(this,'answer'),this.$FBRTCCallConnectiont.bind(this,'CreateAnswerFailed'));this.emit('remoteDescriptionSet');};t.prototype.$FBRTCCallConnectionj=function(event){"use strict";this.$FBRTCCallConnection0.logToConsole('Remote stream added');this.emit('remoteStreamAdded',{stream:event.stream});};t.prototype.$FBRTCCallConnectionk=function(event){"use strict";this.$FBRTCCallConnection0.logToConsole('Remote stream removed');this.emit('remoteStreamRemoved',{stream:event.stream});};t.prototype.$FBRTCCallConnectionl=function(event){"use strict";if(event.candidate){this.$FBRTCCallConnectiona.push(event.candidate);this.emit('localIceCandidateCreated',event.candidate);}};t.prototype.$FBRTCCallConnectionm=function(event){"use strict";var u=event.target.iceConnectionState;this.$FBRTCCallConnection0.logToConsole('Ice candidate state changed from '+this.$FBRTCCallConnection6+' to '+u);if(u===this.$FBRTCCallConnection6)return;this.$FBRTCCallConnectionx();if(this.$FBRTCCallConnectiony(u)){if(!this.$FBRTCCallConnection8){this.emit('connected');this.$FBRTCCallConnection8=true;}}else if(u==='disconnected'){this.$FBRTCCallConnectionz();}else if(u==='failed')this.$FBRTCCallConnectionA();this.$FBRTCCallConnection6=u;};t.prototype.$FBRTCCallConnectiony=function(u){"use strict";return (u==='completed'||u==='connected');};t.prototype.$FBRTCCallConnectionz=function(){"use strict";if(this.$FBRTCCallConnectiony(this.$FBRTCCallConnection6)){var u=Date.now();if(this.$FBRTCCallConnectionB-u>=p)this.$FBRTCCallConnection9=0;this.$FBRTCCallConnection9=this.$FBRTCCallConnection9+1;this.$FBRTCCallConnectionB=u;if(this.$FBRTCCallConnection9>=2)this.emit('connectionUnstable');}var v=this;this.$FBRTCCallConnection7=setTimeout(function(){v.emit('disconnected');},q);};t.prototype.$FBRTCCallConnectionA=function(){"use strict";var u=this;this.$FBRTCCallConnection7=setTimeout(function(){var v={details:'Ice candidate state failed',endCallSubreason:'IceFailed'};u.emit('connectionError',v);},r);};t.prototype.$FBRTCCallConnectionx=function(){"use strict";if(this.$FBRTCCallConnection7)clearTimeout(this.$FBRTCCallConnection7);this.$FBRTCCallConnection7=null;};t.prototype.$FBRTCCallConnectiont=function(u,v){"use strict";var w={details:v,endCallSubreason:u};this.emit('connectionError',w);};t.prototype.$FBRTCCallConnection1=function(){"use strict";if(window.webkitRTCPeerConnection){this.$FBRTCCallConnection0.logToConsole('Using Chrome WebRTC APIs...');this.nativePeerConnection=window.webkitRTCPeerConnection;this.nativeIceCandidate=window.RTCIceCandidate;this.nativeSessionDescription=window.RTCSessionDescription;}else{this.$FBRTCCallConnection0.logToConsole('Using Firefox WebRTC APIs...');this.nativePeerConnection=window.mozRTCPeerConnection;this.nativeIceCandidate=window.mozRTCIceCandidate;this.nativeSessionDescription=window.mozRTCSessionDescription;}};o(t,{remoteStreamAdded:true,remoteStreamRemoved:true,sdpCreated:true,localIceCandidateCreated:true,remoteDescriptionSet:true,connected:true,disconnected:true,connectionUnstable:true,connectionError:true,isEnding:true,data_opened:true,data_closed:true,data_error:true,data_message:true});e.exports=t;},null);
__d("RingBuffer",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){"use strict";this.$RingBuffer0=h;this.$RingBuffer1=-1;this.$RingBuffer2=[];}g.prototype.add=function(h){"use strict";this.$RingBuffer1=(this.$RingBuffer1+1)%this.$RingBuffer0;this.$RingBuffer2[this.$RingBuffer1]=h;};g.prototype.size=function(){"use strict";return this.$RingBuffer2.length;};g.prototype.head=function(){"use strict";if(this.$RingBuffer1===-1)return null;return this.$RingBuffer2[this.$RingBuffer1];};g.prototype.tail=function(){"use strict";if(this.$RingBuffer1===-1)return null;return this.$RingBuffer2[this.$RingBuffer3()];};g.prototype.forEach=function(h){"use strict";for(var i=0;i<this.$RingBuffer2.length;i++){var j=(this.$RingBuffer1+1+i)%this.$RingBuffer2.length;h(this.$RingBuffer2[j]);}};g.prototype.$RingBuffer3=function(){"use strict";return (this.$RingBuffer1+1)%this.$RingBuffer2.length;};e.exports=g;},null);
__d("FBRTCRttAggregator",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(){"use strict";this.$FBRTCRttAggregator0=[{count:0,ave:0},{count:0,ave:0},{count:0,ave:0},{count:0,ave:0}];}g.prototype.addRtt=function(h){"use strict";var i=this.$FBRTCRttAggregator0[this.$FBRTCRttAggregator1(h)];i.ave=this.$FBRTCRttAggregator2(i.ave,i.count,h);i.count+=1;};g.prototype.toString=function(){"use strict";return [this.$FBRTCRttAggregator3('50',this.$FBRTCRttAggregator0[0]),this.$FBRTCRttAggregator3('100',this.$FBRTCRttAggregator0[1]),this.$FBRTCRttAggregator3('200',this.$FBRTCRttAggregator0[2]),this.$FBRTCRttAggregator3('0',this.$FBRTCRttAggregator0[3])].join('|');};g.prototype.$FBRTCRttAggregator3=function(h,i){"use strict";return (""+h+"="+i.count+","+Math.round(i.ave));};g.prototype.$FBRTCRttAggregator1=function(h){"use strict";if(h<50)return 0;if(h<100)return 1;if(h<200)return 2;return 3;};g.prototype.$FBRTCRttAggregator2=function(h,i,j){"use strict";return (h*i+j)/(i+1);};e.exports=g;},null);
__d("FBRTCStatsInterpreter",["FBRTCLogger"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={rtt_weight:2,frr_weight:800,plr_weight:500,score_threshold:1000,bad_score_count:3};function i(j){"use strict";this.$FBRTCStatsInterpreter0=Object.assign({},h,j||{});this.$FBRTCStatsInterpreter1=g.getInstance();this.$FBRTCStatsInterpreter2=0;}i.prototype.interpretStats=function(j,k){"use strict";var l=j.videoRtt(),m=this.$FBRTCStatsInterpreter3(j),n=this.$FBRTCStatsInterpreter4(j,k),o=this.$FBRTCStatsInterpreter5(l,m,n);if(o>=this.$FBRTCStatsInterpreter0.score_threshold&&!this.isNetworkPoor())this.$FBRTCStatsInterpreter2+=1;if(o<this.$FBRTCStatsInterpreter0.score_threshold&&this.$FBRTCStatsInterpreter2>0)this.$FBRTCStatsInterpreter2-=1;};i.prototype.isNetworkPoor=function(){"use strict";return this.$FBRTCStatsInterpreter2>=this.$FBRTCStatsInterpreter0.bad_score_count;};i.prototype.$FBRTCStatsInterpreter5=function(j,k,l){"use strict";return j*this.$FBRTCStatsInterpreter0.rtt_weight+k*this.$FBRTCStatsInterpreter0.frr_weight+l*this.$FBRTCStatsInterpreter0.plr_weight;};i.prototype.$FBRTCStatsInterpreter4=function(j,k){"use strict";var l,m;if(k){l=j.videoPacketsLost()-k.videoPacketsLost();m=j.videoPacketsSent()-k.videoPacketsSent();}else{l=j.videoPacketsLost();m=j.videoPacketsSent();}if(l<0||m===0)return 0;return (l/m);};i.prototype.$FBRTCStatsInterpreter3=function(j){"use strict";if(j.videoFrameRateCaptured()===0)return 0;return 1-(j.videoFrameRateSent()/j.videoFrameRateCaptured());};e.exports=i;},null);
__d("FBRTCCallConnectionMonitor",["RingBuffer","FBRTCRttAggregator","FBRTCStatsInterpreter","FBRTCConfig","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=3000,m=1,n=0,o=3;function p(q,r){"use strict";this.$FBRTCCallConnectionMonitor0=new i(j.statsInterpreterConfig());this.$FBRTCCallConnectionMonitor1=new h();this.$FBRTCCallConnectionMonitor2=new h();this.$FBRTCCallConnectionMonitor3=q;this.$FBRTCCallConnectionMonitor4=r;this.$FBRTCCallConnectionMonitor5=null;this.$FBRTCCallConnectionMonitor6=[];this.$FBRTCCallConnectionMonitor7=new g(m);this.$FBRTCCallConnectionMonitor8=0;this.$FBRTCCallConnectionMonitor3.addListener('connected',this.$FBRTCCallConnectionMonitor9,this);this.$FBRTCCallConnectionMonitor3.addListener('isEnding',this.$FBRTCCallConnectionMonitora,this);}p.prototype.$FBRTCCallConnectionMonitor9=function(){"use strict";var q=this.$FBRTCCallConnectionMonitorb.bind(this);this.$FBRTCCallConnectionMonitor5=setInterval(q,l);this.$FBRTCCallConnectionMonitorb();};p.prototype.$FBRTCCallConnectionMonitora=function(){"use strict";if(this.$FBRTCCallConnectionMonitor5!==null){this.$FBRTCCallConnectionMonitorb();clearInterval(this.$FBRTCCallConnectionMonitor5);this.$FBRTCCallConnectionMonitor5=null;}};p.prototype.$FBRTCCallConnectionMonitorb=function(){"use strict";this.$FBRTCCallConnectionMonitor3.getStats(function(q){var r;if(this.$FBRTCCallConnectionMonitor7.size()>0){r=this.$FBRTCCallConnectionMonitor7.head();this.$FBRTCCallConnectionMonitorc(q,r);}if(this.$FBRTCCallConnectionMonitor6.length<n)this.$FBRTCCallConnectionMonitor6.push(q);if(r&&r.isConnected()&&!q.isConnected())this.$FBRTCCallConnectionMonitor8+=1;if(this.$FBRTCCallConnectionMonitor8>=o)this.$FBRTCCallConnectionMonitor3.emit('disconnected');if(q.isConnected()){this.$FBRTCCallConnectionMonitor8=0;this.$FBRTCCallConnectionMonitor7.add(q);this.$FBRTCCallConnectionMonitor1.addRtt(q.audioRtt());this.$FBRTCCallConnectionMonitor2.addRtt(q.videoRtt());this.$FBRTCCallConnectionMonitor4.setPcStats(this.$FBRTCCallConnectionMonitord());this.$FBRTCCallConnectionMonitore(q,r);}}.bind(this));};p.prototype.$FBRTCCallConnectionMonitord=function(){"use strict";var q=this.$FBRTCCallConnectionMonitor7.head();return {end:{conn_type:q.connectionType()},sender:{bytes:q.audioBytesSent(),codec:{'0':q.audioCodec()},plost:q.audioPacketsLost(),psent:q.audioPacketsSent(),rtt:this.$FBRTCCallConnectionMonitor1.toString()},video:{sender:{bytes:q.videoBytesSent(),codec:{'0':q.videoCodec()},plost:q.videoPacketsLost(),psent:q.videoPacketsSent(),rtt:this.$FBRTCCallConnectionMonitor2.toString()}}};};p.prototype.$FBRTCCallConnectionMonitorc=function(q,r){"use strict";if(r.videoPacketsLost()>q.videoPacketsLost())q.setVideoPacketsLost(r.videoPacketsLost());};p.prototype.$FBRTCCallConnectionMonitore=function(q,r){"use strict";this.$FBRTCCallConnectionMonitor0.interpretStats(q,r);if(this.$FBRTCCallConnectionMonitor0.isNetworkPoor())this.emit('connectionPoor');};k(p,{connectionPoor:true});e.exports=p;},null);
__d("FBRTCDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("FBRTCCallControlActions",["FBRTCDispatcher","keyMirror"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=h({HANG_UP:null,TOGGLE_FULL_SCREEN:null,TOGGLE_MUTE_AUDIO:null,TOGGLE_MUTE_VIDEO:null,TOGGLE_SCREEN_SHARING:null,SHOW_SETTINGS:null}),j={Types:i,hangUp:function(){g.dispatch({type:i.HANG_UP});},toggleMuteAudio:function(){g.dispatch({type:i.TOGGLE_MUTE_AUDIO});},toggleMuteVideo:function(){g.dispatch({type:i.TOGGLE_MUTE_VIDEO});},toggleFullScreen:function(){g.dispatch({type:i.TOGGLE_FULL_SCREEN});},showSettings:function(){g.dispatch({type:i.SHOW_SETTINGS});},toggleScreenSharing:function(){g.dispatch({type:i.TOGGLE_SCREEN_SHARING});}};e.exports=j;},null);
__d("FBRTCStore",["FBRTCDispatcher","FluxStore"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(){h.call(this,g);}k.prototype.__emitChange=function(){this.__emitter.emit(this.__changeEvent);};e.exports=k;},null);
__d("FBRTCFullScreenController",["FBRTCCallControlActions","FBRTCStore"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i,j,k=document.documentElement;if(k.requestFullscreen){i=k.requestFullscreen.bind(k);j='fullscreenchange';}else if(k.msRequestFullscreen){i=k.msRequestFullscreen.bind(k);j='msfullscreenchange';}else if(k.mozRequestFullScreen){i=k.mozRequestFullScreen.bind(k);j='mozfullscreenchange';}else if(k.webkitRequestFullscreen){i=k.webkitRequestFullscreen.bind(k,Element.ALLOW_KEYBOARD_INPUT);j='webkitfullscreenchange';}var l;if(document.exitFullscreen){l=document.exitFullscreen.bind(document);}else if(document.msExitFullscreen){l=document.msExitFullscreen.bind(document);}else if(document.mozCancelFullScreen){l=document.mozCancelFullScreen.bind(document);}else if(document.webkitExitFullscreen)l=document.webkitExitFullscreen.bind(document);for(var m in h)if(h.hasOwnProperty(m))o[m]=h[m];var n=h===null?null:h.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=h;function o(){"use strict";h.call(this);this.$FBRTCFullScreenController0=this.$FBRTCFullScreenController1.bind(this);document.addEventListener(j,this.$FBRTCFullScreenController0);}o.prototype.destroy=function(){"use strict";document.removeEventListener(j,this.$FBRTCFullScreenController0);n.destroy.call(this);};o.prototype.$FBRTCFullScreenController1=function(){"use strict";this.__emitChange();};o.prototype.supportsFullScreen=function(){"use strict";return i&&l;};o.prototype.isFullScreen=function(){"use strict";return !!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement);};o.prototype.$FBRTCFullScreenController2=function(){"use strict";if(this.isFullScreen()){l();}else i();};o.prototype.__onDispatch=function(p){"use strict";switch(p.type){case g.Types.TOGGLE_FULL_SCREEN:this.$FBRTCFullScreenController2();break;}};e.exports=new o();},null);
__d("XVideoCallUserInfoController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/videocall\/userinfo\/",{user_id:{type:"Int",required:true}});},null);
__d("FBRTCPeerInfo",["ix","XVideoCallUserInfoController","FBRTCUtils"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this.peerID=k;this.peerPicUrl=null;this.selfPicUrl=g('/images/chat/webrtc/no_profile_pic.png');this.backgroundUrl=null;this.peerName='';this.peerShortName=null;}j.prototype.fetch=function(k,l){"use strict";var m=(h.getURIBuilder()).setInt('user_id',this.peerID).getURI(),n=this;i.sendServerRequest(m,function(o){n.peerPicUrl=o.payload.profile_pic_url;n.backgroundUrl=o.payload.cover_pic_url;n.peerName=o.payload.name;n.peerShortName=o.payload.peer_short_name;if(o.payload.self_profile_pic_url)n.selfPicUrl=o.payload.self_profile_pic_url;if(k)k();},l);};e.exports=j;},null);
__d("FBRTCStreamWrapper",["mixInEventEmitter","FBRTCUtils"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=100,j=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,k;function l(){"use strict";this.$FBRTCStreamWrapper0=true;this.$FBRTCStreamWrapper1=true;this.$FBRTCStreamWrapper2=null;this.$FBRTCStreamWrapper3=null;this.aspectRatio=l.aspectRatios.other;this.videoWidth=0;this.videoHeight=0;}l.prototype.setStream=function(m,n){"use strict";var o=this.hasStream();this.stopStream();this.$FBRTCStreamWrapper2=m;this.$FBRTCStreamWrapper0=this.hasAudioTracks();this.$FBRTCStreamWrapper4();if(n){this.$FBRTCStreamWrapper2.onaddtrack=this.$FBRTCStreamWrapper5.bind(this);this.$FBRTCStreamWrapper2.onremovetrack=this.$FBRTCStreamWrapper5.bind(this);this.$FBRTCStreamWrapper2.onended=this.$FBRTCStreamWrapper6.bind(this);if(o)this.emit('tracksChanged');}};l.prototype.getStream=function(){"use strict";return this.$FBRTCStreamWrapper2;};l.prototype.hasStream=function(){"use strict";return !!this.$FBRTCStreamWrapper2;};l.isScreenStream=function(m){"use strict";if(m&&m.getAudioTracks().length===0)return true;return false;};l.prototype.stopStream=function(){"use strict";if(this.$FBRTCStreamWrapper2){if(this.$FBRTCStreamWrapper2.stop)this.$FBRTCStreamWrapper2.stop();this.$FBRTCStreamWrapper2=null;}};l.prototype.hasVideoTracks=function(){"use strict";if(this.$FBRTCStreamWrapper2)return this.$FBRTCStreamWrapper2.getVideoTracks().length>0;return true;};l.prototype.hasVideo=function(){"use strict";return this.$FBRTCStreamWrapper1&&this.hasVideoTracks();};l.prototype.hasAudioTracks=function(){"use strict";if(this.$FBRTCStreamWrapper2&&this.$FBRTCStreamWrapper2.getAudioTracks)return this.$FBRTCStreamWrapper2.getAudioTracks().length>0;return true;};l.prototype.hasAudio=function(){"use strict";return this.$FBRTCStreamWrapper0&&this.hasAudioTracks();};l.prototype.attachToVideoTag=function(m){"use strict";if(this.$FBRTCStreamWrapper2){this.$FBRTCStreamWrapper3=m;h.attachMediaStream(m,this.$FBRTCStreamWrapper2);this.$FBRTCStreamWrapper7(m);}};l.prototype.getAudioAnalyser=function(){"use strict";if(this.$FBRTCStreamWrapper2){var m=this.$FBRTCStreamWrapper8(),n=m.createMediaStreamSource(this.$FBRTCStreamWrapper2),o=m.createAnalyser();o.fftSize=2048;n.connect(o);return o;}};l.prototype.$FBRTCStreamWrapper8=function(){"use strict";if(!k)k=new j();return k;};l.prototype.toggleMuteAudio=function(){"use strict";if(!this.hasAudioTracks())return;var m=this.$FBRTCStreamWrapper2.getAudioTracks();this.$FBRTCStreamWrapper0=!this.$FBRTCStreamWrapper0;for(var n=0;n<m.length;n++)m[n].enabled=this.$FBRTCStreamWrapper0;};l.prototype.toggleMuteVideo=function(){"use strict";this.$FBRTCStreamWrapper1=!this.$FBRTCStreamWrapper1;if(this.$FBRTCStreamWrapper1){this.$FBRTCStreamWrapper4();}else setTimeout(this.$FBRTCStreamWrapper4.bind(this),500);this.$FBRTCStreamWrapper5();};l.prototype.$FBRTCStreamWrapper4=function(){"use strict";if(this.$FBRTCStreamWrapper2){var m=this.$FBRTCStreamWrapper2.getVideoTracks();for(var n=0;n<m.length;n++)m[n].enabled=this.$FBRTCStreamWrapper1;}};l.prototype.setVideoEnabled=function(m){"use strict";this.$FBRTCStreamWrapper1=m;this.$FBRTCStreamWrapper4();this.$FBRTCStreamWrapper5();};l.prototype.$FBRTCStreamWrapper7=function(m){"use strict";if(!this.hasVideo()||m.currentTime>0){this.$FBRTCStreamWrapper9(m);}else setTimeout(this.$FBRTCStreamWrapper7.bind(this,m),i);};l.prototype.$FBRTCStreamWrappera=function(m){"use strict";this.videoWidth=m.videoWidth;this.videoHeight=m.videoHeight;var n=m.videoWidth/m.videoHeight;if(h.aboutEqual(n,(16/9)))return l.aspectRatios['16:9'];if(h.aboutEqual(n,(4/3)))return l.aspectRatios['4:3'];return l.aspectRatios.other;};l.prototype.$FBRTCStreamWrapper9=function(m){"use strict";if(this.hasVideo()){this.aspectRatio=this.$FBRTCStreamWrappera(m);}else this.aspectRatio=l.aspectRatios.other;this.emit('streamStarted');};l.prototype.$FBRTCStreamWrapper6=function(){"use strict";this.emit('streamEnded');};l.prototype.$FBRTCStreamWrapper5=function(event){"use strict";if(this.$FBRTCStreamWrapperb(event))this.attachToVideoTag(this.$FBRTCStreamWrapper3);this.emit('tracksChanged');};l.prototype.$FBRTCStreamWrapperb=function(m){"use strict";return this.$FBRTCStreamWrapper3&&m&&m.type==='addtrack'&&m.track.kind==='video';};l.aspectRatios={'16:9':1,'4:3':2,other:3};g(l,{streamStarted:true,streamEnded:true,tracksChanged:true});e.exports=l;},null);
__d("FBRTCCallModel",["FBRTCAdminMessage","FBRTCCallConstants","FBRTCCallControlActions","FBRTCConfig","FBRTCFullScreenController","FBRTCLogger","FBRTCPCConfig","FBRTCPeerInfo","FBRTCScreenSharingUtils","FBRTCStore","FBRTCStreamWrapper","FBRTCStruct"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();for(var s in p)if(p.hasOwnProperty(s))u[s]=p[s];var t=p===null?null:p.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=p;function u(v){"use strict";p.call(this);this.$FBRTCCallModel0=l.getInstance();this.isCaller=v.isCaller;this.peerID=v.peerID;this.$FBRTCCallModel1=new n(v.peerID);this.$FBRTCCallModel2=false;this.$FBRTCCallModel3(v.callID);this.$FBRTCCallModel4(true);}u.prototype.resetForReconnect=function(v){"use strict";this.isCaller=false;this.$FBRTCCallModel3(v);this.$FBRTCCallModel4(false);};u.prototype.fetchPeerInfo=function(){"use strict";var v=this,w=function(){v.__emitChange();},x=function(){v.$FBRTCCallModel0.logError(v.peerID,v.callID,'Failed to get remote photos');};this.$FBRTCCallModel1.fetch(w,x);};u.prototype.setSignalingExperiments=function(v){"use strict";if(v||v===[])this.$FBRTCCallModel5=v;};u.prototype.supportsSdpUpdate=function(){"use strict";return this.$FBRTCCallModel5.indexOf('sdp_update')>-1&&j.supportedSignalingExperiments().indexOf('sdp_update')>-1;};u.prototype.canPeerReceiveScreenSharing=function(){"use strict";return this.$FBRTCCallModel5.indexOf('screen_sharing')>-1;};u.prototype.$FBRTCCallModel3=function(v){"use strict";this.callID=v;this.$FBRTCCallModel6=new g(this.peerID,v);this.startTime=new Date();this.endCallReason=null;this.isRemoteEnded=null;this.wasConnected=false;this.receivedNack=false;this.isRemoteVideoSupported=true;this.$FBRTCCallModel7=true;this.$FBRTCCallModel8=false;this.$FBRTCCallModel5=[];this.$FBRTCCallModel9=null;};u.prototype.$FBRTCCallModel4=function(v){"use strict";if(v){this.localStream=new q();this.localStream.addListener('tracksChanged',function(){if(!this.$FBRTCCallModel7&&this.localStream.hasVideo())this.$FBRTCCallModel8=true;this.__emitChange();}.bind(this));}this.remoteStream=new q();this.selfViewOpen=true;this.uiState=u.UIState.INIT;this.__emitChange();};u.prototype.setLocalStream=function(v){"use strict";this.localStream.setStream(v);};u.prototype.setRemoteStream=function(v){"use strict";this.remoteStream.setStream(v);this.remoteStream.once('streamStarted',function(){this.setStateFrom(u.UIState.CALL_CONNECTING,u.UIState.CALL_CONNECTED);}.bind(this));this.remoteStream.addListener('tracksChanged',function(){this.__emitChange();}.bind(this));this.__emitChange();};u.prototype.setRemoteScreenStream=function(v){"use strict";this.$FBRTCCallModel9=v;this.__emitChange();};u.prototype.getRemoteScreenStream=function(){"use strict";return this.$FBRTCCallModel9;};u.prototype.canStartCall=function(){"use strict";return this.localStream.hasStream()&&m.turnIP;};u.prototype.isAwaitingUserStart=function(){"use strict";return this.uiState===u.UIState.AWAITING_USER_START;};u.prototype.isInProgress=function(){"use strict";return this.uiState>=u.UIState.CONTACTING&&this.uiState<u.UIState.CALL_ENDED;};u.prototype.isUserMediaPending=function(){"use strict";return this.uiState===u.UIState.PENDING_LOCAL_MEDIA;};u.prototype.isUserMediaDenied=function(){"use strict";return this.uiState===u.UIState.USER_MEDIA_DENIED;};u.prototype.isRemoteVideoActive=function(){"use strict";return this.uiState===u.UIState.CALL_CONNECTED&&this.remoteStream.hasVideo();};u.prototype.isEnded=function(){"use strict";return this.uiState>=u.UIState.CALL_ENDED;};u.prototype.isAwaitingAnswer=function(){"use strict";return this.uiState==u.UIState.CONTACTING||this.uiState==u.UIState.RINGING;};u.prototype.isFullScreen=function(){"use strict";return k.isFullScreen();};u.prototype.isScreenSharingEnabled=function(){"use strict";return this.$FBRTCCallModel2;};u.prototype.setScreenSharingStatus=function(v){"use strict";this.$FBRTCCallModel2=v;};u.prototype.peerPicUrl=function(){"use strict";return this.$FBRTCCallModel1.peerPicUrl;};u.prototype.selfPicUrl=function(){"use strict";return this.$FBRTCCallModel1.selfPicUrl;};u.prototype.backgroundUrl=function(){"use strict";return this.$FBRTCCallModel1.backgroundUrl;};u.prototype.peerName=function(){"use strict";return this.$FBRTCCallModel1.peerName;};u.prototype.peerShortName=function(){"use strict";if(this.$FBRTCCallModel1.peerShortName)return this.$FBRTCCallModel1.peerShortName;return this.$FBRTCCallModel1.peerName;};u.prototype.autoDisableVideo=function(){"use strict";if(this.$FBRTCCallModel7){this.$FBRTCCallModel7=false;this.$FBRTCCallModel0.logCallAction(this.peerID,this.callID,l.CallAction.AUTO_DISABLE_VIDEO);this.localStream.setVideoEnabled(false);}};u.prototype.videoIsAutoDisabled=function(){"use strict";return !this.$FBRTCCallModel7&&!this.$FBRTCCallModel8&&!this.localStream.hasVideo();};u.prototype.$FBRTCCallModela=function(){"use strict";this.localStream.toggleMuteAudio();this.$FBRTCCallModel0.logCallAction(this.peerID,this.callID,l.CallAction.SET_MUTE,!this.localStream.hasAudio()?'true':'false');this.__emitChange();};u.prototype.$FBRTCCallModelb=function(v){"use strict";this.localStream.toggleMuteVideo();this.$FBRTCCallModel0.logCallAction(this.peerID,this.callID,l.CallAction.SET_VIDEO_ON,this.localStream.hasVideo());this.__emitChange();};u.prototype.toggleSelfView=function(){"use strict";this.selfViewOpen=!this.selfViewOpen;this.$FBRTCCallModel0.logCallAction(this.peerID,this.callID,l.CallAction.SET_SELF_VIEW_ON,!this.selfViewOpen?'true':'false');this.__emitChange();};u.prototype.setState=function(v){"use strict";if(v===this.uiState)return;var w=this.uiState;this.uiState=v;switch(v){case u.UIState.CALL_CONNECTED:this.wasConnected=true;this.$FBRTCCallModel6.onCallConnected();break;case u.UIState.CALL_ENDED:this.$FBRTCCallModel6.onCallEnded();if(this.isCaller&&w>u.UIState.MORE_INIT){var x=this.isRemoteVideoSupported?h.FBRTCCallType.VIDEO_CALL:h.FBRTCCallType.VOICE_CALL;this.$FBRTCCallModel6.submit(x);}break;}this.$FBRTCCallModel0.logInfo(this.peerID,this.callID,'UI: state change - "'+u.UIState.strNames[w]+'" to "'+u.UIState.strNames[v]+'"');this.__emitChange();};u.prototype.setStateFrom=function(v,w){"use strict";if(this.uiState===v){this.setState(w);}else this.$FBRTCCallModel0.logInfo(this.peerID,this.callID,'UI: Not at "'+u.UIState.strNames[v]+'", not moving to "'+u.UIState.strNames[w]+'"');};u.prototype.__onDispatch=function(v){"use strict";switch(v.type){case i.Types.TOGGLE_MUTE_AUDIO:this.$FBRTCCallModela();break;case i.Types.TOGGLE_MUTE_VIDEO:this.$FBRTCCallModelb();break;case o.ActionTypes.OPEN_IN_NEW:case o.ActionTypes.WINDOW_CLOSED:this.__emitChange();break;}};u.UIState=new r(['INIT','AWAITING_USER_START','PENDING_LOCAL_MEDIA','USER_MEDIA_DENIED','MORE_INIT','CONTACTING','RINGING','CALL_CONNECTING','CALL_CONNECTED','CALL_ENDED','COLLECT_RATING']);e.exports=u;},null);
__d("FBRTCCallMonitor",["FBRTCCallSummaryStore"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=10000,i=3000;function j(k){"use strict";this.$FBRTCCallMonitor0=k;this.$FBRTCCallMonitor1=null;this.$FBRTCCallMonitor2=g.getInstance();}j.prototype.startHeartbeat=function(k){"use strict";if(this.$FBRTCCallMonitor0.isEnded())return;var l=k();if(l)this.onCallHeartbeat(l);var m=this;setTimeout(function(){m.startHeartbeat(k);},h);};j.prototype.onCallHeartbeat=function(k){"use strict";var l=(new Date()).valueOf();if(!this.$FBRTCCallMonitor1||(l-this.$FBRTCCallMonitor1)>i)k.save(this.$FBRTCCallMonitor2);};e.exports=j;},null);
__d("FBRTCIceCache",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(){"use strict";this.$FBRTCIceCache0={};}g.prototype.reset=function(h,i){"use strict";if(!this.$FBRTCIceCache0[h])this.$FBRTCIceCache0[h]={};this.$FBRTCIceCache0[h][i]=[];};g.prototype.cacheCandidate=function(h,i,j){"use strict";if(!this.$FBRTCIceCache0[h])this.$FBRTCIceCache0[h]={};if(!this.$FBRTCIceCache0[h][i])this.$FBRTCIceCache0[h][i]=[];this.$FBRTCIceCache0[h][i].unshift(j);};g.prototype.drainCandidates=function(h,i,j){"use strict";if(this.$FBRTCIceCache0[h]&&this.$FBRTCIceCache0[h][i]){var k;while(this.$FBRTCIceCache0[h][i].length>0){k=this.$FBRTCIceCache0[h][i].pop();j(k);}}};e.exports=g;},null);
__d("FBRTCLocalMessageQueue",["CacheStorage","FBRTCLogger"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='localstorage',j='RTC_',k='offer',l='offer_msg',m='data_',n=30*1000,o=15*1000,p=500;function q(){"use strict";this.$FBRTCLocalMessageQueue0=h.getInstance();}q.prototype.enqueueOffer=function(r,s){"use strict";var t=this.$FBRTCLocalMessageQueue1(r,l);this.$FBRTCLocalMessageQueue2(t,k,s);};q.prototype.getOffer=function(r){"use strict";var s=this.$FBRTCLocalMessageQueue1(r,l);return this.$FBRTCLocalMessageQueue3(s,k);};q.prototype.removeOffer=function(r){"use strict";var s=this.$FBRTCLocalMessageQueue1(r,l);s.remove(k);};q.prototype.enqueueMessage=function(r,s,t,u){"use strict";var v=this.$FBRTCLocalMessageQueue1(r,s),w=m+t.toString();this.$FBRTCLocalMessageQueue2(v,w,u);this.$FBRTCLocalMessageQueue0.logToConsole('Queued '+w);};q.prototype.enableDequeuing=function(r,s,t,u){"use strict";if(u===(void 0))u=o;this.$FBRTCLocalMessageQueue4(r,s,t,u);};q.prototype.$FBRTCLocalMessageQueue4=function(r,s,t,u){"use strict";var v=this.$FBRTCLocalMessageQueue1(r,s),w=v.keys(),x=w.length;for(var y=0;y<x;y++){var z=this.$FBRTCLocalMessageQueue5(v,w[y]);if(z&&t)t(z);}this.$FBRTCLocalMessageQueue0.logToConsole('Dequeued '+x+' ('+r+') with '+u+' left)');if(u>0){u-=p;setTimeout(function(){this.$FBRTCLocalMessageQueue4(r,s,t,u);}.bind(this),p);}};q.prototype.$FBRTCLocalMessageQueue2=function(r,s,t){"use strict";var u={__t:Date.now(),__d:t};r.set(s,u);};q.prototype.$FBRTCLocalMessageQueue3=function(r,s){"use strict";var t=r.get(s);if(t&&this.$FBRTCLocalMessageQueue6(t)){return t.__d;}else if(t)r.remove(s);return null;};q.prototype.$FBRTCLocalMessageQueue5=function(r,s){"use strict";var t=this.$FBRTCLocalMessageQueue3(r,s);if(t!==null){r.remove(s);return t;}return null;};q.prototype.$FBRTCLocalMessageQueue6=function(r){"use strict";return Date.now()-r.__t<n;};q.prototype.$FBRTCLocalMessageQueue1=function(r,s){"use strict";return new g(i,(""+j+r+"_"+s+"_"));};e.exports=q;},null);
__d("FBRTCMessage",["FBRTCConstants","FBRTCSdpUtils","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j='mobile';function k(l){"use strict";if(!this.$FBRTCMessage0(l))throw 'invalid webrtc message';this.peerID=l.from;this.callID=parseInt(l.call_id,10);this.msg=JSON.parse(l.payload);this.msgType=this.msg.type;this.msgID=this.msg.msg_id;this.source=l.source;this.$FBRTCMessage1();this.$FBRTCMessage2();}k.prototype.$FBRTCMessage0=function(l){"use strict";return l.from&&l.call_id&&l.payload;};k.prototype.$FBRTCMessage2=function(){"use strict";if(i.isVideoInteropSupported())return;if(this.isFromMobile()){if(this.msg.sdp)this.msg.sdp=h.disableVideo(this.msg.sdp);if(this.msgType===g.PayloadType.SET_VIDEO||this.msgType===g.PayloadType.OFFER||this.msgType===g.PayloadType.ICERESTART_OFFER||this.msgType===g.PayloadType.ANSWER||this.msgType===g.PayloadType.ICERESTART_ANSWER)this.msg.videoon=false;}};k.prototype.$FBRTCMessage1=function(){"use strict";if(this.isFromMobile()&&this.msg.sdp)this.msg.sdp=h.removeBadCodecLines(this.msg.sdp);};k.prototype.isOffer=function(){"use strict";return this.msgType===g.PayloadType.OFFER;};k.prototype.isFromMobile=function(){"use strict";return (this.source===j);};k.prototype.isRetry=function(){"use strict";return !!this.msg.flag;};k.prototype.isForCall=function(l){"use strict";return !l.callID||l.callID===this.callID||this.msgType===g.PayloadType.OFFER||this.msgType===g.PayloadType.ICERESTART_OFFER||this.msgType===g.PayloadType.PCRESTART_OFFER||this.msgType===g.PayloadType.ICE_CANDIDATE;};k.prototype.getSignalingExperiments=function(){"use strict";if(this.isFromMobile()&&!this.msg.experiments)return ['sdp_update'];return this.msg.experiments;};e.exports=k;},null);
__d("FBRTCMessageDedup",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={},h={check:function(i,j,k){if(!g[i])g[i]={};if(!g[i][j])g[i][j]={};if(g[i][j][k])return false;g[i][j][k]=true;return true;}};e.exports=h;},null);
__d("XVideoCallSendMessageController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/videocall\/sendmessage\/",{recipient_id:{type:"Int",required:true},msg_id:{type:"Int",required:true},message_info:{type:"String",required:true},webrtc_fbtrace:{type:"Int"}});},null);
__d("FBRTCMessageSender",["CurrentUser","FBRTCConfig","FBRTCConstants","FBRTCLogger","FBRTCUtils","Fbtrace","Map","SiteData","VideoCallSupport","XVideoCallSendMessageController","errorCode"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r=0;function s(){"use strict";this.onSendFailure=null;this.$FBRTCMessageSender0=j.getInstance();}s.prototype.sendOffer=function(t,u,v,w){"use strict";return this.$FBRTCMessageSender1(i.PayloadType.OFFER,t,u,v,w);};s.prototype.sendAnswer=function(t,u,v,w){"use strict";return this.$FBRTCMessageSender1(i.PayloadType.ANSWER,t,u,v,w);};s.prototype.sendPCRestartOffer=function(t,u,v,w){"use strict";return this.$FBRTCMessageSender1(i.PayloadType.PCRESTART_OFFER,t,u,v,w);};s.prototype.sendSdpUpdate=function(t,u,v,w){"use strict";return this.$FBRTCMessageSender1(i.PayloadType.SDP_UPDATE,t,u,v,w);};s.prototype.resendSdpMessage=function(t,u){"use strict";u.flag=1;this.$FBRTCMessageSender2(t,u);};s.prototype.$FBRTCMessageSender1=function(t,u,v,w,x){"use strict";var y=this.$FBRTCMessageSender3(v,t);y.sdp=w;if(t===i.PayloadType.OFFER){y.handlescollision=true;y.pranswer=false;}if(t===i.PayloadType.OFFER||t===i.PayloadType.ANSWER){y.icerestart=false;y.experiments=h.supportedSignalingExperiments();}y.videoon=x;this.$FBRTCMessageSender2(u,y);return y;};s.prototype.sendIceCandidate=function(t,u,v){"use strict";var w=this.$FBRTCMessageSender3(u,i.PayloadType.ICE_CANDIDATE);w.sdp_mid=v.sdpMid;w.label=v.sdpMLineIndex;w.sdp=v.candidate;this.$FBRTCMessageSender4(t,w);};s.prototype.sendHangup=function(t,u,v,w){"use strict";var x=this.$FBRTCMessageSender3(u,i.PayloadType.HANGUP);x.reason=i.callEndReasonString(v);this.$FBRTCMessageSender4(t,x,w);};s.prototype.sendOtherDismiss=function(t){"use strict";var u=this.$FBRTCMessageSender3(t,i.PayloadType.OTHER_DISMISS);this.$FBRTCMessageSender4(g.getID(),u);};s.prototype.sendOfferAck=function(t,u,v){"use strict";this.$FBRTCMessageSender5(t,u,v,i.PayloadType.OFFER_ACK);};s.prototype.sendOfferNack=function(t,u,v){"use strict";this.$FBRTCMessageSender5(t,u,v,i.PayloadType.OFFER_NACK,new m([['error_code',1356043]]));};s.prototype.sendAnswerAck=function(t,u,v){"use strict";this.$FBRTCMessageSender5(t,u,v,i.PayloadType.ANSWER_ACK);};s.prototype.sendAck=function(t,u,v){"use strict";this.$FBRTCMessageSender5(t,u,v,i.PayloadType.ACK,new m([['ack_type',v.type]]));};s.prototype.sendMuteStateUpdate=function(t,u,v){"use strict";var w=this.$FBRTCMessageSender3(u,i.PayloadType.SET_VIDEO);w.videoon=v;this.$FBRTCMessageSender4(t,w);};s.prototype.sendVideoRequestResponse=function(t,u,v,w){"use strict";var x=this.$FBRTCMessageSender3(u,i.PayloadType.VIDEO_REQUEST);x.ack_id=v;x.videoon=w;x.capability=o.getCapabilities();this.$FBRTCMessageSender4(t,x);};s.prototype.sendMsgAck=function(){"use strict";};s.prototype.sendOk=function(){"use strict";};s.prototype.sendPranswer=function(){"use strict";};s.prototype.sendIcerestartAnswer=function(){"use strict";};s.prototype.$FBRTCMessageSender3=function(t,u){"use strict";var v=k.generateRandomInt(),w={version:r,type:u,call_id:t,msg_id:v};return w;};s.prototype.$FBRTCMessageSender2=function(t,u){"use strict";this.$FBRTCMessageSender4(t,u,false,true,true);};s.prototype.$FBRTCMessageSender5=function(t,u,v,w){"use strict";for(var x=[],y=4,z=arguments.length;y<z;y++)x.push(arguments[y]);var aa=x[0]||new m(),ba=this.$FBRTCMessageSender3(u,w);ba.ack_id=v.msg_id;if(v.flag===1)ba.flag=1;aa.forEach(function(ca,da,ea){ba[da]=ca;});this.$FBRTCMessageSender4(t,ba);};s.prototype.$FBRTCMessageSender4=function(t,u,v,w,x){"use strict";var y=u.msg_id,z={peer_id:t,call_id:u.call_id,msg_id:y,msg_type:u.type},aa={call_id:u.call_id,msg_id:y,user_id:g.getID(),recipient_id:t,msg_type:u.type,app_id:256281040558,app_version:String(n.revision||'dev'),op:'sendServerRequest:'+u.type,policy:'WebRTC'},ba=l.requestReceive('browser',String(n.revision||'dev'),aa),ca=(p.getURIBuilder()).setInt('recipient_id',t).setInt('msg_id',y).setString('message_info',JSON.stringify(u)).setInt('webrtc_fbtrace',ba.isOn()?1:0).getURI();if(w)var da=this.$FBRTCMessageSender4.bind(this,t,u,v,false,x);var ea=this.$FBRTCMessageSender6.bind(this,z),fa=this.$FBRTCMessageSender7.bind(this,z,da,x);l.withDefaultNode(ba,function(){k.sendServerRequest(ca,ea,fa,v);});if(this.onMessageSent)this.onMessageSent(t,u);this.$FBRTCMessageSender0.logSentMessage(t,u.call_id,u);};s.prototype.$FBRTCMessageSender6=function(t){"use strict";this.$FBRTCMessageSender0.logSentMessageSuccess(t.peer_id,t.call_id,t.msg_type,t.msg_id);};s.prototype.$FBRTCMessageSender7=function(t,u,v,w){"use strict";if(w)var x=w.getError?w.getError():w;this.$FBRTCMessageSender0.logSentMessageFailure(t.peer_id,t.call_id,t.msg_type,t.msg_id,x);if(this.onSendFailure){var y=null;if(x===1356001||x===1356049){y=i.CallEndReason.NO_PERMISSION;}else if(x===1356046||x===1356045){y=i.CallEndReason.CALLER_NOT_VISIBLE;}else if(x===1356003||x===1356002||x===1356044||x===1356048){y=i.CallEndReason.OTHER_NOT_CAPABLE;}else if(u){u();return;}else if(v)y=i.CallEndReason.SIGNALING_MESSAGE_FAILED;if(y)this.onSendFailure(y,x);}};e.exports=s;},null);
__d("XVideoCallTurnDiscoveryController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/videocall\/turndiscovery\/",{version:{type:"Int",required:true}});},null);
__d("FBRTCTurnDiscovery",["FBRTCLogger","FBRTCUtils","XVideoCallTurnDiscoveryController","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=3,l={requestTurnCreds:function(m,n){if(this._turnCreds)this.emit('receivedTurnCreds',this._turnCreds);if(n===(void 0))n=k;var o=1,p=(i.getURIBuilder()).setInt('version',o).getURI();h.sendServerRequest(p,this._onServerRequestSuccess.bind(this),this._onServerRequestFailure.bind(this,m,n));},_onServerRequestSuccess:function(m){this._turnCreds=m.payload;this.emit('receivedTurnCreds',this._turnCreds);},_onServerRequestFailure:function(m,n,o){if(n>0){g.getInstance().logError(m.peerID,m.callID,'Failed turn; going to retry');this.requestTurnCreds(m,n-1);}else this.emit('failed');}};j(l,{receivedTurnCreds:true,failed:true});e.exports=l;},null);
__d("FBRTCStreamTester",["mixInEventEmitter","FBRTCUtils"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=100,j=30;function k(l){"use strict";if(!l)l={};this.$FBRTCStreamTester0=l.retries||j;this.$FBRTCStreamTester1=l.testInterval||i;this.$FBRTCStreamTester2=null;this.$FBRTCStreamTester3=null;this.$FBRTCStreamTester4=false;}k.prototype.testStream=function(l,m){"use strict";this.$FBRTCStreamTester2=l;if(!m){this.$FBRTCStreamTester4=true;this.$FBRTCStreamTester3=document.createElement('video');this.$FBRTCStreamTester3.muted=true;h.attachMediaStream(this.$FBRTCStreamTester3,this.$FBRTCStreamTester2);this.$FBRTCStreamTester3.play();}else{this.$FBRTCStreamTester4=false;this.$FBRTCStreamTester3=m;}this.$FBRTCStreamTester5(this.$FBRTCStreamTester0);};k.prototype.$FBRTCStreamTester5=function(l){"use strict";if(this.$FBRTCStreamTester2.getVideoTracks().length===0||this.$FBRTCStreamTester3.currentTime>0){this.$FBRTCStreamTester6();this.emit('streamWorking');}else if(l<1){this.$FBRTCStreamTester6();this.emit('streamBroken');}else setTimeout(this.$FBRTCStreamTester5.bind(this,l-1),this.$FBRTCStreamTester1);};k.prototype.$FBRTCStreamTester6=function(){"use strict";if(this.$FBRTCStreamTester4)this.$FBRTCStreamTester3.pause();this.$FBRTCStreamTester3=null;this.$FBRTCStreamTester2=null;};g(k,{streamWorking:true,streamBroken:true});e.exports=k;},null);
__d("FBRTCUserMediaRequest",["FBRTCStruct","mixInEventEmitter"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=720,j=480,k=30,l=function(r,s,t,u,v){return {audio:m(t,u),video:n(r,s,t,v)};},m=function(r,s){if(r&&navigator.webkitGetUserMedia)return false;if(!s)return true;return {optional:[{sourceId:s}]};},n=function(r,s,t,u){var v=s?i:j;if(t&&u)return {mandatory:{chromeMediaSource:'desktop',chromeMediaSourceId:u,minHeight:720,maxHeight:1080,minWidth:1280,maxWidth:1920,minFrameRate:k,maxFrameRate:k}};if(r){var w={mandatory:{},optional:[{minHeight:v},{maxHeight:v},{minFrameRate:k},{maxFrameRate:k},{googLeakyBucket:true}]};if(u)w.optional.push({sourceId:u});return w;}return false;},o=function(r,s,t){if(navigator.getUserMedia){navigator.getUserMedia(r,s,t);}else if(navigator.webkitGetUserMedia){navigator.webkitGetUserMedia(r,s,t);}else if(navigator.mozGetUserMedia){navigator.mozGetUserMedia(r,s,t);}else if(navigator.msGetUserMedia)navigator.msGetUserMedia(r,s,t);},p=new g(['NO_VIDEO','SD_VIDEO','HD_VIDEO','SCREEN_SHARING']);function q(r){"use strict";if(r===(void 0))r=p.SD_VIDEO;this.streamType=r;this.audioSource=null;this.videoSource=null;}q.prototype.request=function(){"use strict";var r=this.streamType!==p.NO_VIDEO,s=this.streamType===p.SCREEN_SHARING,t=this.streamType===p.HD_VIDEO||s,u=l(r,t,s,this.audioSource,this.videoSource);o(u,function(v){this.emit('success',v);}.bind(this),function(v){this.emit('failed',v);}.bind(this));};q.STREAM_TYPE=p;q.HD_HEIGHT=i;q.SD_HEIGHT=j;h(q,{success:true,failed:true});e.exports=q;},null);
__d("FBRTCUserMedia",["mixInEventEmitter","FBRTCLogger","FBRTCStreamTester","FBRTCUserMediaRequest"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k={STREAM_TYPE:j.STREAM_TYPE,_localStream:null,_accessGranted:false,_pendingRequest:null,_failedVideoSources:[],_failedAudioSources:[],requestUserMedia:function(l,m,n){if(this._localStream&&!m&&!n){this.emit('streamReady',this._localStream);}else{this._startRequestListeners();this._pendingRequest=new j(l);this._pendingRequest.audioSource=m;this._pendingRequest.videoSource=n;this._pendingRequest.addListener('success',this._onRequestSuccess,this);this._pendingRequest.addListener('failed',this._onRequestFailure,this);this._pendingRequest.request();}},end:function(){this._stopEventListeners();if(this._localStream){this._localStream.stop();this._localStream=null;}},_startRequestListeners:function(){if(navigator.mozGetUserMedia){this._evListener=this._onMediaPromptHidden.bind(this);document.addEventListener('mousedown',this._evListener);document.addEventListener('focus',this._evListener);}},_stopEventListeners:function(){if(navigator.mozGetUserMedia){if(this._promptTimeout)clearTimeout(this._promptTimeout);document.removeEventListener('mousedown',this._evListener);document.removeEventListener('focus',this._evListener);}},_onMediaPromptHidden:function(){this._promptTimeout=setTimeout(function(){if(!this._accessGranted&&this._pendingRequest)this._pendingRequest.request();}.bind(this),1500);},_onRequestSuccess:function(l){this._stopEventListeners();if(!this._accessGranted){this._accessGranted=true;this.emit('accessGranted');}l.videoMediaSourceId=this._pendingRequest.videoSource;l.audioMediaSourceId=this._pendingRequest.audioSource;var m=new i();m.addListener('streamWorking',function(){this._pendingRequest=null;if(this._localStream&&this._localStream!==l)this._localStream.stop();this._localStream=l;this.emit('streamReady',this._localStream);}.bind(this));m.addListener('streamBroken',function(){l.stop();this._onRequestFailure('StreamFailedToStart');}.bind(this));m.testStream(l);},_onRequestFailure:function(l){this._stopEventListeners();var m=this._getErrorName(l);if(this._shouldRetryRequest(m,this._pendingRequest)){this._configureRequestForRetry(this._pendingRequest,m);return;}if(m==='InvalidStateError'){h.getInstance().logErrorWithoutID('Invalid state while requesting user media');return;}this._pendingRequest=null;if(m==='PERMISSION_DENIED'||m==='PermissionDeniedError'||m==='PermissionDismissedError'){this.emit('accessDenied',m);}else{if(m==='NO_DEVICES_FOUND')m='DevicesNotFoundError';h.getInstance().logErrorWithoutID('getUserMedia error: '+m);this.emit('accessFailed',m);}},_getErrorName:function(l){if(l.name)return l.name;return l;},_shouldRetryRequest:function(l,m){return m.streamType!==this.STREAM_TYPE.NO_VIDEO&&(l==='DevicesNotFoundError'||l==='StreamFailedToStart');},_configureRequestForRetry:function(l,m){if(m==='StreamFailedToStart'&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources){if(l.videoSource)this._failedVideoSources.push(l.videoSource);window.MediaStreamTrack.getSources(function(n){for(var o=0;o<n.length;o++){var p=n[o];if(p.kind==='video'&&this._failedVideoSources.indexOf(p.id)===-1){l.videoSource=p.id;l.request();return;}}l.streamType=this.STREAM_TYPE.NO_VIDEO;l.request();}.bind(this));}else{l.streamType=this.STREAM_TYPE.NO_VIDEO;l.request();}}};g(k,{streamReady:true,accessGranted:true,accessDenied:true,accessFailed:true});e.exports=k;},null);
__d("FBRTCRingback",["RTCConfig","Sound","FBRTCCallModel"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=[g.ringback_mp3_url,g.ringback_ogg_url],k={monitorCallModel:function(l){if(this._subscription)this._subscription.remove();this._callModel=l;this._subscription=l.addListener(this._onChange.bind(this));},_soundIsPlaying:false,_onChange:function(){if(this._callModel.uiState===i.UIState.RINGING){this._startSound();}else this._stopSound();},_startSound:function(){if(!this._soundIsPlaying){h.play(j,this._syncToken(),true);this._soundIsPlaying=true;}},_syncToken:function(){return 'ring_back_'+this._callModel.callID.toString();},_stopSound:function(){if(this._soundIsPlaying){h.stop(j);this._soundIsPlaying=false;}}};e.exports=k;},null);
__d("FBRTCScreenStreamWrapper",["FBRTCStreamWrapper"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(){if(g!==null)g.apply(this,arguments);}j.prototype.toggleMuteAudio=function(){return;};j.prototype.toggleMuteVideo=function(){return;};e.exports=j;},null);
__d("FBRTCVideo.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g.createClass({displayName:"FBRTCVideo",hideContextMenu:function(k){k.preventDefault();},componentDidMount:function(){this._attachStream();},shouldComponentUpdate:function(k,l){return this._streamDidChange();},componentDidUpdate:function(k,l){this._attachStream();},_attachStream:function(){if(this.props.stream){var k=g.findDOMNode(this);this.props.stream.attachToVideoTag(k);this._currentStream=this.props.stream.getStream();}},_streamDidChange:function(){var k=this.props.stream?this.props.stream.getStream():null;return k!==this._currentStream;},render:function(){return (g.createElement("video",{className:i(this.props.className,"_4bad"),autoPlay:'true',muted:this.props.muted,onContextMenu:this.hideContextMenu}));}});e.exports=j;},null);
__d("FBRTCScreenSharingView.react",["FBRTCConstants","FBRTCScreenStreamWrapper","FBRTCVideo.react","React","cx","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"FBRTCScreenSharingView",propTypes:{isStandalone:n.bool,publishFn:n.func,screenStream:n.instanceOf(h),screenSrc:n.string},getDefaultProps:function(){return {isStandalone:false,publishFn:l};},render:function(){var p=this.props.isStandalone,q=this.props.screenStream,r=this.props.screenSrc;if(q&&q.hasStream()){return (j.createElement("div",{className:this._baseClasses()},this._renderOpenInNewButton(),j.createElement("div",{className:this._wrapperClass()},j.createElement(i,{stream:q}))));}else if(p&&r){return this._renderStandalone(r);}else return j.createElement("div",{className:"_2uql"});},_baseClasses:function(){return (("_2uqm")+(this.props.isStandalone?' '+"_2uqn":''));},_buttonClasses:function(){return (("_2uqo"));},_buttonIconClasses:function(){return (("_2uqp"));},_wrapperClass:function(){return (("_2uqq"));},_renderOpenInNewButton:function(){if(!this.props.isStandalone)return (j.createElement("button",{className:this._buttonClasses(),onClick:this._openInNewWindow},j.createElement("i",{className:this._buttonIconClasses()})));},_openInNewWindow:function(p){if(this.props.publishFn)this.props.publishFn(g.UIEventType.OPEN_SCREEN_IN_NEW);},_renderStandalone:function(p){return (j.createElement("div",{className:this._baseClasses()},j.createElement("div",{className:this._wrapperClass()},j.createElement("video",{className:"_4bad",autoPlay:'true',muted:false,onContextMenu:function(q){q.preventDefault();},src:decodeURIComponent(p)}))));}});e.exports=o;},null);
__d("XScreenSharingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/videocall\/screen_sharing\/",{peer_id:{type:"Int",required:true},call_id:{type:"Int",required:true}});},null);
__d("FBRTCScreenSharingUI",["FBRTCDispatcher","FBRTCScreenSharingUtils","FBRTCScreenSharingView.react","React","XScreenSharingController"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=null,m=false,n={open:function(o){var p=this._windowPosition(),q=['menubar=no','location=no','scrollbars=no','status=no','personalbar=no',p.height,p.width,p.top,p.left].join(','),r=this._getUnsignedUri(o);l=window.open(r,'Screen Sharing',q);if(l){g.dispatch({type:h.ActionTypes.OPEN_IN_NEW});if(window.focus)l.focus();this._renderView(o,5);}},close:function(){if(l){l.close();l=null;}},isOpen:function(){return l!==null;},_onUnload:function(o){n.close();g.dispatch({type:h.ActionTypes.WINDOW_CLOSED});},_renderView:function(o,p){setTimeout(function(){setTimeout(function(){if(l!==null){var q='FBRTCScreenSharingView/container',r=l.document.getElementById(q);if(r){j.render(j.createElement(i,{isStandalone:true,screenStream:o.getRemoteScreenStream()}),r);m=true;l.onunload=this._onUnload;}}}.bind(this),1);if(p>1&&!m)this._renderView(o,p-1);}.bind(this),500);},_windowPosition:function(){var o=screen.availLeft,p=screen.availTop,q=Math.min(960,screen.width-o),r=Math.min(540,screen.height-p);return {height:'height='+r.toString(),width:'width='+q.toString(),top:'top='+p.toString(),left:'left='+o.toString()};},_getUnsignedUri:function(o){return k.getURIBuilder().setInt('peer_id',o.peerID).setInt('call_id',o.callID).getURI();}};e.exports=n;},null);
__d("FBRTCViewController",["FBRTCCallModel","FBRTCConstants","FBRTCLogger","FBRTCRingback","FBRTCScreenSharingUI"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=500;function m(n,o,p){"use strict";this.$FBRTCViewController0=n;this.$FBRTCViewController1=o;this.$FBRTCViewController2=p;this.$FBRTCViewController3=false;this.$FBRTCViewController4=i.getInstance();}m.prototype.init=function(){"use strict";this.$FBRTCViewController0.addListener(function(){var n=this.$FBRTCViewController0.uiState;if(n===g.UIState.COLLECT_RATING)this.$FBRTCViewController5();}.bind(this));j.monitorCallModel(this.$FBRTCViewController0);this.$FBRTCViewController0.fetchPeerInfo();};m.prototype.onLocalStreamReady=function(n){"use strict";this.$FBRTCViewController0.setLocalStream(n);if(this.$FBRTCViewController0.uiState>g.UIState.MORE_INIT){this.$FBRTCViewController4.logInfo(this.$FBRTCViewController0.peerID,this.$FBRTCViewController0.callID,'UI: Already @ MORE_INIT, no update');}else if(this.$FBRTCViewController0.canStartCall()&&!this.$FBRTCViewController0.isCaller){this.$FBRTCViewController0.setState(g.UIState.CALL_CONNECTING);}else this.$FBRTCViewController0.setState(g.UIState.MORE_INIT);};m.prototype.waitForUserInput=function(){"use strict";this.$FBRTCViewController0.setStateFrom(g.UIState.INIT,g.UIState.AWAITING_USER_START);};m.prototype.userMediaRequested=function(){"use strict";setTimeout(function(){this.$FBRTCViewController0.setStateFrom(g.UIState.INIT,g.UIState.PENDING_LOCAL_MEDIA);}.bind(this),l);};m.prototype.userMediaGranted=function(){"use strict";this.$FBRTCViewController0.setState(g.UIState.MORE_INIT);};m.prototype.userMediaDenied=function(){"use strict";this.$FBRTCViewController0.setState(g.UIState.USER_MEDIA_DENIED);};m.prototype.onTurnCredentialsReady=function(n){"use strict";if(!this.$FBRTCViewController0.isCaller)this.$FBRTCViewController0.setStateFrom(g.UIState.MORE_INIT,g.UIState.CALL_CONNECTING);};m.prototype.onMessageTypeSent=function(n){"use strict";if(n!==h.PayloadType.OFFER&&n!==h.PayloadType.PCRESTART_OFFER)return;if(n===h.PayloadType.PCRESTART_OFFER)this.$FBRTCViewController3=true;if(n===h.PayloadType.OFFER)this.$FBRTCViewController0.setState(g.UIState.CONTACTING);};m.prototype.onMessageTypeReceived=function(n){"use strict";if(this.$FBRTCViewController3){if(n===h.PayloadType.ANSWER)this.$FBRTCViewController0.setStateFrom(g.UIState.CONTACTING,g.UIState.CALL_CONNECTING);}else if(n===h.PayloadType.OFFER_ACK){this.$FBRTCViewController0.setStateFrom(g.UIState.CONTACTING,g.UIState.RINGING);}else if(n===h.PayloadType.ANSWER)if(this.$FBRTCViewController0.uiState===g.UIState.CONTACTING||this.$FBRTCViewController0.uiState===g.UIState.RINGING)this.$FBRTCViewController0.setState(g.UIState.CALL_CONNECTING);};m.prototype.onRemoteStreamAdded=function(event){"use strict";this.$FBRTCViewController0.setRemoteStream(event.stream);};m.prototype.end=function(n,o){"use strict";this.$FBRTCViewController0.endCallReason=n;this.$FBRTCViewController0.isRemoteEnded=o;this.$FBRTCViewController0.setState(g.UIState.CALL_ENDED);};m.prototype.reset=function(n,o){"use strict";this.$FBRTCViewController0.resetForReconnect(n);this.$FBRTCViewController1=o;this.$FBRTCViewController0.setState(g.UIState.CALL_CONNECTING);};m.prototype.publish=function(n,o){"use strict";switch(n){case h.UIEventType.TOGGLE_SELF_VIEW:this.$FBRTCViewController6(o);break;case h.UIEventType.SUBMIT_STAR_RATING:this.$FBRTCViewController7(o);break;case h.UIEventType.SUBMIT_FEEDBACK:this.$FBRTCViewController8(o);break;case h.UIEventType.START_CALL:if(this.onStartCall)this.onStartCall(i.Trigger.POPUP_CALL_START_BUTTON);break;case h.UIEventType.OPEN_SCREEN_IN_NEW:this.$FBRTCViewController9();break;default:break;}};m.prototype.$FBRTCViewController6=function(n){"use strict";this.$FBRTCViewController0.toggleSelfView();};m.prototype.$FBRTCViewController5=function(){"use strict";this.$FBRTCViewController1.addExtraInfo(i.Key.RATING_SHOWN,'1');this.$FBRTCViewController1.save(this.$FBRTCViewController2);};m.prototype.$FBRTCViewController7=function(n){"use strict";if(n<1||n>5){this.$FBRTCViewControllera(this.$FBRTCViewController0.peerID,this.$FBRTCViewController0.callID,'Bad rating: '+n);return;}this.$FBRTCViewController1.addExtraInfo(i.Key.RATING,n);this.$FBRTCViewController1.save(this.$FBRTCViewController2);};m.prototype.$FBRTCViewController8=function(n){"use strict";this.$FBRTCViewController1.addExtraInfo(i.Key.SURVEY_DETAILS,n);this.$FBRTCViewController1.save(this.$FBRTCViewController2);};m.prototype.$FBRTCViewController9=function(){"use strict";k.open(this.$FBRTCViewController0);};m.prototype.$FBRTCViewControllerb=function(n,o){"use strict";this.$FBRTCViewController4.logCallAction(this.$FBRTCViewController0.peerID,this.$FBRTCViewController0.callID,n,o?'true':'false');};e.exports=m;},null);
__d("FBRTCCallModelStatePusher",["FBRTCCallModel","FBRTCConstants"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=30000,j=10000;function k(l){"use strict";this.$FBRTCCallModelStatePusher0=l;this.$FBRTCCallModelStatePusher0.addListener(this.$FBRTCCallModelStatePusher1.bind(this));}k.prototype.$FBRTCCallModelStatePusher2=function(){"use strict";return this.$FBRTCCallModelStatePusher0.uiState===g.UIState.CALL_ENDED&&this.$FBRTCCallModelStatePusher0.wasConnected&&this.$FBRTCCallModelStatePusher0.endCallReason===h.CallEndReason.HANGUP_CALL;};k.prototype.$FBRTCCallModelStatePusher1=function(){"use strict";if(this.$FBRTCCallModelStatePusher0.uiState===g.UIState.CALL_ENDED){if(this.$FBRTCCallModelStatePusher2()){this.$FBRTCCallModelStatePusher3(3000,g.UIState.CALL_ENDED,g.UIState.COLLECT_RATING);}else this.$FBRTCCallModelStatePusher4(j);}else if(this.$FBRTCCallModelStatePusher0.uiState===g.UIState.COLLECT_RATING)this.$FBRTCCallModelStatePusher4(i);};k.prototype.$FBRTCCallModelStatePusher4=function(l){"use strict";setTimeout(function(){window.close();},l);};k.prototype.$FBRTCCallModelStatePusher3=function(l,m,n){"use strict";var o=this.$FBRTCCallModelStatePusher0;setTimeout(function(){o.setStateFrom(m,n);},l);};e.exports=k;},null);
__d("FBRTCAudioSpectrumAnalyser.react",["React","cancelAnimationFrame","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=7,k=3,l=9,m='#3B5998',n='#CCCCCC',o=function(r,s,t,u){var v=u?n:m;s+=k;t-=k;r.beginPath();r.arc(s,t,k,0,2*Math.PI,false);r.fillStyle=v;r.strokeStyle=v;r.fill();},p=function(r,s,t){var u,v,w=s.width/l,x=Math.floor(s.height/j),y=new Uint8Array(2048);r.getByteFrequencyData(y);t.clearRect(0,0,s.width,s.height);var z=Math.floor(y.length/(l*3));for(var aa=0;aa<l;aa+=1){u=0;for(var ba=0;ba<z;ba+=1)u+=y[(aa*z)+ba];v=(u*j)/(z*256);if(v<1)v=.6;for(var ca=0;ca<Math.floor(v);ca++)o(t,aa*w,s.height-ca*x);if(v-Math.floor(v)>=.5)o(t,aa*w,s.height-ca*x,true);}},q=g.createClass({displayName:"FBRTCAudioSpectrumAnalyser",_isAnimating:false,_animationLoop:null,componentDidMount:function(){this._startAnimation();},componentWillUnmount:function(){this._stopAnimation();},shouldComponentUpdate:function(r,s){return this._streamDidChange();},componentDidUpdate:function(r,s){this._stopAnimation();this._startAnimation();},_streamDidChange:function(){var r=this.props.stream?this.props.stream.getStream():null;return r!==this._currentStream;},_stopAnimation:function(){this._isAnimating=false;h(this._animationLoop);},_startAnimation:function(){var r=this.props.stream.getAudioAnalyser();if(!this._isAnimating&&r){this._isAnimating=true;var s=g.findDOMNode(this),t=s.getContext('2d');this._animate(r,s,t);}},render:function(){return g.createElement("canvas",{width:"106",height:"80"});},_animate:function(r,s,t){this._animationLoop=i(function(){if(!this._isAnimating)return;p(r,s,t);this._animate(r,s,t);}.bind(this));}});e.exports=q;},null);
__d("FBRTCUserSettings",["mixInEventEmitter","FBRTCConfig","FBRTCUserMediaRequest","FBRTCStreamWrapper"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=window.MediaStreamTrack,l=null,m={stream:new j(),audioSources:[],videoSources:[],selectedCamera:null,savedCamera:null,selectedMic:null,savedMic:null,isLoading:false,isEnabled:function(){return h.settingsEnabled()&&k&&!!k.getSources;},isDirty:function(){return this.savedCamera!==this.selectedCamera||this.savedMic!==this.selectedMic;},refresh:function(){if(k&&k.getSources){k.getSources(function(n){for(var o=0;o<n.length;o++){var p=n[o];if(p.kind==='audio')this.audioSources.push(p);if(p.kind==='video')this.videoSources.push(p);}this._refreshSelectedOptions();this._getUserMedia();this.isLoading=false;this._scheduleChangeEvent();}.bind(this));this.isLoading=true;this.audioSources=[];this.videoSources=[];}this._scheduleChangeEvent();},cleanUp:function(){this.stream.stopStream();},_refreshSelectedOptions:function(){if(this.selectedMic===null)if(this.savedMic){this.selectedMic=this.savedMic;}else if(this.audioSources.length>0){this.selectedMic=this.audioSources[0].id;this.savedMic=this.selectedMic;}if(this.selectedCamera===null)if(this.savedCamera){this.selectedCamera=this.savedCamera;}else if(this.videoSources.length>0){this.selectedCamera=this.videoSources[0].id;this.savedCamera=this.selectedCamera;}},save:function(){this.cleanUp();this.savedMic=this.selectedMic;this.savedCamera=this.selectedCamera;this.emit('saved');},selectCameraOption:function(n){this.selectedCamera=n;this._scheduleChangeEvent();this._getUserMedia();},selectMicOption:function(n){this.selectedMic=n;this._scheduleChangeEvent();this._getUserMedia();},updateForLocalStream:function(n){if(n.videoMediaSourceId)this.savedCamera=n.videoMediaSourceId;if(n.audioMediaSourceId)this.savedMic=n.audioMediaSourceId;},_scheduleChangeEvent:function(){if(l!==null)clearTimeout(l);l=setTimeout(function(){this.emit('changed');l=null;}.bind(this),50);},_getUserMedia:function(){var n=new i();n.videoSource=this.selectedCamera;n.audioSource=this.selectedMic;n.addListener('success',this._gumSuccess,this);n.addListener('failed',this._gumFailed,this);n.request();},_gumSuccess:function(n){this.stream.setStream(n);this._scheduleChangeEvent();},_gumFailed:function(n){}};g(m,{changed:true,saved:true});e.exports=m;},null);
__d("FBRTCSettingsDialog.react",["React","cx","fbt","Link.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react","XUIDialogSaveButton.react","XUIDialogCancelButton.react","XUIGrayText.react","XUISelector.react","FBRTCAudioSpectrumAnalyser.react","FBRTCConfig","FBRTCUserSettings","FBRTCVideo.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=r.Option,x=function(z){var aa=[],ba=0;for(var ca=0;ca<z.length;ca++){var da=z[ca],ea=da.label;if(!ea){var fa=(da.kind==='audio'?'Microphone':'Camera');ea=(i._({"Camera":"Kamera{number}","Microphone":"Mikrofon{number}"},[i['enum'](fa,{Camera:"Camera",Microphone:"Microphone"}),i.param("number",++ba)]));}aa.push(g.createElement(w,{value:da.id,key:da.id},ea));}return aa;},y=g.createClass({displayName:"FBRTCSettingsDialog",componentDidMount:function(){this._renderSubscription=u.addListener('changed',function(){this.forceUpdate();}.bind(this));u.refresh();},componentWillUnmount:function(){this._renderSubscription.remove();u.cleanUp();},render:function(){return (g.createElement(k,{width:365,shown:true,onToggle:this.props.onToggle},g.createElement(n,{showCloseButton:true},g.createElement("span",null,i._("Ustawienia"))),g.createElement(l,null,this._dialogBody()),g.createElement(m,{leftContent:this._helpLink()},g.createElement(p,null),g.createElement(o,{use:"confirm",disabled:!u.isDirty(),onClick:this._onConfirmClicked}))));},_dialogBody:function(){if(u.isLoading)return g.createElement("div",{className:"_48fc"});return (g.createElement("div",{className:"_48fc"},this._cameraOptions(),this._microphoneOptions()));},_cameraOptions:function(){if(u.videoSources.length<1)return null;return (g.createElement("div",{className:"_48fd"},g.createElement(q,{display:"block",size:"medium",shade:"medium",className:"_48fe"},i._("Kamera")),g.createElement(r,{name:"camera_selection",onChange:this._onCamSelectionChanged,defaultValue:u.selectedCamera,width:"200px"},x(u.videoSources)),g.createElement("div",{className:"_48ff"},g.createElement(v,{stream:u.stream,muted:true,className:"_48fg"}))));},_microphoneOptions:function(){if(u.audioSources.length<1)return null;return (g.createElement("div",{className:"_48fd"},g.createElement(q,{display:"block",size:"medium",shade:"medium",className:"_48fe"},i._("Mikrofon")),g.createElement(r,{name:"microphone_selection",onChange:this._onMicSelectionChanged,defaultValue:u.selectedMic,width:"200px"},x(u.audioSources)),g.createElement("div",{className:"_48fh"},g.createElement(s,{stream:u.stream}))));},_onCamSelectionChanged:function(z){u.selectCameraOption(z.value);},_onMicSelectionChanged:function(z){u.selectMicOption(z.value);},_onConfirmClicked:function(z){u.save();},_helpLink:function(){return (g.createElement("div",null,g.createElement(q,{shade:"light"},i._("Wyst\u0105pi\u0142y problemy? {troubleShootingGuideLink}",[i.param("troubleShootingGuideLink",g.createElement(j,{href:t.userMediaErrorUrl(),target:"_blank"},i._("Pomoc")))]))));}});e.exports=y;},null);
__d("FBRTCMediaAccessErrorDialog.react",["React","fbt","Link.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react","FBRTCConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=g.createClass({displayName:"FBRTCMediaAccessErrorDialog",render:function(){return (g.createElement(j,{shown:true,width:440,layerHideOnBlur:false},g.createElement(m,{showCloseButton:false},g.createElement("span",null,h._("Nie mo\u017cna po\u0142\u0105czy\u0107"))),g.createElement(k,null,this._dialogBody()),g.createElement(l,{leftContent:this._footerContent()})));},_dialogBody:function(){return (g.createElement("p",null,h._("Aby nawi\u0105za\u0107 po\u0142\u0105czenie, pod\u0142\u0105cz kamer\u0119 i mikrofon. Je\u017celi s\u0105 ju\u017c pod\u0142\u0105czone, spr\u00f3buj uruchomi\u0107 ponownie przegl\u0105dark\u0119 i zamkn\u0105\u0107 wszelkie pozosta\u0142e aplikacje korzystaj\u0105ce z kamery lub mikrofonu.")));},_footerContent:function(){return (g.createElement("span",null,h._("Ci\u0105gle potrzebujesz pomocy? Patrz {troubleShootingGuideLink}",[h.param("troubleShootingGuideLink",g.createElement(i,{href:n.userMediaErrorUrl(),target:"_blank"},h._("Poradnik rozwi\u0105zywania problem\u00f3w")))])));}});e.exports=o;},null);
__d("FBRTCPeerBrowserUnsupportedDialog.react",["React","fbt","Link.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react","FBRTCConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=g.createClass({displayName:"FBRTCPeerBrowserUnsupportedDialog",render:function(){return (g.createElement(j,{shown:true,width:440},g.createElement(m,{showCloseButton:false},g.createElement("span",null,h._("Nie mo\u017cna nawi\u0105za\u0107 po\u0142\u0105czenia"))),g.createElement(k,null,this._dialogBody()),g.createElement(l,{leftContent:this._footerContent()})));},_dialogBody:function(){var p=this.props.peerName;return (g.createElement("p",null,h._("{name} nie u\u017cywa jeszcze przegl\u0105darki, kt\u00f3ra obs\u0142uguje po\u0142\u0105czenia wideo.",[h.param("name",p)])));},_footerContent:function(){return (g.createElement("span",null,h._("Ci\u0105gle potrzebujesz pomocy? Patrz {troubleShootingGuideLink}",[h.param("troubleShootingGuideLink",g.createElement(i,{href:n.unsupportedBrowserUrl(),target:"_blank"},h._("Poradnik rozwi\u0105zywania problem\u00f3w")))])));}});e.exports=o;},null);
__d("FBRTCScreenSharingUnsupportedBrowserDialog.react",["React","Image.react","Link.react","Layout.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react","XUIText.react","FBRTCConfig","FBRTCVersionDetection","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=j.Column,v=g.createClass({displayName:"FBRTCScreenSharingUnsupportedBrowserDialog",render:function(){return (g.createElement(k,{shown:true,width:440,layerHideOnBlur:false},g.createElement(n,{showCloseButton:true},this._title()),g.createElement(l,null,this._dialogBody(),this._installLinks()),g.createElement(m,{leftContent:this._footerContent()})));},_title:function(){var w=null;if(q.isChrome()){w=s._("Update Browser to Share Your Screen");}else w=s._("Switch Browsers to Share Your Screen");return (g.createElement("span",null,w));},_dialogBody:function(){var w=null;if(q.isChrome()){w=s._("Screen sharing doesn't work in the older version of {current browser name} you're using. To share your screen, please update {browser name} .",[s.param("current browser name",this._browserName()),s.param("browser name",this._browserName())]);}else w=s._("Scren sharing doesn't work in {browser name} yet. To share your screen, please open Facebook in Google Chrome.",[s.param("browser name",this._browserName())]);return (g.createElement("p",null,w,g.createElement(i,{href:p.unsupportedBrowserUrl(),target:"_blank"},s._("Learn More"))));},_footerContent:function(){return (g.createElement("span",null,s._("Still need help? See {troubleShootingGuideLink}",[s.param("troubleShootingGuideLink",g.createElement(i,{href:p.userMediaErrorUrl(),target:"_blank"},s._("Troubleshooting Guide")))])));},_browserName:function(){if(q.isFirefox())return 'Mozilla Firefox';if(q.isChrome())return 'Google Chrome';return (s._("' your browser ',"));},_installLinks:function(){return (g.createElement(j,null,g.createElement(u,{style:{width:'100%',textAlign:'center'}},g.createElement(i,{href:"https://www.google.com/chrome/index.html",target:"_blank"},g.createElement(h,{className:"_4_if",src:t('/images/chat/webrtc/chrome.png'),alt:"Chrome",width:"64"}),g.createElement(o,{display:"block"},"Google Chrome")))));}});e.exports=v;},null);
__d("FBRTCScreenSharingInstallExtensionDialog.react",["React","Link.react","List.react","XUIDialog.react","XUIDialogBody.react","XUIDialogTitle.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n='https://fburl.com/94674949',o='chrome://extensions',p=g.createClass({displayName:"FBRTCScreenSharingInstallExtensionDialog",render:function(){return (g.createElement(j,{shown:true,width:440,layerHideOnBlur:false},g.createElement(l,{showCloseButton:true},g.createElement("span",null,m._("Install Screen Sharing Extension"))),g.createElement(k,null,this._dialogBody())));},_dialogBody:function(){return (g.createElement("p",null,m._("To share your screen, please install an extension:"),g.createElement(i,{border:"none",spacing:"small"},g.createElement("li",null,"1. Download the ",g.createElement(h,{href:n,target:"_blank"},"Screen Sharing Extension")," and open the file in Finder"),g.createElement("li",null,"2. Open ",o," in a separate browser tab"),g.createElement("li",null,"3. Drag and drop the downloaded extension into the extensions"+' '+"browser tab"),g.createElement("li",null,"4. Restart your call and share your screen"))));}});e.exports=p;},null);
__d("FBRTCCallDialogController",["FBRTCSettingsDialog.react","FBRTCStruct","FBRTCMediaAccessErrorDialog.react","FBRTCPeerBrowserUnsupportedDialog.react","FBRTCScreenSharingUnsupportedBrowserDialog.react","FBRTCScreenSharingInstallExtensionDialog.react","FBRTCUserSettings","React","ReactLayeredComponentMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=new h(['ERROR_ACCESSING_MEDIA','PEER_BROWSER_UNSUPPORTED','SETTINGS','SCREEN_SHARING_UNSUPPORTED','INSTALL_SCREEN_SHARING_EXT']),q=n.createClass({displayName:"DialogOwner",mixins:[o],renderLayers:function(){if(this.props.dialogType===p.ERROR_ACCESSING_MEDIA)return {dialog:n.createElement(i,null)};if(this.props.dialogType===p.PEER_BROWSER_UNSUPPORTED){var s=this.props.callModel.peerName();return {dialog:n.createElement(j,{peerName:s})};}if(this.props.dialogType===p.SETTINGS)return {dialog:n.createElement(g,{onToggle:this._onToggle})};if(this.props.dialogType===p.SCREEN_SHARING_UNSUPPORTED)return {dialog:n.createElement(k,{onToggle:this._onToggle})};if(this.props.dialogType===p.INSTALL_SCREEN_SHARING_EXT)return {dialog:n.createElement(l,{onToggle:this._onToggle})};return {};},_onToggle:function(s){setTimeout(function(){if(!s)r.hideDialog();},0);},render:function(){return n.createElement("div",null);}}),r={dialogTypes:p,setDialogContainer:function(s){this.container=s;this.currentDialogType=null;this.callModel=null;this._render();},showDialog:function(s,t){this.currentDialogType=s;this._setCallModel(t);this._render();},hideDialog:function(){this.currentDialogType=null;this._render();},_render:function(){n.render(n.createElement(q,{dialogType:this.currentDialogType,callModel:this.callModel}),this.container);},_setCallModel:function(s){if(s!==this.callModel){this.callModel=s;if(this.callModel)this.callModel.addListener(this._onCallModelChanged.bind(this));}},_onCallModelChanged:function(){if(this.callModel.isEnded()&&this.currentDialogType===p.SETTINGS)this.hideDialog();}};m.addListener('saved',r.hideDialog,r);e.exports=r;},null);
__d("FBRTCRetriableMessage",["mixInEventEmitter","FBRTCConstants"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=10000,j=7000,k=1;function l(m){"use strict";this.$FBRTCRetriableMessage0=m;this.$FBRTCRetriableMessage1=i;this.$FBRTCRetriableMessage2=k;this.$FBRTCRetriableMessage3=null;this.$FBRTCRetriableMessage4=null;this.$FBRTCRetriableMessage5=null;}l.prototype.sendMessage=function(m,n,o,p,q){"use strict";this.$FBRTCRetriableMessage3=n;switch(m){case h.PayloadType.PCRESTART_OFFER:this.$FBRTCRetriableMessage4=this.$FBRTCRetriableMessage0.sendPCRestartOffer(n,o,p,q);break;case h.PayloadType.OFFER:this.$FBRTCRetriableMessage4=this.$FBRTCRetriableMessage0.sendOffer(n,o,p,q);break;case h.PayloadType.ANSWER:this.$FBRTCRetriableMessage1=j;this.$FBRTCRetriableMessage4=this.$FBRTCRetriableMessage0.sendAnswer(n,o,p,q);break;}this.$FBRTCRetriableMessage6();};l.prototype.isAckMsg=function(m){"use strict";return (this.$FBRTCRetriableMessage4&&this.$FBRTCRetriableMessage4.msg_id===m.ack_id);};l.prototype.stopRetrying=function(){"use strict";if(this.$FBRTCRetriableMessage5){clearTimeout(this.$FBRTCRetriableMessage5);this.$FBRTCRetriableMessage3=null;this.$FBRTCRetriableMessage4=null;this.$FBRTCRetriableMessage5=null;}};l.prototype.$FBRTCRetriableMessage6=function(){"use strict";this.$FBRTCRetriableMessage5=setTimeout(this.$FBRTCRetriableMessage7.bind(this),this.$FBRTCRetriableMessage1);};l.prototype.$FBRTCRetriableMessage7=function(){"use strict";if(this.$FBRTCRetriableMessage2<1){this.emit('timeoutFailure');}else{this.emit('sendingRetry');this.$FBRTCRetriableMessage0.resendSdpMessage(this.$FBRTCRetriableMessage3,this.$FBRTCRetriableMessage4);this.$FBRTCRetriableMessage6();this.$FBRTCRetriableMessage2-=1;}};g(l,{sendingRetry:true,timeoutFailure:true});e.exports=l;},null);
__d("FBRTCScreenMedia",["FBRTCDispatcher","FBRTCUserMediaRequest","keyMirror"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i({STREAM_READY:null,STREAM_FAILED:null}),k={STREAM_TYPE:h.STREAM_TYPE.SCREEN_SHARING,Types:j,requestScreenMedia:function(l){var m=new h(this.STREAM_TYPE);m.videoSource=l;m.addListener('success',this._onRequestSuccess,this);m.addListener('failed',this._onRequestFailure,this);m.request();},_onRequestSuccess:function(l){g.dispatch({type:j.STREAM_READY,stream:l});},_onRequestFailure:function(l){var m=(l.name)?l.name:l;g.dispatch({type:j.STREAM_FAILED,error:m});}};e.exports=k;},null);
__d("FBRTCScreenSharingModel",["FBRTCLogger","FBRTCScreenStreamWrapper","FBRTCStore"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';for(var j in i)if(i.hasOwnProperty(j))l[j]=i[j];var k=i===null?null:i.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=i;function l(){i.call(this);this.$FBRTCScreenSharingModel0=null;this.$FBRTCScreenSharingModel1=new h();this.$FBRTCScreenSharingModel2=g.getInstance();}l.prototype.isEnabled=function(){return !!this.$FBRTCScreenSharingModel0;};l.prototype.setStream=function(m,n){if(m&&!n)m.getVideoTracks()[0].onended=function(){this.__emitChange();}.bind(this);if(this.$FBRTCScreenSharingModel1===null)this.$FBRTCScreenSharingModel1=new h();this.$FBRTCScreenSharingModel1.setStream(m,!n);};l.prototype.getStream=function(){return this.$FBRTCScreenSharingModel1;};l.prototype.onStart=function(m){if(!m){this.$FBRTCScreenSharingModel2.logToConsole('Invalid stream id');return;}this.$FBRTCScreenSharingModel2.logToConsole('Enabling screen sharing');this.$FBRTCScreenSharingModel0=m;};l.prototype.onStop=function(){this.$FBRTCScreenSharingModel0=null;if(this.$FBRTCScreenSharingModel1)this.$FBRTCScreenSharingModel1.stopStream();};l.prototype.__onDispatch=function(m){};e.exports=l;},null);
__d("FBRTCScreenSharingController",["FBRTCCallDialogController","FBRTCLogger","FBRTCScreenMedia","FBRTCScreenSharingModel","FBRTCScreenSharingUI","FBRTCScreenSharingUtils","FBRTCStore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(){m.call(this);this.$FBRTCScreenSharingController0=false;this.$FBRTCScreenSharingController1=h.getInstance();this.$FBRTCScreenSharingController2=new j();if(l.isScreenSharingSupported()){this.$FBRTCScreenSharingController2.addListener(this.$FBRTCScreenSharingController3.bind(this));l.checkExtensionInstalled();}}p.prototype.isEnabled=function(){return this.$FBRTCScreenSharingController0&&this.$FBRTCScreenSharingController2.isEnabled();};p.prototype.getStream=function(){return this.$FBRTCScreenSharingController2.getStream();};p.prototype.onStop=function(){this.$FBRTCScreenSharingController2.onStop();};p.prototype.onEndCall=function(){k.close();};p.prototype.setRemoteStream=function(q){if(!q){k.close();this.$FBRTCScreenSharingController2.setStream(q,true);}else this.$FBRTCScreenSharingController2.setStream(q,true);};p.prototype.toggleScreenSharing=function(q){if(!l.isSupportedBrowser()){g.showDialog(g.dialogTypes.SCREEN_SHARING_UNSUPPORTED,q);}else if(!l.isExtensionInstalled()){g.showDialog(g.dialogTypes.INSTALL_SCREEN_SHARING_EXT,q);}else{var r=(this.$FBRTCScreenSharingController2.isEnabled())?'SC_CANCEL':'SC_REQUEST';window.postMessage({recipient:l.RECIPIENT,type:r,text:'toggle screen sharing'},'*');window.addEventListener('message',this.$FBRTCScreenSharingController4.bind(this));}};p.prototype.$FBRTCScreenSharingController4=function(event){if(event.origin!=window.location.origin){this.$FBRTCScreenSharingController1.logToConsole('Different origin for this event, do nothing');return;}if(!event.data.recipient||event.data.recipient!='SC_DOM'){this.$FBRTCScreenSharingController1.logToConsole('Wrong recipient, do nothing');return;}if(!event.data.type){this.$FBRTCScreenSharingController1.logToConsole('No event type, exiting');return;}window.removeEventListener('message',this.$FBRTCScreenSharingController4.bind(this));switch(event.data.type){case 'SC_DIALOG_SUCCESS':this.$FBRTCScreenSharingController5(event.data.streamId);break;case 'SC_DIALOG_CANCEL':break;case 'SC_CANCELLED':this.$FBRTCScreenSharingController3();break;default:this.$FBRTCScreenSharingController1.logToConsole('Unexpected event type');}};p.prototype.$FBRTCScreenSharingController5=function(q){if(this.$FBRTCScreenSharingController0){this.$FBRTCScreenSharingController1.logToConsole('Screen sharing already enabled, do nothing');return;}this.$FBRTCScreenSharingController2.onStart(q);if(this.$FBRTCScreenSharingController2.isEnabled())i.requestScreenMedia(q);};p.prototype.$FBRTCScreenSharingController3=function(){if(!this.$FBRTCScreenSharingController0){this.$FBRTCScreenSharingController1.logToConsole('Screen sharing already disabled, do nothing');return;}this.$FBRTCScreenSharingController0=false;this.__emitChange();};p.prototype.__onDispatch=function(q){switch(q.type){case i.Types.STREAM_READY:this.$FBRTCScreenSharingController0=!!q.stream;this.$FBRTCScreenSharingController2.setStream(q.stream,false);this.__emitChange();break;case i.Types.STREAM_FAILED:this.$FBRTCScreenSharingController1.logErrorWithoutID("Failed retrieving the stream with error: "+q.error);break;default:break;}};e.exports=p;},null);
__d("FBRTCWindowManager",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={height:0,width:0,top:0,left:0},h={height:452,width:534,bottomRightOffset:50},i={init:function(j,k){this._window=j;this._callModel=k;k.addListener(this._setProgressIndicator.bind(this));this._setProgressIndicator();this._monitorOpenerForChanges();this._storePosition();},updatePosition:function(j){if(!this._window)return;if(j&&g.height>0&&g.width>0){this._window.moveTo(g.left,g.top);this._window.resizeTo(g.width,g.height);return;}this._storePosition();this._window.resizeTo(h.width,h.height);var k=screen.width-h.width-h.bottomRightOffset,l=screen.height-h.height-h.bottomRightOffset;this._window.moveTo(k,l);},_setProgressIndicator:function(){if(this._callModel.isEnded()){this._window.rtcCallInProgessWith=null;}else this._window.rtcCallInProgessWith=this._callModel.peerID.toString();},_monitorOpenerForChanges:function(){if(this._window.opener)try{this._window.opener.addEventListener("unload",function(event){this._passWindowToOpener(10);}.bind(this));}catch(j){}},_passWindowToOpener:function(j){setTimeout(function(){setTimeout(function(){if(this._window.opener&&!this._window.opener.closed)this._window.opener.rtcCallChildWindow=this._window;}.bind(this),1);if(j>1)this._passWindowToOpener(j-1);}.bind(this),1000);},_storePosition:function(){if(this._window){if(this._window.innerWidth!==(void 0)){g.height=this._window.outerHeight;g.width=this._window.outerWidth;}else{g.height=this._window.screen.height;g.width=this._window.screen.width;}if(this._window.screenLeft!==(void 0)){g.left=this._window.screenLeft;g.top=this._window.screenTop;}else{g.left=this._window.screenX;g.top=this._window.screenY;}}}};e.exports=i;},null);
__d("FBRTCCallController",["ErrorUtils","Run","FBRTCCallConnection","FBRTCCallConnectionMonitor","FBRTCCallControlActions","FBRTCCallModel","FBRTCCallMonitor","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConfig","FBRTCConstants","FBRTCDispatcher","FBRTCExperiments","FBRTCIceCache","FBRTCLocalMessageQueue","FBRTCLogger","FBRTCMessage","FBRTCMessageDedup","FBRTCMessageListener","FBRTCMessageSender","FBRTCPCConfig","FBRTCTurnDiscovery","FBRTCSdpUtils","FBRTCUserMedia","FBRTCViewController","FBRTCCallModelStatePusher","FBRTCCallDialogController","FBRTCRetriableMessage","FBRTCUserMediaRequest","FBRTCUserSettings","FBRTCScreenSharingController","FBRTCScreenSharingUtils","FBRTCStreamWrapper","FBRTCUrlManager","FBRTCWindowManager","fbt","randomInt","AvailableList"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa){b.__markCompiled&&b.__markCompiled();b('AvailableList');var ra=60000;function sa(){return qa(0,4294967295);}function ta(ua,va,wa,xa){"use strict";this.$FBRTCCallController0=v.getInstance();this.$FBRTCCallController1=new u();this.$FBRTCCallController2=o.getInstance();this.$FBRTCCallController3=null;this.$FBRTCCallController4=false;if(!wa){this.$FBRTCCallController3=this.$FBRTCCallController1.getOffer(ua);if(this.$FBRTCCallController3){x.check(ua,this.$FBRTCCallController3.call_id,this.$FBRTCCallController3.msg_id);}else wa=true;}if(!va)va=this.$FBRTCCallController3?this.$FBRTCCallController3.call_id:sa();this.$FBRTCCallController0.logCallAction(ua,va,v.CallAction.POPUP_OPENED);this.$FBRTCCallController5=new l({peerID:ua,callID:va,isCaller:wa});if(this.$FBRTCCallController3&&!ca.isVideoSupported(this.$FBRTCCallController3.sdp))this.$FBRTCCallController5.isRemoteVideoSupported=false;this.$FBRTCCallController5.localStream.setVideoEnabled(!xa);this.$FBRTCCallController6=new fa(this.$FBRTCCallController5);this.$FBRTCCallController7=n.restoreOrInitialize(this.$FBRTCCallController2,ua,va,wa,this.$FBRTCCallController3);this.$FBRTCCallController7.onPopupOpened();na.init(this.$FBRTCCallController5.peerID);oa.init(window,this.$FBRTCCallController5);this.$FBRTCCallController8=new ka();if(la.isScreenSharingSupported())this.$FBRTCCallController8.addListener(this.$FBRTCCallController9.bind(this));this.$FBRTCCallControllera=new ea(this.$FBRTCCallController5,this.$FBRTCCallController7,this.$FBRTCCallController2);this.$FBRTCCallControllera.onStartCall=this.$FBRTCCallControllerb.bind(this);this.$FBRTCCallControllera.init();this.$FBRTCCallControllerc=new i();this.$FBRTCCallControllerc.addListener('remoteStreamAdded',this.$FBRTCCallControllerd,this);this.$FBRTCCallControllerc.addListener('remoteStreamRemoved',this.$FBRTCCallControllere,this);this.$FBRTCCallControllerc.addListener('sdpCreated',this.$FBRTCCallControllerf,this);this.$FBRTCCallControllerc.addListener('localIceCandidateCreated',this.$FBRTCCallControllerg,this);this.$FBRTCCallControllerc.addListener('remoteDescriptionSet',this.$FBRTCCallControllerh,this);this.$FBRTCCallControllerc.addListener('connected',this.$FBRTCCallControlleri,this);this.$FBRTCCallControllerc.addListener('disconnected',this.$FBRTCCallControllerj,this);this.$FBRTCCallControllerc.addListener('connectionUnstable',this.$FBRTCCallControllerk,this);this.$FBRTCCallControllerc.addListener('connectionError',this.$FBRTCCallControllerl,this);this.$FBRTCCallControllerm=false;this.$FBRTCCallControllern=false;this.$FBRTCCallControllero=new j(this.$FBRTCCallControllerc,this.$FBRTCCallController7);this.$FBRTCCallControllero.addListener('connectionPoor',this.$FBRTCCallControllerp,this);this.$FBRTCCallControllerq=new z();this.$FBRTCCallControllerq.onMessageSent=this.$FBRTCCallControllerr.bind(this);this.$FBRTCCallControllerq.onSendFailure=this.$FBRTCCallControllers.bind(this);this.$FBRTCCallControllert=null;this.$FBRTCCallControlleru=null;this.$FBRTCCallControllerv=new t();this.$FBRTCCallControllerw=false;h.onBeforeUnload(this.$FBRTCCallControllerx.bind(this),false);h.onUnload(this.$FBRTCCallControllery.bind(this));g.addListener(this.$FBRTCCallControllerz.bind(this),true);y.init();y.setMessageHandler(this.$FBRTCCallControllerA,this);var ya=this;this.$FBRTCCallControllerB=new m(this.$FBRTCCallController5);this.$FBRTCCallControllerB.startHeartbeat(function(){return ya.$FBRTCCallController7;});this.$FBRTCCallControllerC=null;ja.addListener('saved',this.$FBRTCCallControllerD,this);ba.addListener('receivedTurnCreds',this.$FBRTCCallControllerE,this);ba.addListener('failed',this.$FBRTCCallControllerF,this);ba.requestTurnCreds(this.$FBRTCCallController5);r.register(this.__onDispatch.bind(this));}ta.prototype.__onDispatch=function(ua){"use strict";switch(ua.type){case k.Types.HANG_UP:this.$FBRTCCallControllerG(q.CallEndReason.HANGUP_CALL,false,true,false);break;case k.Types.TOGGLE_SCREEN_SHARING:if(this.$FBRTCCallController8){this.$FBRTCCallController8.toggleScreenSharing(this.$FBRTCCallController5);this.$FBRTCCallController0.logCallAction(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,v.CallAction.TOGGLE_SCREEN_SHARING,this.$FBRTCCallController8.isEnabled());}break;case k.Types.SHOW_SETTINGS:ga.showDialog(ga.dialogTypes.SETTINGS,this.$FBRTCCallController5);break;}};ta.prototype.getCallModel=function(){"use strict";return this.$FBRTCCallController5;};ta.prototype.getViewController=function(){"use strict";return this.$FBRTCCallControllera;};ta.prototype.getConnection=function(){"use strict";return this.$FBRTCCallControllerc;};ta.prototype.sendData=function(ua,va){"use strict";this.$FBRTCCallControllerc.sendData({topic:ua,data:va});};ta.prototype.addDataChannelListener=function(ua,va){"use strict";return this.$FBRTCCallControllerc.addListener('data_message',ua,va);};ta.prototype.$FBRTCCallControllerb=function(ua){"use strict";this.$FBRTCCallController7.onCallStarted(ua);this.startCallProcess();};ta.prototype.startCallProcess=function(){"use strict";this.$FBRTCCallControllerH();this.$FBRTCCallControllera.userMediaRequested();};ta.prototype.waitForUserInput=function(){"use strict";this.$FBRTCCallControllera.waitForUserInput();};ta.prototype.$FBRTCCallControllerH=function(){"use strict";da.once('streamReady',this.$FBRTCCallControllerI,this);da.addListener('accessDenied',this.$FBRTCCallControllerJ,this);da.addListener('accessFailed',this.$FBRTCCallControllerK,this);da.addListener('accessGranted',this.$FBRTCCallControllerL,this);this.$FBRTCCallController5.localStream.addListener('streamStarted',function(){var ua=this.$FBRTCCallController5.localStream.videoWidth,va=this.$FBRTCCallController5.localStream.videoHeight;this.$FBRTCCallController7.setVideoCaptureStats(ua,va);var wa=p.shouldUseHdVideo(),xa=this.$FBRTCCallController5.isRemoteVideoSupported;if((wa&&xa&&va===ia.HD_HEIGHT)||(!wa&&xa&&va===ia.SD_HEIGHT))s.logExposure(s.QE.VIDEO_QUALITY);}.bind(this));this.$FBRTCCallControllerM();};ta.prototype.$FBRTCCallControllerM=function(){"use strict";var ua;if(!this.$FBRTCCallController5.isRemoteVideoSupported){ua=da.STREAM_TYPE.NO_VIDEO;}else if(p.shouldUseHdVideo()){ua=da.STREAM_TYPE.HD_VIDEO;}else ua=da.STREAM_TYPE.SD_VIDEO;da.requestUserMedia(ua,ja.savedMic,ja.savedCamera);};ta.prototype.$FBRTCCallControllerD=function(){"use strict";this.$FBRTCCallController0.logCallAction(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,v.CallAction.USER_SETTINGS_CHANGED);da.once('streamReady',function(ua){ja.updateForLocalStream(ua);this.$FBRTCCallController5.setLocalStream(ua);this.$FBRTCCallControllerN();}.bind(this));this.$FBRTCCallControllerM();};ta.prototype.$FBRTCCallController9=function(){"use strict";var ua=this.$FBRTCCallController8.isEnabled();this.$FBRTCCallController0.logCallAction(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,v.CallAction.SCREEN_SHARING_ENABLED,ua);var va=this.$FBRTCCallController8.getStream();if(ua){this.$FBRTCCallControllerc.addScreenStream(va);}else{this.$FBRTCCallControllerc.removeScreenStream(va);this.$FBRTCCallController8.onStop();}this.$FBRTCCallControllerN();this.$FBRTCCallController5.selfViewOpen=!ua;oa.updatePosition(!ua);this.$FBRTCCallController5.setScreenSharingStatus(ua);};ta.prototype.$FBRTCCallControllerd=function(event){"use strict";if(ma.isScreenStream(event.stream)){this.$FBRTCCallController8.setRemoteStream(event.stream);this.$FBRTCCallController5.setRemoteScreenStream(this.$FBRTCCallController8.getStream());}else this.$FBRTCCallControllera.onRemoteStreamAdded(event);};ta.prototype.$FBRTCCallControllere=function(event){"use strict";if(ma.isScreenStream(event.stream)){this.$FBRTCCallController5.setRemoteScreenStream(null);this.$FBRTCCallController8.setRemoteStream(null);}};ta.prototype.$FBRTCCallControllerk=function(){"use strict";this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Network unstable');};ta.prototype.$FBRTCCallControllerp=function(){"use strict";this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Network poor');s.logExposure(s.QE.AUTO_DISABLE);if(p.shouldAutoDisableVideo())this.$FBRTCCallController5.autoDisableVideo();};ta.prototype.$FBRTCCallControllerz=function(ua){"use strict";var va=ua.message+'; '+ua.stackFrames[0].identifier;this.$FBRTCCallController0.logError(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'JSError: '+va);};ta.prototype.$FBRTCCallControllerx=function(){"use strict";if(this.$FBRTCCallController5.isInProgress())return pa._("Opuszczenie tej strony spowoduje zako\u0144czenie po\u0142\u0105czenia.");};ta.prototype.$FBRTCCallControllery=function(){"use strict";if(this.$FBRTCCallController5.isEnded())return;var ua=this.$FBRTCCallController5.isUserMediaPending(),va=this.$FBRTCCallController5.isUserMediaDenied(),wa=q.CallEndReason.HANGUP_CALL,xa='BrowserClosed';if(ua||va){wa=q.CallEndReason.CLIENT_ERROR;xa=ua?'MediaPending':'MediaDenied';}else if(this.$FBRTCCallController5.isAwaitingUserStart())xa='AwaitingUserStart';this.$FBRTCCallControllerG(wa,false,true,true,xa);};ta.prototype.$FBRTCCallControllerE=function(ua){"use strict";this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Received Turn Creds');aa.setTurnCredentials(ua);this.$FBRTCCallControllera.onTurnCredentialsReady(ua);this.$FBRTCCallControllerO();};ta.prototype.$FBRTCCallControllerF=function(){"use strict";this.$FBRTCCallController0.logError(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Failed to get turn creds');this.$FBRTCCallControllerG(q.CallEndReason.CLIENT_ERROR,false,!this.$FBRTCCallController5.isCaller,false,'NoTurnCreds');};ta.prototype.$FBRTCCallControllerO=function(){"use strict";if(this.$FBRTCCallController5.canStartCall()){na.onCallStarted();this.$FBRTCCallControllerc.init(this.$FBRTCCallController5.localStream);if(!this.$FBRTCCallController3){this.$FBRTCCallControllerc.createOffer();}else{if(this.$FBRTCCallController3.hasOwnProperty('videoon'))this.$FBRTCCallControllerP(this.$FBRTCCallController3.videoon);if(this.$FBRTCCallController3.hasOwnProperty('experiments'))this.$FBRTCCallController5.setSignalingExperiments(this.$FBRTCCallController3.experiments);this.$FBRTCCallControllerQ(this.$FBRTCCallController3.sdp,true);this.$FBRTCCallController1.removeOffer(this.$FBRTCCallController5.peerID);this.$FBRTCCallController3=null;}this.$FBRTCCallController1.enableDequeuing(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,this.$FBRTCCallControllerA.bind(this));}};ta.prototype.$FBRTCCallControllerN=function(){"use strict";if(this.$FBRTCCallController5.isAwaitingAnswer()){this.$FBRTCCallControllerm=true;}else{this.$FBRTCCallControllerm=false;this.$FBRTCCallControllern=false;if(this.$FBRTCCallController5.supportsSdpUpdate()){this.$FBRTCCallControllerc.createSdpUpdate();}else{this.$FBRTCCallController4=true;this.$FBRTCCallControllerv.reset(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID);this.$FBRTCCallControllerw=false;this.$FBRTCCallControllerc.createOffer();}}};ta.prototype.$FBRTCCallControllerI=function(ua){"use strict";ja.updateForLocalStream(ua);this.$FBRTCCallControllera.onLocalStreamReady(ua);this.$FBRTCCallController5.localStream.addListener('tracksChanged',this.$FBRTCCallControllerR.bind(this));this.$FBRTCCallControllerO();};ta.prototype.$FBRTCCallControllerJ=function(){"use strict";this.$FBRTCCallController0.logCallAction(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,v.CallAction.DENIED_PERMISSION);this.$FBRTCCallControllera.userMediaDenied();};ta.prototype.$FBRTCCallControllerK=function(ua){"use strict";this.$FBRTCCallControllerG(q.CallEndReason.CLIENT_ERROR,false,true,false,ua);ga.showDialog(ga.dialogTypes.ERROR_ACCESSING_MEDIA,this.$FBRTCCallController5);};ta.prototype.$FBRTCCallControllerL=function(){"use strict";this.$FBRTCCallControllera.userMediaGranted();};ta.prototype.$FBRTCCallControllerf=function(ua){"use strict";switch(ua.type){case 'offer':this.$FBRTCCallControllerS(ua.sdp);break;case 'answer':this.$FBRTCCallControllerT(ua.sdp);break;case 'sdp_update':this.$FBRTCCallControllerU(ua.sdp);break;default:break;}};ta.prototype.$FBRTCCallControllerU=function(ua){"use strict";this.$FBRTCCallControllerq.sendSdpUpdate(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,ua,this.$FBRTCCallController5.localStream.hasVideo());};ta.prototype.$FBRTCCallControllerS=function(ua){"use strict";var va;if(!this.$FBRTCCallController4){va=q.PayloadType.OFFER;}else{va=q.PayloadType.PCRESTART_OFFER;this.$FBRTCCallController4=false;}this.$FBRTCCallControllert=new ha(this.$FBRTCCallControllerq);this.$FBRTCCallControllert.addListener('sendingRetry',this.$FBRTCCallControllerV.bind(this));this.$FBRTCCallControllert.addListener('timeoutFailure',this.$FBRTCCallControllerW.bind(this));this.$FBRTCCallControllert.sendMessage(va,this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,ua,this.$FBRTCCallController5.localStream.hasVideo());this.$FBRTCCallControllerC=setTimeout(function(){this.$FBRTCCallControllerG(q.CallEndReason.NO_ANSWER_TIMEOUT,false,true,false);}.bind(this),ra);};ta.prototype.$FBRTCCallControllerW=function(){"use strict";var ua;if(this.$FBRTCCallController5.receivedNack){ua=q.CallEndReason.UNSUPPORTED_VERSION;ga.showDialog(ga.dialogTypes.PEER_BROWSER_UNSUPPORTED,this.$FBRTCCallController5);}else ua=q.CallEndReason.OTHER_NOT_CAPABLE;this.$FBRTCCallControllerG(ua,false,true,false,'TimedOut');};ta.prototype.$FBRTCCallControllerR=function(){"use strict";this.$FBRTCCallControllern=this.$FBRTCCallController5.isAwaitingAnswer();if(!this.$FBRTCCallController5.isRemoteVideoSupported)return;this.$FBRTCCallControllerq.sendMuteStateUpdate(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,this.$FBRTCCallController5.localStream.hasVideo());};ta.prototype.$FBRTCCallControllerP=function(ua){"use strict";this.$FBRTCCallController5.remoteStream.setVideoEnabled(ua);};ta.prototype.$FBRTCCallControllerT=function(ua){"use strict";var va=(this.$FBRTCCallController5.localStream.hasVideo()&&this.$FBRTCCallController5.isRemoteVideoSupported);this.$FBRTCCallControlleru=new ha(this.$FBRTCCallControllerq);this.$FBRTCCallControlleru.addListener('sendingRetry',this.$FBRTCCallControllerV.bind(this));this.$FBRTCCallControlleru.sendMessage(q.PayloadType.ANSWER,this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,ua,va);};ta.prototype.$FBRTCCallControllerV=function(){"use strict";var ua=this.$FBRTCCallControllerc.getCreatedIceCandidates();for(var va=0;va<ua.length;va++)this.$FBRTCCallControllerX(ua[va]);};ta.prototype.$FBRTCCallControllerX=function(ua){"use strict";this.$FBRTCCallControllerq.sendIceCandidate(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,ua);};ta.prototype.$FBRTCCallControllerQ=function(ua,va){"use strict";var wa=ca.isVideoSupported(ua);this.$FBRTCCallController5.isRemoteVideoSupported=wa;this.$FBRTCCallControllerc.setPeerSupportsVideo(wa);if(va){this.$FBRTCCallControllerc.onReceivedOfferSDP(ua);}else this.$FBRTCCallControllerc.onReceivedAnswerSDP(ua);};ta.prototype.$FBRTCCallControllerg=function(ua){"use strict";this.$FBRTCCallControllerX(ua);};ta.prototype.$FBRTCCallControllerh=function(){"use strict";this.$FBRTCCallControllerw=true;var ua=this;this.$FBRTCCallControllerv.drainCandidates(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,function(va){ua.$FBRTCCallControllerc.onReceivedRemoteIceCandidate(va);});};ta.prototype.$FBRTCCallControlleri=function(){"use strict";this.$FBRTCCallControllerY();this.$FBRTCCallController7.onCallConnected();this.$FBRTCCallControllerB.onCallHeartbeat(this.$FBRTCCallController7);this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Call Connected');};ta.prototype.$FBRTCCallControllerj=function(){"use strict";this.$FBRTCCallControllerG(q.CallEndReason.CONNECTION_DROPPED,false,true,false);};ta.prototype.$FBRTCCallControllerl=function(ua){"use strict";this.$FBRTCCallControllerG(q.CallEndReason.WEBRTC_ERROR,false,true,false,ua.endCallSubreason);this.$FBRTCCallController0.logError(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'webrtc error: '+JSON.stringify(ua.details));};ta.prototype.$FBRTCCallControllers=function(ua,va){"use strict";this.$FBRTCCallControllerG(ua,false,false,false,va);};ta.prototype.$FBRTCCallControllerr=function(ua,va){"use strict";var wa=va.call_id,xa=va.type;if(this.$FBRTCCallController5.isEnded()){this.$FBRTCCallController0.logError(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Message sent after call ended: '+xa);return;}if(this.$FBRTCCallController5.peerID!==ua||this.$FBRTCCallController5.callID!==wa)return;this.$FBRTCCallControllera.onMessageTypeSent(xa);this.$FBRTCCallController7.onMessageSent(va);};ta.prototype.$FBRTCCallControllerA=function(ua){"use strict";var va;try{va=new w(ua);}catch(wa){this.$FBRTCCallController0.logError(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Unknown data: '+JSON.stringify(ua));return;}this.$FBRTCCallController0.logReceivedMessage(va.peerID,va.callID,va.msg);if(this.$FBRTCCallController5.isEnded()){this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Ignoring message (call ended): '+va.msgID);return;}if(!x.check(va.peerID,va.callID,va.msgID)){this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Ignoring message (duplicate): '+va.msgID);return;}if(this.$FBRTCCallController5.peerID&&this.$FBRTCCallController5.peerID!==va.peerID){if(va.isOffer())this.$FBRTCCallControllerZ(va);this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Ignoring message (different peer): '+va.msgID);return;}if(!va.isForCall(this.$FBRTCCallController5)){this.$FBRTCCallController0.logInfo(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Ignoring message (different call): '+va.msgID);return;}this.$FBRTCCallControllera.onMessageTypeReceived(va.msgType);if(this.$FBRTCCallController5.callID&&this.$FBRTCCallController5.callID===va.callID)this.$FBRTCCallController7.onFullMessageReceived(va);this.$FBRTCCallController5.setSignalingExperiments(va.getSignalingExperiments());switch(va.msgType){case q.PayloadType.OFFER:case q.PayloadType.ICERESTART_OFFER:case q.PayloadType.PCRESTART_OFFER:this.$FBRTCCallController10(va);break;case q.PayloadType.ANSWER:case q.PayloadType.ICERESTART_ANSWER:case q.PayloadType.PCRESTART_ANSWER:this.$FBRTCCallController11(va);this.$FBRTCCallControllerB.onCallHeartbeat(this.$FBRTCCallController7);break;case q.PayloadType.SDP_UPDATE:this.$FBRTCCallController12(va);break;case q.PayloadType.ICE_CANDIDATE:this.$FBRTCCallController13(va);break;case q.PayloadType.HANGUP:this.$FBRTCCallController14(va);break;case q.PayloadType.OFFER_ACK:this.$FBRTCCallController15();break;case q.PayloadType.OFFER_NACK:this.$FBRTCCallController5.receivedNack=true;break;case q.PayloadType.ANSWER_ACK:this.$FBRTCCallController16();break;case q.PayloadType.MSG_ACK:this.$FBRTCCallController17(va);break;case q.PayloadType.SET_VIDEO:if(this.$FBRTCCallController5.isRemoteVideoSupported)this.$FBRTCCallControllerP(va.msg.videoon);break;case q.PayloadType.VIDEO_REQUEST:this.$FBRTCCallController18(va);break;case q.PayloadType.ACK:case q.PayloadType.OK:case q.PayloadType.PING:case q.PayloadType.OTHER_DISMISS:case q.PayloadType.PRANSWER:break;default:break;}};ta.prototype.$FBRTCCallController18=function(ua){"use strict";var va=ua,wa=va.msg,xa=va.peerID,ya=va.callID,za=va.msgID;if(wa.reqVideoOn){this.$FBRTCCallController5.localStream.setVideoEnabled(true);this.$FBRTCCallControllerP(true);this.$FBRTCCallControllerq.sendAck(xa,ya,wa);this.$FBRTCCallControllerq.sendVideoRequestResponse(xa,ya,za,true);}};ta.prototype.$FBRTCCallControllerZ=function(ua){"use strict";var va=ua.peerID,wa=ua.callID,xa=ua.msg,ya=new n({peerID:va,callID:wa,isCaller:false});ya.onFullMessageReceived(ua);this.$FBRTCCallControllerq.sendOfferAck(va,wa,xa);ya.onOfferAckSent(xa);var za=q.CallEndReason.IN_ANOTHER_CALL;this.$FBRTCCallController19(va,wa,za);ya.onCallEnded(za,false);ya.save(this.$FBRTCCallController2);};ta.prototype.$FBRTCCallController10=function(ua){"use strict";var va=ua.msg;this.$FBRTCCallControllerq.sendOfferAck(this.$FBRTCCallController5.peerID,va.call_id,va);this.$FBRTCCallControllerq.sendOtherDismiss(va.call_id);if(this.$FBRTCCallController1a(va)){this.$FBRTCCallController1b(ua);}else this.$FBRTCCallController1c();};ta.prototype.$FBRTCCallController12=function(ua){"use strict";var va=ua.msg;if(va.hasOwnProperty('videoon'))this.$FBRTCCallControllerP(va.videoon);this.$FBRTCCallControllerc.onReceivedSdpUpdate(va.sdp);};ta.prototype.$FBRTCCallController1a=function(ua){"use strict";if(ua.call_id===this.$FBRTCCallController5.callID)return true;return ((this.$FBRTCCallControllerC||!this.$FBRTCCallController3)&&(!this.$FBRTCCallController5.callID||ua.call_id!==this.$FBRTCCallController5.callID)&&this.$FBRTCCallController5.isCaller&&(!ua.handlescollision||ua.call_id<this.$FBRTCCallController5.callID));};ta.prototype.$FBRTCCallController1b=function(ua){"use strict";var va=ua.msg;if(va.hasOwnProperty('videoon'))this.$FBRTCCallControllerP(va.videoon);this.$FBRTCCallController1d();this.$FBRTCCallController1e();this.$FBRTCCallControllerY();if(this.$FBRTCCallController5.callID!==va.call_id){var wa=q.CallEndReason.OTHER_INSTANCE_HANDLED;this.$FBRTCCallController19(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,wa);this.$FBRTCCallController7.onCallEnded(wa,false);this.$FBRTCCallController7.save(this.$FBRTCCallController2);this.$FBRTCCallController7=new n({peerID:this.$FBRTCCallController5.peerID,callID:va.call_id,isCaller:false});this.$FBRTCCallController7.onFullMessageReceived(ua);this.$FBRTCCallController7.onOfferAckSent(va);this.$FBRTCCallController0.logEvent(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Handling offer collision');}else this.$FBRTCCallController0.logEvent(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Handling offer refresh');this.$FBRTCCallControllerc.end();this.$FBRTCCallControllerw=false;this.$FBRTCCallControllera.reset(va.call_id,this.$FBRTCCallController7);if(this.$FBRTCCallController5.canStartCall()){this.$FBRTCCallControllerQ(va.sdp,true);na.onCallStarted();this.$FBRTCCallControllerR();}else this.$FBRTCCallController3=va;};ta.prototype.$FBRTCCallController1c=function(){"use strict";this.$FBRTCCallController0.logEvent(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Ignoring offer');};ta.prototype.$FBRTCCallController11=function(ua){"use strict";var va=ua.msg;this.$FBRTCCallController1d();this.$FBRTCCallController1e();this.$FBRTCCallControllerq.sendAnswerAck(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,va);if(this.$FBRTCCallControllerm){this.$FBRTCCallControllerN();}else{this.$FBRTCCallControllerQ(va.sdp,false);if(va.hasOwnProperty('videoon'))this.$FBRTCCallControllerP(va.videoon);if(this.$FBRTCCallControllern)this.$FBRTCCallControllerR();}};ta.prototype.$FBRTCCallController17=function(ua){"use strict";var va=ua.msg;if(this.$FBRTCCallControllert&&this.$FBRTCCallControllert.isAckMsg(va)){this.$FBRTCCallController7.onMsgAckReceived(ua,true);this.$FBRTCCallControllera.onMessageTypeReceived(q.PayloadType.OFFER_ACK);this.$FBRTCCallController15();}else if(this.$FBRTCCallControlleru&&this.$FBRTCCallControlleru.isAckMsg(va)){this.$FBRTCCallController7.onMsgAckReceived(ua,false);this.$FBRTCCallController16();}};ta.prototype.$FBRTCCallController15=function(){"use strict";this.$FBRTCCallController1d();this.$FBRTCCallControllerB.onCallHeartbeat(this.$FBRTCCallController7);};ta.prototype.$FBRTCCallController16=function(){"use strict";this.$FBRTCCallControllerY();};ta.prototype.$FBRTCCallController13=function(ua){"use strict";var va=ua.msg;if(va.call_id===this.$FBRTCCallController5.callID&&this.$FBRTCCallControllerw){this.$FBRTCCallControllerc.onReceivedRemoteIceCandidate(va);}else this.$FBRTCCallControllerv.cacheCandidate(this.$FBRTCCallController5.peerID,va.call_id,va);};ta.prototype.$FBRTCCallController14=function(ua){"use strict";var va=ua.msg;if(va.call_id===this.$FBRTCCallController5.callID){this.$FBRTCCallControllerG(va.reason,true,false);}else this.$FBRTCCallController0.logError(this.$FBRTCCallController1f.peerID,this.$FBRTCCallController1f.callID,'Reciving hangup for a different call: '+va.call_id.toString());};ta.prototype.$FBRTCCallControllerG=function(ua,va,wa,xa,ya){"use strict";if(typeof ua=='string'||ua instanceof String)ua=q.endCallReasonFromString(ua);var za=q.fullCallEndReasonString(ua,va);this.$FBRTCCallController0.logCallAction(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,v.CallAction.END_CALL,za);this.$FBRTCCallController1d();this.$FBRTCCallController1e();this.$FBRTCCallControllerY();if(this.$FBRTCCallController5.isEnded()){this.$FBRTCCallController0.logError(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,'Ending an already-ended call');return;}if(wa)this.$FBRTCCallController19(this.$FBRTCCallController5.peerID,this.$FBRTCCallController5.callID,ua,xa);this.$FBRTCCallController8.onEndCall();this.$FBRTCCallControllerc.end();da.end();this.$FBRTCCallControllera.end(ua,va);this.$FBRTCCallController7.onCallEnded(ua,va,null,ya);this.$FBRTCCallController7.save(this.$FBRTCCallController2);};ta.prototype.$FBRTCCallController19=function(ua,va,wa,xa){"use strict";this.$FBRTCCallControllerq.sendHangup(ua,va,wa,xa);this.$FBRTCCallControllerq.sendOtherDismiss(va);};ta.prototype.$FBRTCCallController1d=function(){"use strict";if(this.$FBRTCCallControllert)this.$FBRTCCallControllert.stopRetrying();};ta.prototype.$FBRTCCallControllerY=function(){"use strict";if(this.$FBRTCCallControlleru)this.$FBRTCCallControlleru.stopRetrying();};ta.prototype.$FBRTCCallController1e=function(){"use strict";if(this.$FBRTCCallControllerC)clearTimeout(this.$FBRTCCallControllerC);this.$FBRTCCallControllerC=null;};e.exports=ta;},null);
__d("FBRTCBackground.react",["Image.react","ReactComponentWithPureRenderMixin","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"FBRTCBackground",mixins:[h],propTypes:{messengerUI:l.bool.isRequired,src:l.string},getInitialState:function(){return {showCoverPhoto:true};},render:function(){if(this.props.messengerUI)return null;var n=this.props.src;if(this.state.showCoverPhoto&&n){return (i.createElement("div",{className:"_1_5p"},i.createElement("div",{className:"_1_5q"}),i.createElement(g,{src:n,className:"_1_5r",alt:"",onError:this._imageError})));}else return i.createElement("div",{className:"_1_5p"});},_imageError:function(){this.setState({showCoverPhoto:false});}});e.exports=m;},null);
__d("FBRTCActiveMouseMixin",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g=3000,h={_activeTimeout:(null),_mouseIsActive:(false),_callbacks:([]),componentWillMount:function(){window.addEventListener('mousemove',this._onMouseMove);},componentWillUnmount:function(){window.removeEventListener('mousemove',this._onMouseMove);if(this._activeTimeout!==null)clearTimeout(this._activeTimeout);this._callbacks=[];},addActiveMouseListener:function(i){this._callbacks.push(i);},_onMouseMove:function(i){this._setMouseIsActive(true);if(this._activeTimeout!==null)clearTimeout(this._activeTimeout);this._activeTimeout=setTimeout(function(){this._activeTimeout=null;this._setMouseIsActive(false);}.bind(this),g);},_setMouseIsActive:function(i){if(i===this._mouseIsActive)return;this._mouseIsActive=i;this._callbacks.map(function(j){j(this._mouseIsActive);}.bind(this));}};e.exports=h;},null);
__d("FBRTCCallControlButton.react",["ReactComponentWithPureRenderMixin","React","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=h,k=j.PropTypes,l={END:0,FULL_SCREEN:1,MUTE:2,SETTINGS:3,SHARE_SCREEN:4,VIDEO:5},m=h.createClass({displayName:"FBRTCCallControlButton",mixins:[g],propTypes:{active:k.bool,endButton:k.bool,highlighted:k.bool,iconType:k.number.isRequired,onClick:k.func.isRequired,ref:k.string},defaultProps:function(){return {active:false,endButton:false,highlighted:false};},render:function(){var n=(("_5lms")+(this.props.highlighted?' '+"_5lmy":'')+(this.props.endButton?' '+"_5lmz":''));return (h.createElement("button",{onClick:this.props.onClick,className:n,ref:this.props.ref},this._icon(this.props.iconType,!!this.props.active)));},_icon:function(n,o){if(o)return (h.createElement("i",{className:((("_5ln2")+(n===l.END?' '+"_5ln3":'')+(n===l.FULL_SCREEN?' '+"_5lng":'')+(n===l.MUTE?' '+"_5lnh":'')+(n===l.SETTINGS?' '+"_5lni":'')+(n===l.SHARE_SCREEN?' '+"_5lnj":'')+(n===l.VIDEO?' '+"_5lnk":'')))}));return (h.createElement("i",{className:((("_5ln2")+(n===l.END?' '+"_5ln3":'')+(n===l.FULL_SCREEN?' '+"_5lnl":'')+(n===l.MUTE?' '+"_5lnm":'')+(n===l.SETTINGS?' '+"_5lni":'')+(n===l.SHARE_SCREEN?' '+"_5lnn":'')+(n===l.VIDEO?' '+"_5lnp":'')))}));}});m.IconTypes=l;e.exports=m;},null);
__d("FBRTCCallControls.react",["FBRTCActiveMouseMixin","FBRTCCallControlActions","FBRTCCallControlButton.react","FBRTCFullScreenController","FBRTCScreenSharingUtils","FBRTCUserSettings","LayerFadeOnHide","LayerFadeOnShow","React","ReactLayeredComponentMixin","XUIContextualDialog.react","XUIContextualDialogBody.react","XUIContextualDialogTitle.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=10000,w={READY:0,SHOWN:1,COMPLETE:2},x=o.createClass({displayName:"FBRTCCallControls",mixins:[p,g],getInitialState:function(){return {forceVisible:w.READY,showScreenSharingPopover:false};},componentDidMount:function(){this._listener=j.addListener(this._handleFullScreenChange);this.addActiveMouseListener(function(y){this.setState({mouseActive:y});}.bind(this));},componentWillUnmount:function(){if(this._listener){this._listener.remove();this._listener=null;}},_handleFullScreenChange:function(){this.forceUpdate();},_shouldForceVisible:function(y){var z=y.localStream;return y.videoIsAutoDisabled()||(z.hasStream()&&!z.hasVideoTracks());},componentWillReceiveProps:function(y){if(this._shouldForceVisible(y.callModel)){if(this.state.forceVisible===w.READY){this.setState({forceVisible:w.SHOWN});setTimeout(function(){this.setState({forceVisible:w.COMPLETE});}.bind(this),v);}}else if(this.state.forceVisible===w.SHOWN)this.setState({forceVisible:w.COMPLETE});},_popoverProps:function(y,z){var aa=65,ba={contextRef:function(){return this.refs[y];}.bind(this),position:'above',alignment:'left',width:(l.isEnabled()?z:z-aa),hoverContext:o.findDOMNode(this.refs[y]),behaviors:{LayerFadeOnHide:m,LayerFadeOnShow:n}};return ba;},_videoPopoverProps:function(){var y=this._popoverProps('videoButton',320);if(this.state.forceVisible===w.SHOWN)y.shown=true;return y;},renderLayers:function(){var y,z,aa={};if(!this.props.callModel.isRemoteVideoSupported){z=this.props.callModel.peerShortName();y=(o.createElement(q,o.__spread({},this._videoPopoverProps()),o.createElement(r,null,u._("Video is disabled for this call because {name}'s device does not support video.",[u.param("name",z)]))));}else if(!this.props.callModel.localStream.hasVideoTracks()){y=(o.createElement(q,o.__spread({},this._videoPopoverProps()),o.createElement(s,null,u._("Nie mo\u017cna znale\u017a\u0107 kamery")),o.createElement(r,null,u._("Pod\u0142\u0105cz kamer\u0119 i od\u015bwie\u017c stron\u0119, aby w\u0142\u0105czy\u0107 wideo. Je\u017celi kamera zosta\u0142a pod\u0142\u0105czona, spr\u00f3buj ponownie uruchomi\u0107 przegl\u0105dark\u0119."))));}else if(this.props.callModel.videoIsAutoDisabled())y=(o.createElement(q,o.__spread({},this._videoPopoverProps()),o.createElement(r,null,u._("Sygna\u0142 wideo zosta\u0142 wstrzymany ze wzgl\u0119du na powolne po\u0142\u0105czenie."))));if(y)aa.videoPopover=y;if(this.state.showScreenSharingPopover)aa.screenSharingPopover=this._getScreenSharingPopover();return aa;},toggleMuteAudio:function(y){h.toggleMuteAudio();},toggleMuteVideo:function(y){h.toggleMuteVideo();},toggleFullScreen:function(y){h.toggleFullScreen();},endCall:function(y){h.hangUp();},showSettings:function(y){if(l.isEnabled())h.showSettings();},toggleScreenSharing:function(y){if(k.isScreenSharingSupported())if(this.props.callModel.canPeerReceiveScreenSharing()&&this.props.callModel.getRemoteScreenStream()===null){h.toggleScreenSharing();}else{k.logFailedAttempt(this.props.callModel.peerID);if(!this.state.showScreenSharingPopover){this.setState({showScreenSharingPopover:true});setTimeout(function(){this.setState({showScreenSharingPopover:false});}.bind(this),v/4);}}},render:function(){var y=l.isEnabled(),z=!this.props.callModel.localStream.hasVideo()||!this.props.callModel.isRemoteVideoSupported,aa=k.isScreenSharingSupported(),ba=!this.props.callModel.localStream.hasAudio(),ca=this.props.callModel.isFullScreen();return (o.createElement("div",{className:"_4bbt"},o.createElement("div",{className:this._wrapperClasses()},o.createElement(i,{active:z,highlighted:z,iconType:i.IconTypes.VIDEO,onClick:this.toggleMuteVideo,ref:"videoButton"}),o.createElement(i,{active:ba,iconType:i.IconTypes.MUTE,highlighted:ba,onClick:this.toggleMuteAudio}),this._screenSharingButton(aa),o.createElement(i,{endButton:true,iconType:i.IconTypes.END,onClick:this.endCall}),this._settingsButton(y),o.createElement(i,{active:ca,iconType:i.IconTypes.FULL_SCREEN,onClick:this.toggleFullScreen}))));},_settingsButton:function(y){if(y)return (o.createElement(i,{iconType:i.IconTypes.SETTINGS,onClick:this.showSettings}));},_screenSharingButton:function(y){if(y){var z=this.props.callModel.isScreenSharingEnabled()&&this.props.callModel.canPeerReceiveScreenSharing();return (o.createElement(i,{active:z,highlighted:z,iconType:i.IconTypes.SHARE_SCREEN,onClick:this.toggleScreenSharing,ref:"shareScreenButton"}));}},_getScreenSharingPopover:function(){var y,z,aa=this.props.callModel.peerShortName();if(!this.props.callModel.canPeerReceiveScreenSharing()){y=(u._("Screen sharing is disabled for this call because {name}'s device does not support receiving screen sharing.",[u.param("name",aa)]));}else if(this.props.callModel.getRemoteScreenStream()!==null)y=(u._("{name} is already sharing their screen. You can share your screen as soon as they stop sharing.",[u.param("name",aa)]));if(y)z=(o.createElement(q,o.__spread({},this._screenSharingPopoverProps()),o.createElement(r,null,y)));return z;},_screenSharingPopoverProps:function(){var y=this._popoverProps('shareScreenButton',255);if(this.state.showScreenSharingPopover)y.shown=true;return y;},_wrapperClasses:function(){var y=!this.props.callModel.localStream.hasStream()||this.props.callModel.isEnded(),z=this.state.mouseActive||this.state.forceVisible===w.SHOWN;return (("_4bbx")+(y?' '+"_4bby":'')+(z?' '+"_4bbz":''));}});e.exports=x;},null);
__d("FBRTCButton.react",["MessengerButton.react","ReactComponentWithPureRenderMixin","React","XUIOverlayButton.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"FBRTCButton",mixins:[h],propTypes:{label:n.string.isRequired,messengerUI:n.bool.isRequired,type:n.string.isRequired},render:function(){var p=this.props,q=p.className,r=p.messengerUI,s=p.type,t=(function(u,v){var w={},x=Object.prototype.hasOwnProperty;if(u==null)throw new TypeError();for(var y in u)if(x.call(u,y)&&!x.call(v,y))w[y]=u[y];return w;})(p,{className:1,messengerUI:1,type:1});if(r)return (i.createElement(g,i.__spread({className:q,type:s},t)));return (i.createElement(j,i.__spread({className:l("_1-7l",q)},t)));}});e.exports=o;},null);
__d("FBRTCCallTimer.react",["React"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=g.createClass({displayName:"FBRTCCallTimer",getInitialState:function(){return {secondsElapsed:0};},tick:function(){this.setState({secondsElapsed:this.state.secondsElapsed+1});},componentDidMount:function(){this.interval=setInterval(this.tick,1000);},componentWillUnmount:function(){clearInterval(this.interval);},render:function(){var i=this.state.secondsElapsed;return (g.createElement("span",null,i>=3600?("0"+Math.floor(i/3600)).slice(-2)+':':'',("0"+Math.floor((i%3600)/60)).slice(-2),":",("0"+i%60).slice(-2)));}});e.exports=h;},null);
__d("MessengerSpinner.react",["Image.react","ReactComponentWithPureRenderMixin","React","cx","fbt","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=i,o=n.PropTypes,p=l('/images/mercury/clients/messenger/core/LoadingSpinner.png'),q=l('/images/mercury/clients/messenger/core/LoadingSpinnerGrey.png'),r=24,s=i.createClass({displayName:"MessengerSpinner",mixins:[h],propTypes:{color:o.oneOf(['blue','grey'])},getDefaultProps:function(){return {color:'blue'};},render:function(){return (i.createElement(g,{"aria-label":k._("\u0141adowanie..."),"aria-busy":true,className:m(this.props.className,"_3u55 _3qh2"),height:r,src:this.props.color==='blue'?p:q,width:r}));}});e.exports=s;},null);
__d("FBRTCSpinner.react",["MessengerSpinner.react","ReactComponentWithPureRenderMixin","React","XUISpinner.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"FBRTCSpinner",mixins:[h],propTypes:{messengerUI:l.bool.isRequired},render:function(){if(this.props.messengerUI)return i.createElement(g,{color:"blue"});return i.createElement(j,{background:"dark",size:"large"});}});e.exports=m;},null);
__d("MessengerProfileImageWrapper.react",["ReactComponentWithPureRenderMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MessengerProfileImageWrapper",mixins:[g],propTypes:{isMessengerUser:l.bool,showBadge:l.bool,size:l.number},render:function(){return (h.createElement("div",{className:j("_4ldz",this.props.className),style:{width:this.props.size+'px',height:this.props.size+'px'}},h.createElement("div",{className:"_4ld-",style:{width:this.props.size+'px',height:this.props.size+'px'}},this.props.children),this._renderBadge()));},_renderBadge:function(){if(!this.props.showBadge||this.props.isMessengerUser==null)return null;return (h.createElement(n,{className:"_4ld_",isMessengerUser:this.props.isMessengerUser}));}}),n=h.createClass({displayName:"MessengerBadge",mixins:[g],propTypes:{isMessengerUser:l.bool,size:l.number},render:function(){return (h.createElement("div",{className:j(this.props.className,"_2pom")},h.createElement("div",{className:(("_2pon")+(this.props.isMessengerUser?' '+"_2poo":'')+(!this.props.isMessengerUser?' '+"_2pop":''))})));}});e.exports=m;},null);
__d("MessengerContactImage.react",["Image.react","MessengerProfileImageWrapper.react","ReactComponentWithPureRenderMixin","React"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=j,l=k.PropTypes,m=j.createClass({displayName:"MessengerContactImage",mixins:[i],propTypes:{isMessengerUser:l.bool,size:l.number.isRequired,src:l.string.isRequired},render:function(){return (j.createElement("div",{className:this.props.className},j.createElement(h,{isMessengerUser:this.props.isMessengerUser,size:this.props.size,showBadge:true},j.createElement(g,{height:this.props.size,src:this.props.src,width:this.props.size}))));}});e.exports=m;},null);
__d("FBRTCCallStateInfo.react",["FBRTCButton.react","FBRTCCallModel","FBRTCCallTimer.react","FBRTCConstants","FBRTCSpinner.react","Image.react","MessengerContactImage.react","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=function(t,u){switch(t){case j.CallEndReason.NO_ANSWER_TIMEOUT:case j.CallEndReason.IGNORE_CALL:return p._("Brak odpowiedzi");case j.CallEndReason.INCOMING_TIMEOUT:case j.CallEndReason.NO_PERMISSION:case j.CallEndReason.OTHER_NOT_CAPABLE:case j.CallEndReason.OTHER_CARRIER_BLOCKED:return p._("Nie mo\u017cna si\u0119 po\u0142\u0105czy\u0107");case j.CallEndReason.SIGNALING_MESSAGE_FAILED:case j.CallEndReason.WEBRTC_ERROR:case j.CallEndReason.NO_UI_ERROR:case j.CallEndReason.CALLER_NOT_VISIBLE:case j.CallEndReason.CLIENT_ERROR:return p._("Po\u0142\u0105czenie nieudane");case j.CallEndReason.UNSUPPORTED_VERSION:return p._("Nie mo\u017cna nawi\u0105za\u0107 po\u0142\u0105czenia");case j.CallEndReason.IN_ANOTHER_CALL:return p._("Osoba, do kt\u00f3rej dzwonisz, prowadzi inn\u0105 rozmow\u0119");case j.CallEndReason.CARRIER_BLOCKED:return p._("Prze\u0142\u0105cz si\u0119 na po\u0142\u0105czenie Wi-Fi, aby nawi\u0105za\u0107 po\u0142\u0105czenie");case j.CallEndReason.CLIENT_INTERRUPTED:return p._("Przerwane po\u0142\u0105czenie");case j.CallEndReason.HANGUP_CALL:case j.CallEndReason.ACCEPT_AFTER_HANGUP:return p._("Po\u0142\u0105czenie zako\u0144czono");case j.CallEndReason.CONNECTION_DROPPED:return p._("Po\u0142\u0105czenie zosta\u0142o utracone");case j.CallEndReason.OTHER_INSTANCE_HANDLED:return '';default:return '';}},r=function(t,u){switch(t.uiState){case h.UIState.INIT:case h.UIState.PENDING_LOCAL_MEDIA:case h.UIState.MORE_INIT:case h.UIState.USER_MEDIA_DENIED:return (n.createElement(k,{messengerUI:u}));case h.UIState.CONTACTING:return (n.createElement("p",{className:"_2ze8"},p._("Nawi\u0105zywanie kontaktu...")));case h.UIState.RINGING:return (n.createElement("p",{className:"_2ze8"},p._("Dzwonienie...")));case h.UIState.CALL_CONNECTING:return (n.createElement("p",{className:"_2ze8"},p._("\u0141\u0105czenie...")));case h.UIState.CALL_CONNECTED:return (n.createElement("p",{className:"_2ze8"},n.createElement(i,null)));case h.UIState.CALL_ENDED:return (n.createElement("p",{className:"_2ze8"},q(t.endCallReason,t.isRemoteEnded)));default:return '';}},s=n.createClass({displayName:"FBRTCCallStateInfo",revealContainer:function(){var t="_4j_h",u=document.getElementsByClassName(t)[0];if(u)u.className=t;},onCloseButtonClicked:function(t){window.close();return;},onStartCallButtonClicked:function(t){this.props.publishFn(j.UIEventType.START_CALL,t);},componentDidMount:function(){setTimeout(function(){this.revealContainer();}.bind(this),2000);},render:function(){var t=this.props.callModel;return (n.createElement("div",{className:"_4j_i"},this.renderPeerImage(t),this.renderMessage(),this.renderSubMessage(),this.renderCloseWindowButton(),this.renderStartCallButton()));},renderMessage:function(){var t=this.props.callModel;if(t.uiState===h.UIState.AWAITING_USER_START)return (n.createElement("p",{className:"_4j_k"},p._("Ready to call {name}?",[p.param("name",t.peerShortName())])));return (n.createElement("p",{className:"_4j_k"},this.props.callModel.peerName()));},renderSubMessage:function(){return r(this.props.callModel,this.props.messengerUI);},renderPeerImage:function(t){if(t.peerPicUrl()){if(this.props.messengerUI)return (n.createElement(m,{className:"_3z3i",isMessengerUser:true,size:75,src:t.peerPicUrl()}));return (n.createElement(l,{className:"_4j_j",src:t.peerPicUrl(),alt:"profile pic",onLoad:this.revealContainer,onError:this.revealContainer}));}return '';},shouldRenderCloseButton:function(){var t=this.props.callModel;return t.uiState===h.UIState.CALL_ENDED&&(!t.wasConnected||t.endCallReason!==j.CallEndReason.HANGUP_CALL);},renderCloseWindowButton:function(){if(this.shouldRenderCloseButton()){return (n.createElement(g,{label:p._("Zamknij okno"),messengerUI:this.props.messengerUI,onClick:this.onCloseButtonClicked,type:"primary"}));}else return '';},renderStartCallButton:function(){var t=this.props.callModel;if(t.uiState===h.UIState.AWAITING_USER_START){return (n.createElement(g,{label:p._("Start Call"),messengerUI:this.props.messengerUI,onClick:this.onStartCallButtonClicked,type:"primary"}));}else return '';}});e.exports=s;},null);
__d("FBRTCVideoMuteOverlay.react",["Image.react","ReactComponentWithPureRenderMixin","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"FBRTCVideoMuteOverlay",mixins:[h],propTypes:{videoMuted:l.bool.isRequired,imageSrc:l.string.isRequired},render:function(){var n=(("_30ve")+(this.props.videoMuted?' '+"_30vf":''));return (i.createElement("div",{className:n},i.createElement(g,{src:this.props.imageSrc,alt:"video muted"})));}});e.exports=m;},null);
__d("FBRTCSelfView.react",["FBRTCActiveMouseMixin","FBRTCCallModel","FBRTCConstants","FBRTCVideo.react","FBRTCVideoMuteOverlay.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=l,o=n.PropTypes,p=l.createClass({displayName:"FBRTCSelfView",mixins:[g],propTypes:{publishFn:o.func.isRequired,callModel:o.instanceOf(h).isRequired},getInitialState:function(){return {};},componentDidMount:function(){this.addActiveMouseListener(function(q){this.setState({mouseActive:q});}.bind(this));},toggleIconClass:function(q,r){return (("_2q_n")+(q?' '+"_2q_o":'')+(!q?' '+"_2q_p":'')+(!r?' '+"_2q_q":''));},wrapperClasses:function(q){return (("_2q_r")+(!q.selfViewOpen?' '+"_2q_s":''));},overlayClasses:function(q){var r=q.localStream.hasAudio();return (("_2q_t")+(r?' '+"_2q_u":''));},buttonClasses:function(){return (("_2q_w")+(this.state.mouseActive?' '+"_sxz":''));},render:function(){var q=this.props.callModel,r=q.selfViewOpen;return (l.createElement("div",{className:"_2q_v"},l.createElement("button",{className:this.buttonClasses(),onClick:this._toggleSelfView},l.createElement("i",{className:this.toggleIconClass(true,!r)}),l.createElement("i",{className:this.toggleIconClass(false,r)})),l.createElement("div",{className:this.wrapperClasses(q)},l.createElement("div",{className:"_5aq5"},l.createElement(k,{videoMuted:!q.localStream.hasVideo(),imageSrc:q.selfPicUrl()}),l.createElement("div",{className:this.overlayClasses(q)},l.createElement("i",{className:"_2q_x"})),l.createElement(j,{className:"_2q_y",muted:true,stream:q.localStream})))));},_toggleSelfView:function(q){this.props.publishFn(i.UIEventType.TOGGLE_SELF_VIEW);}});e.exports=p;},null);
__d("FBRTCInCallView.react",["FBRTCCallModel","FBRTCScreenSharingUI","FBRTCScreenSharingView.react","FBRTCSelfView.react","FBRTCVideo.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=l,o=n.PropTypes,p=l.createClass({displayName:"FBRTCInCallView",propTypes:{callModel:o.instanceOf(g).isRequired,publishFn:o.func.isRequired},_videoIsMuted:function(){var q=this.props.callModel.remoteStream;return q&&!q.hasVideo();},_hasRemoteScreen:function(q){var r=q.getRemoteScreenStream();return (r!==null)&&!h.isOpen();},_containerClasses:function(q){var r=q===g.UIState.CALL_CONNECTED,s=q===g.UIState.CALL_ENDED;return (("_of-")+(r||s?' '+"_of_":'')+(r?' '+"_og0":'')+(s?' '+"_og1":''));},_videoWrapperClasses:function(q){var r=this._videoIsMuted();return (("_og2")+(r?' '+"_og3":'')+(q?' '+"_og4":''));},render:function(){var q=this.props,r=q.callModel,s=q.publishFn,t=r.remoteStream.hasStream(),u=this._hasRemoteScreen(r);if(!t&&!u){return l.createElement("div",{className:"_hgl"});}else{var v=r.uiState;return (l.createElement("div",{className:this._containerClasses(v)},l.createElement("div",{className:this._videoWrapperClasses(u)},l.createElement(k,{stream:r.remoteStream})),this._renderSelfView(r,s),this._renderScreenView(r,s,u)));}},_renderSelfView:function(q,r){if(q.isRemoteVideoSupported)return l.createElement(j,{callModel:q,publishFn:r});},_renderScreenView:function(q,r,s){if(s)return (l.createElement(i,{screenStream:q.getRemoteScreenStream(),publishFn:r}));return null;}});e.exports=p;},null);
__d("FBRTCMediaAccessPrompt.react",["React","cx","fbt","UserAgent","Link.react","XUIText.react","FBRTCCallModel","FBRTCConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=g.createClass({displayName:"FBRTCMediaAccessPrompt",isVisible:function(p){return (j.isBrowser('Chrome')||j.isBrowser('Firefox'))&&p===m.UIState.PENDING_LOCAL_MEDIA;},componentWillUpdate:function(p,q){var r=p.callModel.uiState;if(this.isVisible(r)){clearTimeout(this.timeout);g.findDOMNode(this).style.display='block';}},componentDidUpdate:function(p,q){var r=this.props.callModel.uiState;if(!this.isVisible(r))this.timeout=setTimeout(function(){g.findDOMNode(this).style.display='none';}.bind(this),500);},componentWillUnmount:function(){clearTimeout(this.timeout);},dialogTitle:function(){if(j.isBrowser('Chrome')){return i._("Kliknij opcj\u0119 \u201eZezw\u00f3l\u201d, aby nawi\u0105za\u0107 po\u0142\u0105czenie");}else return i._("Kliknij kamer\u0119 i wybierz polecenie \u201eUdost\u0119pnij wybrane urz\u0105dzenia\u201d");},dialogBody:function(){return i._("To make a video call on Facebook, you need to turn on your camera and microphone. This will let your friend see and hear you during the call.");},dialogLowerBody:function(){return i._("You can always turn these off later.");},learnMoreLink:function(){return (g.createElement(k,{href:n.userMediaPermissionErrorUrl(),target:"_blank"},i._("Dowiedz si\u0119 wi\u0119cej")));},render:function(){var p=this.props.callModel.uiState;return (g.createElement("div",{className:(("_3jne")+(!this.isVisible(p)?' '+"_3jnf":''))},g.createElement("i",{className:"_3jns"}),g.createElement("i",{className:"_3jnt"}),g.createElement("div",{className:"_3jnu"},g.createElement("h1",{className:"_3jnv"},this.dialogTitle()),g.createElement(l,{className:"_3jnw",display:"block",size:"small"},this.dialogBody()),g.createElement(l,{className:"_3jnw",display:"block",size:"small"},this.dialogLowerBody()," ",this.learnMoreLink()))));}});e.exports=o;},null);
__d("FBRTCMediaDeniedPrompt.react",["React","cx","fbt","UserAgent","XUIContextualDialog.react","XUIContextualDialogBody.react","XUIContextualDialogTitle.react","ReactLayeredComponentMixin","FBRTCCallModel"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=g.createClass({displayName:"FBRTCMediaDeniedPrompt",mixins:[n],showDialog:function(){var q=this.props.callModel;return q.uiState===o.UIState.USER_MEDIA_DENIED;},arrowAlignment:function(){return j.isBrowser('Chrome')?'right':'left';},dialogTitle:function(){return i._("Kliknij, aby w\u0142\u0105czy\u0107 kamer\u0119\/mikrofon");},dialogBody:function(){return i._("Aby korzysta\u0107 z wideorozm\u00f3w, w\u0142\u0105cz kamer\u0119 i mikrofon podczas po\u0142\u0105czenia.");},renderLayers:function(){return {popover:(g.createElement(k,{contextRef:function(){return this.refs.mpTarget;}.bind(this),shown:this.showDialog(),position:"below",alignment:this.arrowAlignment(),width:k.WIDTH.NORMAL},g.createElement(m,null,this.dialogTitle()),g.createElement(l,null,this.dialogBody())))};},render:function(){return (g.createElement("div",{className:"_3wrz",ref:"mpTarget"}));}});e.exports=p;},null);
__d("FBRTCFadeInMixin",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={componentDidMount:function(){var k=g.findDOMNode(this);k.style.opacity=0;k.className=i(k.className,"_2hy");setTimeout(function(){k.style.opacity=1;},1);}};e.exports=j;},null);
__d("FBRTCFeedbackCompleteView.react",["FBRTCButton.react","FBRTCFadeInMixin","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=i.createClass({displayName:"FBRTCFeedbackCompleteView",mixins:[h],onCallBackButtonClicked:function(){return;},onCloseButtonClicked:function(){window.close();return;},messageString:function(){if(this.props.skipped)return k._("Po\u0142\u0105czenie zosta\u0142o zako\u0144czone");return k._("Dzi\u0119kujemy za Twoj\u0105 opini\u0119!");},render:function(){return (i.createElement("div",{className:"_1-7k"},i.createElement("p",{className:"_4j_k"},this.messageString()),i.createElement("div",null,i.createElement(g,{label:k._("Zamknij okno"),messengerUI:this.props.messengerUI,onClick:this.onCloseButtonClicked,type:"primary"}))));}});e.exports=l;},null);
__d("FBRTCFeedbackView.react",["cx","fbt","React","FBRTCButton.react","FBRTCConstants","FBRTCFadeInMixin","FBRTCFeedbackCompleteView.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=i.createClass({displayName:"FBRTCFeedbackView",mixins:[l],getInitialState:function(){return {submitted:false,skipped:false,feedbackText:''};},onSubmitButtonClicked:function(){if(this.canSubmitFeedback()){this.setState({submitted:true});this.props.publishFn(k.UIEventType.SUBMIT_FEEDBACK,this.state.feedbackText);}},onNotNowClicked:function(){this.setState({skipped:true,submitted:true});return;},canSubmitFeedback:function(){return this.state.feedbackText!=='';},feedbackChanged:function(o){this.setState({feedbackText:o.target.value});o.preventDefault();},render:function(){if(this.state.submitted)return (i.createElement(m,{messengerUI:this.props.messengerUI,skipped:this.state.skipped}));return (i.createElement("div",{className:"_1-7k"},i.createElement("p",{className:"_4j_k"},h._("Przeka\u017c swoj\u0105 opini\u0119")),i.createElement("div",{className:"_4ru1"},i.createElement("label",{htmlFor:"fbwebrtcfeedback",className:"_4j_k _4ru2"},h._("Jaki problem uwa\u017casz za najwi\u0119kszy?")),i.createElement("textarea",{className:"_4ru3",id:"fbwebrtcfeedback",rows:"4",onChange:this.feedbackChanged,placeholder:h._("Wpisz swoj\u0105 opini\u0119")}),i.createElement("div",{className:"_s97"},i.createElement(j,{className:"_g6b",label:h._("Nie teraz"),messengerUI:this.props.messengerUI,onClick:this.onNotNowClicked,type:"secondary"}),i.createElement(j,{className:"_g6b",disabled:!this.canSubmitFeedback(),label:h._("Wy\u015blij"),messengerUI:this.props.messengerUI,onClick:this.onSubmitButtonClicked,type:"primary"})))));}});e.exports=n;},null);
__d("FBRTCStarRatingView.react",["cx","fbt","FBRTCConstants","FBRTCFadeInMixin","React","StarsInput.react","FBRTCButton.react","FBRTCFeedbackCompleteView.react","FBRTCFeedbackView.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=k.createClass({displayName:"FBRTCStarRatingView",mixins:[j],getInitialState:function(){return {rating:0,submitted:false,skipped:false,feedbackText:''};},onCallBackButtonClicked:function(){return;},onCloseButtonClicked:function(){window.close();return;},onStarClicked:function(q){this.setState({rating:q});},onSubmitButtonClicked:function(){if(this.state.rating>0){this.setState({submitted:true});this.props.publishFn(i.UIEventType.SUBMIT_STAR_RATING,this.state.rating);}},onNotNowClicked:function(){this.setState({skipped:true,submitted:true});return;},getRatingString:function(){switch(this.state.rating){case 1:return h._("Z\u0142a");case 2:return h._("Przeci\u0119tna");case 3:return h._("Dobra");case 4:return h._("Bardzo dobra");case 5:return h._("Doskona\u0142a");default:return '---';}},shouldAskForFeedback:function(){return this.state.rating===1&&this.state.submitted&&!this.state.skipped;},render:function(){if(this.shouldAskForFeedback()){return (k.createElement(o,{publishFn:this.props.publishFn,messengerUI:this.props.messengerUI}));}else if(this.state.submitted)return (k.createElement(n,{skipped:this.state.skipped,messengerUI:this.props.messengerUI}));var q=this.getRatingString();return (k.createElement("div",{className:"_1-7k"},k.createElement("p",{className:"_4j_k"},h._("Oce\u0144 jako\u015b\u0107 wideorozmowy")),k.createElement("p",{className:"_4j_k _a16"},q),k.createElement(l,{allowMultipleSubmissions:true,onClick:this.onStarClicked}),k.createElement("div",{className:"_s97"},k.createElement(m,{className:"_g6b",label:h._("Nie teraz"),messengerUI:this.props.messengerUI,onClick:this.onNotNowClicked,type:"secondary"}),k.createElement(m,{className:"_g6b",label:h._("Wy\u015blij"),disabled:this.state.rating===0,messengerUI:this.props.messengerUI,onClick:this.onSubmitButtonClicked,type:"primary"}))));}});e.exports=p;},null);
__d("FBRTCView.react",["FBRTCBackground.react","FBRTCCallControls.react","FBRTCCallModel","FBRTCCallStateInfo.react","FBRTCConfig","FBRTCInCallView.react","FBRTCMediaAccessPrompt.react","FBRTCMediaDeniedPrompt.react","FBRTCStarRatingView.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=p,s=r.PropTypes,t=p.createClass({displayName:"FBRTCView",_listener:(null),propTypes:{callModel:s.instanceOf(i).isRequired,messengerUI:s.bool.isRequired,publishFn:s.func.isRequired},componentDidMount:function(){this._listener=this.props.callModel.addListener(this._handleCallModelChanged);},componentWillUnmount:function(){if(this._listener){this._listener.remove();delete this._listener;}},_handleCallModelChanged:function(){this.forceUpdate();},render:function(){var u=this.props,v=u.callModel,w=u.messengerUI,x=u.publishFn,y=v.backgroundUrl();if(v.uiState===i.UIState.COLLECT_RATING){return (p.createElement("div",{className:this._wrapperClass()},p.createElement(g,{src:y,messengerUI:w}),this._renderLogo(),p.createElement(o,{messengerUI:w,publishFn:x})));}else return (p.createElement("div",{className:this._wrapperClass()},p.createElement(m,{callModel:v}),p.createElement(n,{callModel:v}),p.createElement(j,{callModel:v,messengerUI:w,publishFn:x}),p.createElement(g,{src:y,messengerUI:w}),this._renderLogo(),p.createElement(l,{callModel:v,publishFn:x}),p.createElement(h,{callModel:v})));},_renderLogo:function(){if(!this.props.messengerUI){var u=(("_263g")+(!k.isMessengerDotCom()?' '+"_56us":'')+(k.isMessengerDotCom()?' '+"_56ut":''));return p.createElement("i",{className:u});}},_wrapperClass:function(){return (("_3ref")+(this.props.messengerUI?' '+"_17cj":''));}});e.exports=t;},null);
__d("FBRTCApplication",["FBRTCLogger","FBRTCCallController","FBRTCConfig","FBRTCView.react","React","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={init:function(n,o,p,q,r,s){s=s||document.getElementById('fbRTC/container');var t=g.getInstance();t.logInfo(n,o,'Starting Call Controller');document.documentElement.style.overflow='hidden';if(!l.isWebrtcSupported()){t.logError(n,o,'Webrtc not supported');}else{var u=new h(n,o,p,r),v=u.getViewController();k.render(k.createElement(j,{callModel:u.getCallModel(),messengerUI:i.useMessengerCallUI(),publishFn:v.publish.bind(v)}),s);if(q){u.startCallProcess();}else u.waitForUserInput();}}};e.exports=m;},null);
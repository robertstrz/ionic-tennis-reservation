/*!CK:1246499568!*//*1433852120,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["6iL2K"]); }

__d("MercuryGenericConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MAX_THREAD_NAME_LENGTH:250};},null);
__d("MercuryMessageSourceTags",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={CHAT:"source:chat",EMAIL:"source:email",MESSENGER:"source:messenger",MOBILE:"source:mobile"};},null);
__d("MercurySendMessageFields",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={AUTO_RETRY_CNT:"auto_retry_cnt",MANUAL_RETRY_CNT:"manual_retry_cnt"};},null);
__d("MercuryTimePassed",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TODAY:0,WEEK_AGO:1,MONTH_AGO:2,CURRENT_YEAR:3,OTHER_YEAR:4};},null);
__d("MessagingEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={DELETE:"delete",DELETE_MESSAGES:"delete_messages",DELIVER:"deliver",ERROR:"error",READ:"read",REPORT_SPAM:"report_spam",REPORT_SPAM_MESSAGES:"report_spam_messages",UNMARK_SPAM:"unmark_spam",SUBSCRIBE:"subscribe",CHANGE_MUTE_SETTINGS:"change_mute_settings",TAG:"tag",UNREAD:"unread",UNSUBSCRIBE:"unsubscribe",DELIVER_LOG:"deliver_log",MORE_THREADS:"more_threads",READ_ALL:"read_all",READ_RECEIPT:"read_receipt",DELIVERY_RECEIPT:"delivery_receipt",SENT_PUSH:"sent_push",DELIVER_FAST_PAST:"deliver_fast_path",MESSENGER_STATUS:"messenger_status",UPDATE_PINNED_THREADS:"update_pinned_threads",CHANGE_PAGE_THREAD_FLAG:"change_page_thread_flag"};},null);
__d("StoryAttachmentStyle",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FALLBACK:"fallback",SHARE:"share",OG_COMPOSER_SIMPLE:"og_composer_simple",SPORTS_MATCHUP:"sports_matchup",SHARE_LARGE_IMAGE:"share_large_image",PHOTO:"photo",COVER_PHOTO:"cover_photo",ALBUM:"album",NEW_ALBUM:"new_album",COUPON:"coupon",QUESTION:"question",ANSWER:"answer",OPTION:"option",GALLERY:"gallery",STREAM_PUBLISH:"stream_publish",MUSIC_AGGREGATION:"music_aggregation",ITEM_LIST:"list",HIGH_SCORE:"high_score",SCORE_LEADERBOARD:"score_leaderboard",FRIEND_LIST:"friend_list",CHECKIN:"checkin",POPULAR_OBJECTS:"popular_objects",AVATAR_LIST:"avatar_list",AVATAR:"avatar",AVATAR_WITH_VIDEO:"avatar_with_video",EVENT:"event",MINUTIAE_EVENT:"minutiae_event",EXPERIENCE:"experience",LIFE_EVENT:"life_event",TRAVEL_SLIDESHOW_LIFE_EVENT:"travel_slideshow_life_event",GIFT:"gift",IMAGE_SHARE:"image_share",ANIMATED_IMAGE_SHARE:"animated_image_share",ANIMATED_IMAGE_AUTOPLAY:"animated_image_autoplay",NOTE:"note",TOPIC:"topic",FILE_UPLOAD:"file_upload",NOTIFICATION_TARGET:"notification_target",UNAVAILABLE:"unavailable",PAGE_RECOMMENDATION:"page_recommendation",PAGE_VIDEO_PLAYLIST:"page_video_playlist",VIDEO:"video",VIDEO_INLINE:"video_inline",VIDEO_AUTOPLAY:"video_autoplay",VIDEO_SHARE:"video_share",VIDEO_SHARE_HIGHLIGHTED:"video_share_highlighted",VIDEO_SHARE_YOUTUBE:"video_share_youtube",MAP:"map",OG_MAP:"og_map",PRODUCT:"product",EXTERNAL_PRODUCT:"external_product",FITNESS_COURSE:"fitness_course",APPLICATION:"application",STICKER:"sticker",EXTERNAL_OG_PRODUCT:"external_og_product",TRAVEL_LOG:"travel_log",MULTI_SHARE:"multi_share",MULTI_SHARE_NO_END_CARD:"multi_share_no_end_card",YEAR_IN_REVIEW:"year_in_review",AVATAR_LARGE_COVER:"avatar_large_cover",BROADCAST_REQUEST:"broadcast_request",COMMERCE_PRODUCT_ITEM:"commerce_product_item",COMMERCE_STORE:"commerce_store",THIRD_PARTY_PHOTO:"third_party_photo",PROMPT:"prompt",BIRTHDAY:"birthday",DONATIONS_CAMPAIGN:"donations_campaign",DONATE_PROMPT:"donate_prompt",DISCUSSION_CONVERSATION:"discussion_conversation",DISCUSSION_COMMENT:"discussion_comment",GROUP_SELL_PRODUCT_ITEM:"group_sell_product_item",GROUP_SELL_PRODUCT_ITEM_MARK_AS_SOLD:"group_sell_mark_as_sold",GAMETIME:"gametime",GROUP_REPORTED_POST_QUEUE:"group_reported_post_queue",GROUP_PENDING_POST_QUEUE:"group_pending_post_queue",GROUP_JOIN_REQUEST_QUEUE:"group_join_request_queue",GREETING_CARD:"greeting_card",LEAD_GEN:"lead_gen",ATTACHED_STORY:"attached_story",SOUVENIR:"souvenir",SLIDESHOW:"slideshow",ORION:"orion",ORION_REQUEST:"orion_request",RETAIL_ITEM:"retail_item",RETAIL_RECEIPT:"retail_receipt",INSTANT_ARTICLE:"instant_article",RETAIL_CANCELLATION:"retail_cancellation",JOIN_TOPIC_CONVERSATION:"join_topic_conversation",MOMENTS_APP_INVITATION:"moments_app_invitation",RETAIL_SHIPMENT:"retail_shipment",RETAIL_SHIPMENT_TRACKING_EVENT:"retail_shipment_tracking_event",RETAIL_SHIPMENT_TRACKING_EVENT_ETA:"retail_shipment_tracking_event_eta",SURVEY:"survey",MESSAGE_LOCATION:"message_location",JOB_OFFER:"job_offer",GROUP_ADD_MEMBERS:"group_add_memebers",RTC_CALL_LOG:"rtc_call_log",EVENT_CALENDAR:"event_calendar",FACEPILE:"facepile",ATTRIBUTED_SHARE:"attributed_share",VIDEO_CINEMAGRAPH:"video_cinemagraph",LOCAL_CONTEXT_SHARE:"local_context_share",H_SCROLL:"h_scroll",MEDIA_QUESTION:"media_question",RICH_MEDIA:"rich_media",SQUARE_IMAGE_SHARE:"square_image_share",RETAIL_NOW_IN_STOCK:"retail_now_in_stock"};},null);
__d("SplitImage.react",["React","Image.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g.createClass({displayName:"SplitImage",render:function(){var l=this.props.size;return (g.createElement("div",g.__spread({},this.props,{className:j(this.props.className,"_55lt"),style:Object.assign({},(this.props.style||{}),{width:l,height:l})}),this.renderImages()));},renderImages:function(){if(!this.props.srcs)return null;var l=this.props.srcs,m=Array.isArray(l);if(!m||l.length==1)return this.renderOne(m?l[0]:l);return l.length==2?this.renderTwo(l):this.renderThree(l);},renderOne:function(l){return (g.createElement(h,{src:l,width:this.props.size,height:this.props.size,alt:""}));},renderTwo:function(l){var m=this.props.size,n=Math.floor(m/2),o=-Math.floor(n/2),p=(("_55lu")+(this.props.border?' '+"_57xo":''));return (g.createElement("div",null,g.createElement("div",{className:"_55lu",style:{width:n}},g.createElement(h,{src:l[0],width:m,height:m,style:{marginLeft:o}})),g.createElement("div",{className:p,style:{width:n}},g.createElement(h,{src:l[1],width:m,height:m,style:{marginLeft:o}}))));},renderThree:function(l){var m=this.props.size,n=Math.floor(m/3*2),o=-Math.floor((m-n)/2),p=Math.floor(m/2),q=m-n,r=-Math.floor((p-q)/2),s=(("_55lu")+(this.props.border?' '+"_57pl":'')),t=(("_55lu")+(this.props.border?' '+"_57pm":''));return (g.createElement("div",null,g.createElement("div",{className:s,style:{width:n}},g.createElement(h,{src:l[0],width:m,height:m,style:{marginLeft:o}})),g.createElement("div",{className:t,style:{width:q,height:p}},g.createElement(h,{src:l[1],width:p,height:p,style:{marginLeft:r}})),g.createElement("div",{className:"_55lu",style:{width:q,height:p}},g.createElement(h,{src:l[2],width:p,height:p,style:{marginLeft:r}}))));}});e.exports=k;},null);
__d("loadImage",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';function g(h,i){var j=new Image();j.onload=function(){i(j.width,j.height,j);};j.src=h;}e.exports=g;},null);
__d("PhotoResizeMath",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={getScaledPhotoDimensions:function(h,i,j,k,l){var m=h/i,n=j/k;if(j&&k&&l==='stretch')return {width:j,height:k};if((!j&&k)||((l==='contain')!==(m>=n)))return {width:k*m,height:k};if(j)return {width:j,height:j/m};return {width:h,height:i};}};e.exports=g;},null);
__d("PixelzFocus",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={search:function(h,i){var j=0,k=h.length-1;while(j<=k){var l=j+Math.floor((k-j)/2),m=h[l];if(m>i){k=l-1;}else if(m<i){j=l+1;}else return l;}return Math.min(j,k);},forceSpecificPoint:function(h,i,j){var k=1e-09,l=g.search(h,i-j-k)+1,m=g.search(h,i+j);return h.slice(l,m+1);},findBiggestSets:function(h,i){var j=[],k=-1;for(var l=0;l<h.length;++l){var m=h[l],n=l,o=g.search(h,m+i),p=o-n;if(p>k)j=[];if(p>=k){k=p;j.push({low:n,high:o});}}return j;},getBestSet:function(h,i,j){var k=-1,l=null;for(var m=0;m<i.length;++m){var n=i[m],o=h[n.low],p=h[n.high],q=o+(p-o)/2,r=Math.min(o-(q-j),(q+j)-p);if(r>k){k=r;l=n;}}return l;},getFocusFromSet:function(h,i){var j=h[i.low],k=h[i.high];return j+(k-j)/2;},clampFocus:function(h,i){var j=i/2,k=1-(i/2);if(h<j)return j;if(h>k)return k;return h;},convertFromCenterToCSS:function(h,i){if(Math.abs(1-i)<1e-05)return 0;return (h-i/2)/(1-i);},convertFromCSSToCenter:function(h,i){return h*(1-i)+i/2;},getVisible:function(h,i){if(h<i)return h/i;return i/h;},getHidden:function(h,i){return 1-g.getVisible(h,i);},focusHorizontally:function(h,i){return h<i;},convertVectorFromCenterToCSS:function(h,i,j){var k=g.focusHorizontally(i,j),l;if(k){l=h.x/100;}else l=h.x/100;var m=g.convertFromCenterToCSS(l,g.getVisible(i,j));if(k){return {x:m,y:0};}else return {x:0,y:m};},getCropRect:function(h,i,j){var k=g.focusHorizontally(i,j),l=g.getVisible(i,j);if(k){var m=(1-l)*h.x;return {left:m,top:0,width:l,height:1};}else{var n=(1-l)*h.y;return {left:0,top:n,width:1,height:l};}}};e.exports=g;},null);
__d("Pixelz.react",["arrayContains","copyProperties","cx","loadImage","joinClasses","React","PhotoResizeMath","PixelzFocus"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=l,p=o.PropTypes,q=l.createClass({displayName:"Pixelz",propTypes:{width:p.number,height:p.number,resizeMode:p.oneOf(['contain','cover','stretch']),alt:p.string,letterbox:p.bool,borderRadius:p.number,insetBorderColor:p.string,animated:p.bool,upscale:p.bool,cropRect:function(r,s,t){var u=r[s],v='Invalid prop `'+s+'` supplied to `'+t+'`, expected a rectangle with values normalized '+'between 0 and 1.';if(u.left<0||u.top<0||u.width<0||u.height<0||u.left+u.width>1||u.top+u.height>1)return new Error(v);},focus:function(r,s,t){var u=r[s],v='Invalid prop `'+s+'` supplied to `'+t+'`, expected either a {x, y, type} vector where type '+'is `css` or `center` or an array of {x, y} vectors. All the vectors '+'have with values normalized between 0 and 1.';if(Array.isArray(u)){for(var w=0;w<u.length;++w)if(!(u[w].x>=0&&u[w].x<=1)||!(u[w].y>=0&&u[w].y<=1))return new Error(v);}else{if(!u.type)u.type='css';if(!(u.x>=0&&u.x<=1)||!(u.y>=0&&u.y<=1)||!g(['center','css'],u.type))return new Error(v);}}},getDefaultProps:function(){return {resizeMode:'cover',alt:'',letterbox:true,upscale:true,cropRect:{width:1,height:1,top:0,left:0},focus:{x:.5,y:.5,type:'css'}};},getInitialState:function(){return {srcDimensions:{}};},getSrcDimensions:function(){var r=this.props.src,s=this.state.srcDimensions[r];if(s)return s;j(r,function(t,u){var v={};v[r]={width:t,height:u};this.isMounted()&&this.setState({srcDimensions:v});}.bind(this));return null;},getCropSrcDimensions:function(){var r=this.getSrcDimensions();return {width:r.width*this.props.cropRect.width,height:r.height*this.props.cropRect.height};},getUpscaleCropDimensions:function(){var r=this.getCropSrcDimensions();return m.getScaledPhotoDimensions(r.width,r.height,this.props.width,this.props.height,this.props.resizeMode);},getCropDimensions:function(){var r=this.getUpscaleCropDimensions(),s=this.getCropSrcDimensions();if(!this.props.upscale)return {width:Math.min(r.width,s.width),height:Math.min(r.height,s.height)};return r;},getCropAspectRatio:function(){var r=this.getCropDimensions();return r.width/r.height;},getContainerDimensions:function(){if(this.props.letterbox&&this.props.width&&this.props.height)return {width:this.props.width,height:this.props.height};return this.getCropDimensions();},getContainerAspectRatio:function(){var r=this.getContainerDimensions();return r.width/r.height;},getContainerPosition:function(){return {left:0,top:0};},getFocus:function(){var r=this.props.focus;if(!Array.isArray(r)&&r.type==='css')return {x:r.x,y:r.y};var s=this.getContainerAspectRatio(),t=this.getCropAspectRatio(),u=n.getVisible(s,t),v=n.focusHorizontally(s,t),w;if(!Array.isArray(r)){w=n.convertFromCenterToCSS(v?r.x:r.y,u);}else{var x=r.map(function(aa){return v?aa.x:aa.y;});x.sort();var y=n.findBiggestSets(x,u),z=n.getBestSet(x,y,u);w=n.getFocusFromSet(x,z);}return {x:v?w:.5,y:v?.5:w};},getCropPosition:function(){var r=this.getCropDimensions(),s=this.getContainerDimensions(),t=this.getFocus();return {left:t.x*(s.width-r.width),top:t.y*(s.height-r.height)};},getScaleDimensions:function(){var r=this.getCropDimensions();return {width:r.width/this.props.cropRect.width,height:r.height/this.props.cropRect.height};},getScalePosition:function(){var r=this.getScaleDimensions();return {left:-r.width*this.props.cropRect.left,top:-r.height*this.props.cropRect.top};},getClipCropRectangle:function(){var r=this.getContainerDimensions(),s=this.getCropDimensions(),t=this.getContainerPosition(),u=this.getCropPosition(),v=Math.max(t.left,u.left),w=Math.max(t.top,u.top),x=Math.min(t.top+r.height,u.top+s.height),y=Math.min(t.left+r.width,u.left+s.width);return {left:v,top:w,width:y-v,height:x-w};},getClipCropPosition:function(){var r=this.getClipCropRectangle();return {left:r.left,top:r.top};},getClipCropDimensions:function(){var r=this.getClipCropRectangle();return {width:r.width,height:r.height};},getClipScalePosition:function(){var r=this.getScalePosition(),s=this.getClipCropPosition(),t=this.getCropPosition();return {left:r.left+(t.left-s.left),top:r.top+(t.top-s.top)};},getClipScaleDimensions:function(){return this.getScaleDimensions();},areDimensionsEqual:function(r,s){return r.width===s.width&&r.height===s.height;},shouldAddAllNodesAndStyles:function(){return this.props.animated;},hasCrop:function(){if(this.shouldAddAllNodesAndStyles())return true;var r=this.getContainerDimensions(),s=this.getClipCropDimensions(),t=this.getClipScaleDimensions();if(this.areDimensionsEqual(r,s)||this.areDimensionsEqual(s,t))return false;return true;},hasContainer:function(){if(this.shouldAddAllNodesAndStyles()||this.hasInsetBorder())return true;var r=this.getContainerDimensions(),s=this.getClipScaleDimensions();if(this.areDimensionsEqual(r,s))return false;return true;},hasInsetBorder:function(){return this.shouldAddAllNodesAndStyles()||this.props.insetBorderColor;},applyPositionStyle:function(r,s){if(this.shouldAddAllNodesAndStyles()||s.left)r.left=Math.round(s.left);if(this.shouldAddAllNodesAndStyles()||s.top)r.top=Math.round(s.top);},applyDimensionsStyle:function(r,s){r.width=Math.round(s.width);r.height=Math.round(s.height);},applyBorderRadiusStyle:function(r){if(this.shouldAddAllNodesAndStyles()||this.props.borderRadius)r.borderRadius=this.props.borderRadius||0;},getScaleStyle:function(){var r={},s=this.getClipCropDimensions(),t=this.getClipScaleDimensions();if(this.shouldAddAllNodesAndStyles()||!this.areDimensionsEqual(s,t)){this.applyPositionStyle(r,this.getClipScalePosition());}else this.applyPositionStyle(r,this.getClipCropPosition());this.applyDimensionsStyle(r,this.getClipScaleDimensions());this.applyBorderRadiusStyle(r);return r;},getCropStyle:function(){var r={};this.applyPositionStyle(r,this.getClipCropPosition());this.applyDimensionsStyle(r,this.getClipCropDimensions());this.applyBorderRadiusStyle(r);return r;},getInsetBorderStyle:function(){var r={borderColor:this.props.insetBorderColor||'transparent'};this.applyPositionStyle(r,this.getClipCropPosition());this.applyDimensionsStyle(r,this.getClipCropDimensions());this.applyBorderRadiusStyle(r);return r;},getContainerStyle:function(){var r={};this.applyDimensionsStyle(r,this.getContainerDimensions());this.applyBorderRadiusStyle(r);return r;},getScale:function(){var r=this.getScaleStyle(),s=r.width,t=r.height;r=h({},r);delete r.width;delete r.height;return (l.createElement("img",l.__spread({},this.props,{alt:this.props.alt,className:k(this.props.className,(("_56wb")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''))),src:this.props.src,style:Object.assign({},(this.props.style||{}),r),width:s,height:t})));},getCrop:function(){var r=this.getScale();if(!this.hasCrop())return r;return (l.createElement("div",{className:(("_56ma")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getCropStyle()},r));},getInsetBorder:function(){if(!this.hasInsetBorder())return null;return (l.createElement("div",{className:(("_56lv")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getInsetBorderStyle()}));},getContainer:function(){var r=this.getCrop();if(!this.hasContainer())return r;var s=this.getInsetBorder();return (l.createElement("div",{className:(("_56jj")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getContainerStyle()},r,s));},render:function(){var r=this.getSrcDimensions();if(!r)return l.createElement("span",null);return this.getContainer();}});e.exports=q;},null);
__d("getModuleLoader",["Bootloader","Promise"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(k){"use strict";this.$ModuleLoader0=k;this.$ModuleLoader1=k.slice().sort().toString();}i.prototype.load=function(){"use strict";return new h(function(k){g.loadModules.call(g,this.$ModuleLoader0,function(){for(var l=[],m=0,n=arguments.length;m<n;m++)l.push(arguments[m]);k(l);});}.bind(this));};i.prototype.equals=function(k){"use strict";return this===k||this.$ModuleLoader1===k.$ModuleLoader1;};var j=function(k){return new i(k);};j.ModuleLoader=i;e.exports=j;},null);
__d("arrayStableSort",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h,i){return h.map(function(j,k){return {data:j,index:k};}).sort(function(j,k){return i(j.data,k.data)||(j.index-k.index);}).map(function(j){return j.data;});}e.exports=g;},null);
__d("RangedCallbackManager",["CallbackManagerController","arrayStableSort","createObjectFrom"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k,l,m){"use strict";this.$RangedCallbackManager0=[];this.$RangedCallbackManager1=false;this.$RangedCallbackManager2=false;this.$RangedCallbackManager3={};this.$RangedCallbackManager4=new g(this.$RangedCallbackManager5.bind(this));this.$RangedCallbackManager6=k;this.$RangedCallbackManager7=l;this.$RangedCallbackManager8=m;}j.prototype.executeOrEnqueue=function(k,l,m,n,o){"use strict";return this.$RangedCallbackManager4.executeOrEnqueue({start:k,limit:l},m,{strict:!!n,skipOnStrictHandler:o});};j.prototype.unsubscribe=function(k){"use strict";this.$RangedCallbackManager4.unsubscribe(k);};j.prototype.getUnavailableResources=function(k){"use strict";var l=this.$RangedCallbackManager4.getRequest(k),m=[];if(l&&!this.$RangedCallbackManager1){var n=l.request,o=this.$RangedCallbackManager9(l.options),p=n.start+n.limit;for(var q=o.length;q<p;q++)m.push(q);}return m;};j.prototype.addResources=function(k){"use strict";k.forEach(function(l){if(!this.$RangedCallbackManager3[l]){this.$RangedCallbackManager3[l]=true;this.$RangedCallbackManager0.push(l);this.$RangedCallbackManager2=null;}}.bind(this));this.resortResources();this.$RangedCallbackManager4.runPossibleCallbacks();};j.prototype.addResourcesWithoutSorting=function(k,l){"use strict";var m=this.$RangedCallbackManager0.slice(0,l);m=m.concat(k);m=m.concat(this.$RangedCallbackManager0.slice(l));this.$RangedCallbackManager0=m;Object.assign(this.$RangedCallbackManager3,i(k,true));this.$RangedCallbackManager2=null;this.$RangedCallbackManager4.runPossibleCallbacks();};j.prototype.removeResources=function(k){"use strict";k.forEach(function(l){if(this.$RangedCallbackManager3[l]){this.$RangedCallbackManager3[l]=false;var m=this.$RangedCallbackManager0.indexOf(l);if(m!=-1)this.$RangedCallbackManager0.splice(m,1);}}.bind(this));};j.prototype.removeAllResources=function(){"use strict";this.$RangedCallbackManager0=[];this.$RangedCallbackManager3={};};j.prototype.resortResources=function(){"use strict";this.$RangedCallbackManager0=h(this.$RangedCallbackManager0,function(k,l){return this.$RangedCallbackManager7(this.$RangedCallbackManager6(k),this.$RangedCallbackManager6(l));}.bind(this));};j.prototype.setReachedEndOfArray=function(){"use strict";if(!this.$RangedCallbackManager1){this.$RangedCallbackManager1=true;this.$RangedCallbackManager2=null;this.$RangedCallbackManager4.runPossibleCallbacks();}};j.prototype.hasReachedEndOfArray=function(){"use strict";return this.$RangedCallbackManager1;};j.prototype.setError=function(k){"use strict";if(this.$RangedCallbackManager2!==k){this.$RangedCallbackManager2=k;this.$RangedCallbackManager4.runPossibleCallbacks();}};j.prototype.getError=function(k,l,m){"use strict";var n=this.$RangedCallbackManager9({strict:m});return k+l>n.length?this.$RangedCallbackManager2:null;};j.prototype.hasResource=function(k){"use strict";return this.$RangedCallbackManager3[k];};j.prototype.getResourceAtIndex=function(k){"use strict";return this.$RangedCallbackManager0[k];};j.prototype.getAllResources=function(){"use strict";return this.$RangedCallbackManager0.concat();};j.prototype.getCurrentArraySize=function(k){"use strict";return this.$RangedCallbackManager9(k).length;};j.prototype.$RangedCallbackManager9=function(k){"use strict";var l=this.$RangedCallbackManager0;if(k&&k.strict){var m=k.skipOnStrictHandler||this.$RangedCallbackManager8;if(m)l=l.filter(m);}return l;};j.prototype.$RangedCallbackManager5=function(k,l){"use strict";var m=this.$RangedCallbackManager9(l);if(!this.$RangedCallbackManager1&&!this.$RangedCallbackManager2&&k.start+k.limit>m.length){return false;}else{var n=m.slice(k.start,k.start+k.limit),o=k.start+k.limit>m.length?this.$RangedCallbackManager2:null;return [n,o];}};j.prototype.getElementsUntil=function(k){"use strict";var l=[];for(var m=0;m<this.$RangedCallbackManager0.length;m++){var n=this.$RangedCallbackManager6(this.$RangedCallbackManager0[m]);if(this.$RangedCallbackManager7(n,k)>0)break;l.push(this.$RangedCallbackManager0[m]);}return l;};e.exports=j;},null);
__d("formatDate",["DateConsts","DateFormatConfig","fbt","invariant"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(o,p,q){q=q||{};if(!p||!o)return '';if(typeof o==='string')o=parseInt(o,10);if(typeof o==='number')o=new Date(o*1000);j(o instanceof Date);j(!isNaN(o.getTime()));j(o.getTime()<1e+15);if(typeof p!=='string'){var r=m();for(var s in r){var t=r[s];if(t.start<=o.getTime()&&p[t.name]){p=p[t.name];break;}}}var u;if(q.skipPatternLocalization||(!q.formatInternal&&n())||p.length===1){u=p;}else{j(h.formats[p]);u=h.formats[p];}var v=q.utc?'getUTC':'get',w=o[v+'Date'](),x=o[v+'Day'](),y=o[v+'Month'](),z=o[v+'FullYear'](),aa=o[v+'Hours'](),ba=o[v+'Minutes'](),ca=o[v+'Seconds'](),da=o[v+'Milliseconds'](),ea='';for(var fa=0;fa<u.length;fa++){var ga=u.charAt(fa);switch(ga){case '\\':fa++;ea+=u.charAt(fa);break;case 'd':ea+=l(w,2);break;case 'j':ea+=w;break;case 'S':ea+=g.getOrdinalSuffix(w);break;case 'D':ea+=g.getWeekdayNameShort(x);break;case 'l':ea+=g.getWeekdayName(x);break;case 'F':case 'f':ea+=g.getMonthName(y+1);break;case 'M':ea+=g.getMonthNameShort(y+1);break;case 'm':ea+=l(y+1,2);break;case 'n':ea+=y+1;break;case 'Y':ea+=z;break;case 'y':ea+=(''+z).slice(2);break;case 'a':if(aa<12){ea+=i._("rano");}else ea+=i._("po po\u0142udniu");break;case 'A':if(aa<12){ea+=i._("rano");}else ea+=i._("Po po\u0142udniu");break;case 'g':ea+=(aa===0||aa===12)?12:aa%12;break;case 'G':ea+=aa;break;case 'h':if(aa===0||aa===12){ea+=12;}else ea+=l(aa%12,2);break;case 'H':ea+=l(aa,2);break;case 'i':ea+=l(ba,2);break;case 's':ea+=l(ca,2);break;case 'X':ea+=l(da,3);break;default:ea+=ga;}}return ea;}function l(o,p){return Array(p-(''+o).length+1).join('0')+o;}function m(){var o=new Date(),p=o.getTime(),q=o.getFullYear(),r=o.getDate()-((o.getDay()-h.weekStart+6)%7),s=new Date(q,o.getMonth()+1,0).getDate(),t=new Date(q,1,29).getMonth()===1?366:365,u=1000*60*60*24;return [{name:'today',start:o.setHours(0,0,0,0)},{name:'withinDay',start:p-u},{name:'thisWeek',start:new Date(o.getTime()).setDate(r)},{name:'withinWeek',start:p-u*7},{name:'thisMonth',start:o.setDate(1)},{name:'withinMonth',start:p-u*s},{name:'thisYear',start:o.setMonth(0)},{name:'withinYear',start:p-u*t},{name:'older',start:-Infinity}];}k.periodNames=['today','thisWeek','thisMonth','thisYear','withinDay','withinWeek','withinMonth','withinYear','older'];function n(){if(typeof window==='undefined'||!window||!window.location||!window.location.pathname)return false;var o=window.location.pathname,p='/intern';return o.substr(0,p.length)===p;}e.exports=k;},null);
__d("mergeDeepInto",["invariant","mergeHelpers"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=h.ArrayStrategies,j=h.checkArrayStrategy,k=h.checkMergeArrayArgs,l=h.checkMergeLevel,m=h.checkMergeObjectArgs,n=h.isTerminal,o=h.normalizeMergeArg,p=function(t,u,v,w){m(t,u);l(w);var x=u?Object.keys(u):[];for(var y=0;y<x.length;y++){var z=x[y];r(t,u,z,v,w);}},q=function(t,u,v,w){k(t,u);l(w);var x=Math.max(t.length,u.length);for(var y=0;y<x;y++)r(t,u,y,v,w);},r=function(t,u,v,w,x){var y=u[v],z=u.hasOwnProperty(v),aa=z&&n(y),ba=z&&Array.isArray(y),ca=z&&!ba&&!ba,da=t[v],ea=t.hasOwnProperty(v),fa=ea&&n(da),ga=ea&&Array.isArray(da),ha=ea&&!ga&&!ga;if(fa){if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else if(!z)t[v]=da;}else if(ga){if(aa){t[v]=y;}else if(ba){g(i[w]);if(w===i.Clobber)da.length=0;q(da,y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else !z;}else if(ha){if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){p(da,y,w,x+1);}else !z;}else if(!ea)if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else !z;},s=function(t,u,v){var w=o(u);j(v);p(t,w,v,0);};e.exports=s;},null);
__d("MercuryLocalIDs",["PresenceUtil","randomInt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={generateMessageID:function(k){var l=k||Date.now(),m=h(0,4294967295),n=g.getSessionID();return ("<"+l+":"+m+"-"+n+"@mail.projektitan.com>");},generateThreadID:function(k){return 'root:'+i.generateMessageID(k);},generateOfflineThreadingID:function(k){var l=k||Date.now(),m=h(0,4294967295),n=('0000000000000000000000'+m.toString(2)).slice(-22),o=l.toString(2)+n;return j(o);}};function j(k){var l='';while(k!='0'){var m=0,n='';for(var o=0;o<k.length;o++){m=2*m+parseInt(k[o],10);if(m>=10){n+='1';m-=10;}else n+='0';}l=m.toString()+l;k=n.slice(n.indexOf('1'));}return l;}e.exports=i;},null);
__d("MercuryMessageObject",["MercuryActionStatus","MercuryActionType","MercuryIDs","MercuryLocalIDs","MercuryMessageClientState","MercuryMessageSourceTags","MercurySingletonMixin","MercurySourceType","MercuryTimePassed","MercurySendMessageFields","fbt","formatDate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(v){"use strict";this.$MercuryMessageObject0=v;}s.prototype.constructUserGeneratedMessageObject=function(v,w,x,y,z){"use strict";var aa=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);if(typeof v=='string')v=v.replace(/^\s+/,'').replace(/\s+$/,'');aa.body=v;aa.has_attachment=false;aa.html_body=false;aa.attachments=[];aa.specific_to_list=y||[];aa.creator_info=z;return aa;};s.prototype.constructStickerMessageObject=function(v,w,x){"use strict";var y=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);y.has_attachment=true;y.html_body=false;y.attachments=[];y.sticker_id=v;y.specific_to_list=[];return y;};s.prototype.constructAttachmentMessageObject=function(v,w){"use strict";var x=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,v,w);x.attachments=[];x.specific_to_list=[];return x;};s.prototype.constructLogMessageObject=function(v,w,x,y){"use strict";var z=t(this.$MercuryMessageObject0,h.LOG_MESSAGE,v,w);z.log_message_type=x;z.log_message_data=y;return z;};s.prototype.normalizeNewMessage=function(v){"use strict";if(v.status===undefined)v.status=g.UNSENT;v.timestamp_absolute=q._("Dzisiaj");v.message_id=v.message_id||j.generateMessageID(v.timestamp);var w=i.getParticipantIDFromUserID(this.$MercuryMessageObject0);v.specific_to_list=v.specific_to_list||[];if(v.specific_to_list.length&&v.specific_to_list.indexOf(w)===-1)v.specific_to_list.push(w);if(!v.thread_id){if(v.specific_to_list.length==1){v.thread_id='user:'+this.$MercuryMessageObject0;}else if(v.specific_to_list.length==2){var x=v.specific_to_list[0]==w?v.specific_to_list[1]:v.specific_to_list[0];v.thread_id=i.getThreadIDFromParticipantID(x);}v.thread_id=v.thread_id||'root:'+v.message_id;}if(!v.specific_to_list.length){var y=i.tokenize(v.thread_id),z=y.type,aa=y.value;if(z=='user')v.specific_to_list=['fbid:'+aa,w];}if(!v[p.MANUAL_RETRY_CNT])v[p.MANUAL_RETRY_CNT]=0;};s.prototype.normalizeResendMessage=function(v){"use strict";v.status=g.RESENDING;v.timestamp=Date.now();v[p.MANUAL_RETRY_CNT]+=1;};s.prototype.normalizeAddAttachmentPlaceholder=function(v,w,x){"use strict";if(x.preview_attachments.length>0){v.has_attachment=true;v.preview_attachments=x.preview_attachments;}v.client_state=k.DO_NOT_SEND_TO_SERVER;v.status=g.RESENDING;v.upload_id=w;};function t(v,w,x,y){var z=u(x)?[l.CHAT]:[],aa=Date.now(),ba=r(new Date(aa),'g:ia'),ca={action_type:w,thread_id:y,author:i.getParticipantIDFromUserID(v),author_email:null,coordinates:null,timestamp:aa,timestamp_absolute:(new Date(aa)).toLocaleDateString(),timestamp_relative:ba,timestamp_time_passed:o.TODAY,is_unread:false,is_forward:false,is_filtered_content:false,is_spoof_warning:false,source:x,source_tags:z};return ca;}function u(v){switch(v){case n.CHAT_WEB:case n.CHAT_JABBER:case n.CHAT_IPHONE:case n.CHAT_MEEBO:case n.CHAT_ORCA:case n.CHAT_TEST:case n.CHAT:case n.DESKTOP:return true;default:return false;}}Object.assign(s,m);e.exports=s;},null);
__d("MercuryMessageActions",["MercuryActionType","MercuryMessageObject","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';function l(m){this.$MercuryMessageActions0=m;this.$MercuryMessageActions1=h.getForFBID(this.$MercuryMessageActions0);this.$MercuryMessageActions2=j.getForFBID(this.$MercuryMessageActions0);}l.prototype.send=function(m,n,o){n=n||Function.prototype;this.$MercuryMessageActions1.normalizeNewMessage(m);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},m),i.CLIENT_SEND_MESSAGE));this.$MercuryMessageActions2.sendNewMessage(m,o);n(m.thread_id);};l.prototype.resend=function(m,n){var o=Object.assign({},m);this.$MercuryMessageActions1.normalizeResendMessage(o);this.send(o,(void 0),n);};l.prototype.addAttachmentPlaceholder=function(m,n,o){this.$MercuryMessageActions1.normalizeAddAttachmentPlaceholder(m,n,o);this.$MercuryMessageActions1.normalizeNewMessage(m);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},m),i.CLIENT_SEND_MESSAGE));};l.prototype.cancelAttachmentPlaceholder=function(m,n){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:m,upload_data:n,action_type:g.CANCEL_ATTACHMENT_PLACEHOLDER},i.CLIENT_SEND_MESSAGE));};l.prototype.confirmAttachmentPlaceholder=function(m,n){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:m,upload_data:n,action_type:g.CONFIRM_ATTACHMENT_PLACEHOLDER},i.CLIENT_SEND_MESSAGE));};l.prototype.markSpam=function(m,n){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions4(m,n,g.MARK_MESSAGES_SPAM,i.CLIENT_MARK_MESSAGES_SPAM));};l.prototype["delete"]=function(m,n,o){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions4(m,n,g.DELETE_MESSAGES,o||i.CLIENT_DELETE_MESSAGES));};l.prototype.$MercuryMessageActions3=function(m,n){return {actions:[m],from_client:true,payload_source:n};};l.prototype.$MercuryMessageActions5=function(m,n){return {actions:[m],from_client:false,payload_source:n};};l.prototype.$MercuryMessageActions4=function(m,n,o,p){return {actions:[{action_type:o,action_id:null,thread_id:m,message_ids:n}],from_client:true,payload_source:p};};Object.assign(l,k);e.exports=l;},null);
__d("MercuryThreadActions",["MercuryActionType","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin","MessagingTag","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n){this.$MercuryThreadActions0=n;this.__serverRequests=i.getForFBID(this.$MercuryThreadActions0);}m.prototype.markRead=function(n,o){this.batchMarkRead([n],o);};m.prototype.batchMarkRead=function(n,o){this.__serverRequests.handleUpdate(this.$MercuryThreadActions1(n,true,o));};m.prototype.markUnread=function(n,o){this.batchMarkUnread([n],o);};m.prototype.batchMarkUnread=function(n,o){this.__serverRequests.handleUpdate(this.$MercuryThreadActions1(n,false,o));};m.prototype.markSeen=function(n,o){this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.MARK_THREAD_SEEN,h.CLIENT_MARK_THREAD_SEEN,{persistent:o}));};m.prototype.archive=function(n,o){this.batchArchive([n],o);};m.prototype.batchArchive=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadArchivedStatus(p,true,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions2(n,true));};m.prototype.unarchive=function(n,o){this.batchUnarchive([n],o);};m.prototype.batchUnarchive=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadArchivedStatus(p,false,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions2(n,false));};m.prototype.markSpam=function(n,o){this.batchMarkSpam([n],o);};m.prototype.batchMarkSpam=function(n,o){n.forEach(function(p){this.__serverRequests.markThreadSpam(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions3(n,k.SPAM));};m.prototype.unmarkSpam=function(n,o){this.batchUnmarkSpam([n],o);};m.prototype.batchUnmarkSpam=function(n,o){n.forEach(function(p){this.__serverRequests.unmarkThreadSpam(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions3(n,k.INBOX));};m.prototype.changeFolder=function(n,o){this.batchChangeFolder([n],o);};m.prototype.batchChangeFolder=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadFolder(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.$MercuryThreadActions3(n,o));};m.prototype["delete"]=function(n,o){this.batchDelete([n],o);};m.prototype.batchDelete=function(n,o){n.forEach(function(p){this.__serverRequests.deleteThread(p,o);}.bind(this));this.__serverRequests.handleUpdate(this.__constructClientPayload(n,g.DELETE_THREAD,h.CLIENT_DELETE_THREAD));};m.prototype.unmute=function(n){this.updateMuteSetting(n,0);};m.prototype.updateMuteSetting=function(n,o){this.__serverRequests.changeMutingOnThread(n,o);this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.CHANGE_MUTE_SETTINGS,h.CLIENT_CHANGE_MUTE_SETTINGS,{mute_settings:o}));};m.prototype.addParticipants=function(n,o){this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.ADD_PARTICIPANTS,h.CLIENT_ADD_PARTICIPANTS,{participants:o}));};m.prototype.unpinThread=function(n){this.__serverRequests.unpinThread(n);this.__serverRequests.handleUpdate(this.__constructClientPayload([n],g.UNPIN_THREAD,h.CLIENT_UNPIN_THREAD));};m.prototype.$MercuryThreadActions1=function(n,o,p){return this.__constructClientPayload(n,g.CHANGE_READ_STATUS,h.CLIENT_CHANGE_READ_STATUS,{mark_as_read:o,source:p});};m.prototype.$MercuryThreadActions2=function(n,o){return this.__constructClientPayload(n,g.CHANGE_ARCHIVED_STATUS,h.CLIENT_CHANGE_ARCHIVED_STATUS,{archived:o});};m.prototype.$MercuryThreadActions3=function(n,o){return this.__constructClientPayload(n,g.CHANGE_FOLDER,h.CLIENT_CHANGE_FOLDER,{new_folder:o});};m.prototype.__constructClientPayload=function(n,o,p,q){return {actions:n.map(function(r){return l({action_type:o,action_id:null,thread_id:r},q);}),from_client:true,payload_source:p};};Object.assign(m,j);e.exports=m;},null);
__d("MercuryAttachmentSnippetType",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=g({PHOTO:null,GIF:null,VIDEO:null,AUDIO_CLIP:null,STICKER:null,ORION:null,SHARE:null,ERROR:null,MIXED:null});e.exports=h;},null);
__d("MessengerDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("MercuryShareAttachmentReactShape",["React"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g,i=h.PropTypes,j=i.shape({share_id:i.string,description:i.string,media:i.shape({image:i.string,image_size:i.shape({height:i.number,width:i.number}),duration:i.number,playable:i.bool,source:i.string}),source:i.string,style_list:i.arrayOf(i.string),subattachments:i.array,target:i.object,title:i.string,properties:i.object,uri:i.string}).isRequired;e.exports=j;},null);
__d("MessengerMomentsAppSnippet.react",["Image.react","MercuryShareAttachmentReactShape","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"MessengerMomentsAppSnippet",propTypes:{attachment:h,isSenderViewer:n.bool,senderName:n.string},render:function(){var p=this.props.attachment;if(!p||!p.target)return null;var q,r=p.target.photo_count;if(this.props.isViewerSender){if(r==1){q=(k._("You synced 1 photo."));}else q=(k._("You synced {photo_count} photos.",[k.param("photo_count",r)]));}else if(r==1){q=(k._("{sender name} synced 1 photo.",[k.param("sender name",this.props.senderName)]));}else q=(k._("{sender name} synced {photo_count} photos.",[k.param("sender name",this.props.senderName),k.param("photo_count",r)]));return (i.createElement("span",{className:"uiIconText _3l6h"},i.createElement(g,{src:l('/images/messaging/docs/generic.png')}),q));}});e.exports=o;},null);
__d("MercuryAttachmentSnippetRenderer",["MercuryAttachment","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryConstants","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={getAttachmentSnippetType:function(m){if(this._hasOnlyPhotos(m))return h.PHOTO;if(this._hasOnlyAnimatedImages(m))return h.GIF;if(this._hasOnlyVideo(m))return h.VIDEO;if(this._hasAudioClip(m))return h.AUDIO_CLIP;if(this._hasSticker(m))return h.STICKER;if(this._hasOrion(m))return h.ORION;if(this._hasShare(m))return h.SHARE;if(this._hasError(m))return h.ERROR;return h.MIXED;},renderAttachmentSnippetText:function(m,n,o,p){switch(m){case h.PHOTO:return this._renderPhotoAttachmentSnippetText(n,o,this._getPhotoAttachments(p));case h.GIF:return this._renderAnimatedImagesAttachmentSnippetText(n,o,this._getAnimatedImageAttachments(p));case h.VIDEO:return n?k._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) film.","16777216":"Wys\u0142a\u0142e\u015b film.","33554432":"Wys\u0142a\u0142a\u015b film.","__vcg":1}):k._("{sender name} wys\u0142a\u0142(a) film.",[k.param("sender name",o)]);case h.AUDIO_CLIP:return n?k._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) wiadomo\u015b\u0107 g\u0142osow\u0105","16777216":"Wys\u0142a\u0142e\u015b wiadomo\u015b\u0107 g\u0142osow\u0105","33554432":"Wys\u0142a\u0142a\u015b wiadomo\u015b\u0107 g\u0142osow\u0105","__vcg":1}):k._("{name} wys\u0142a\u0142(a) wiadomo\u015b\u0107 g\u0142osow\u0105.",[k.param("name",o)]);case h.STICKER:return n?k._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) naklejk\u0119.","16777216":"Wys\u0142a\u0142e\u015b naklejk\u0119.","33554432":"Wys\u0142a\u0142a\u015b naklejk\u0119.","__vcg":1}):k._("{name} wys\u0142a\u0142(a) naklejk\u0119.",[k.param("name",o)]);case h.ORION:if(p&&p[0]&&p[0].metadata)return this.renderOrionSnippetText(n,o,p[0].metadata);break;case h.SHARE:return n?k._("Udost\u0119pni\u0142e\u015b(a\u015b) link."):k._("{sender name} udost\u0119pni\u0142(a) link.",[k.param("sender name",o)]);case h.ERROR:return n?k._("Za\u0142\u0105cznik zosta\u0142 przez Ciebie wys\u0142any."):k._("{sender name} wys\u0142a\u0142(a) za\u0142\u0105cznik.",[k.param("sender name",o)]);default:return '';}},_hasOnlyPhotos:function(m){return this._getPhotoAttachments(m).length===m.length;},_hasOnlyAnimatedImages:function(m){return this._getAnimatedImageAttachments(m).length===m.length;},_hasOnlyVideo:function(m){return (m.length===1&&m[0].attach_type===i.VIDEO);},_hasAudioClip:function(m){return !!(m.length===1&&m[0].metadata&&g.isVoiceMessage(m[0].metadata.type));},_hasSticker:function(m){return (m.length===1&&m[0].attach_type===i.STICKER);},_hasOrion:function(m){return this._hasSingleAttachmentOfShareDataType(m,j.MercurySupportedShareType.FB_ORION);},_hasSingleAttachmentOfShareDataType:function(m,n){return (m.length===1&&m[0].share_data_type===n);},_hasShare:function(m){return (m.length===1&&m[0].attach_type===i.SHARE);},_hasError:function(m){return (m.length===1&&m[0].attach_type===i.ERROR);},_getPhotoAttachments:function(m){if(!m)return [];return m.filter(function(n){return n.attach_type===i.PHOTO;});},_getAnimatedImageAttachments:function(m){if(!m)return [];return m.filter(function(n){return n.attach_type===i.ANIMATED_IMAGE;});},_renderPhotoAttachmentSnippetText:function(m,n,o){if(o.length===1){if(m){return (k._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) zdj\u0119cie.","16777216":"Wys\u0142a\u0142e\u015b zdj\u0119cie.","33554432":"Wys\u0142a\u0142a\u015b zdj\u0119cie.","__vcg":1}));}else return (k._("{name} wys\u0142a\u0142(a) zdj\u0119cie.",[k.param("name",n)]));}else if(m){return (k._({"*":{"*":"Wys\u0142a\u0142e\u015b(a\u015b) {num_photos} zdj\u0119\u0107."},"16777216":{"*":"Wys\u0142a\u0142e\u015b {num_photos} zdj\u0119\u0107.","268435456":"Wys\u0142a\u0142e\u015b {num_photos} zdj\u0119cie.","536870912":"Wys\u0142a\u0142e\u015b {num_photos} zdj\u0119cia.","805306368":"Wys\u0142a\u0142e\u015b {num_photos} zdj\u0119\u0107."},"33554432":{"*":"Wys\u0142a\u0142a\u015b {num_photos} zdj\u0119\u0107.","268435456":"Wys\u0142a\u0142a\u015b {num_photos} zdj\u0119cie.","536870912":"Wys\u0142a\u0142a\u015b {num_photos} zdj\u0119cia.","805306368":"Wys\u0142a\u0142a\u015b {num_photos} zdj\u0119\u0107."},"50331648":{"*":"Wys\u0142a\u0142e\u015b(a\u015b) {num_photos} zdj\u0119\u0107."},"__vcg":1},[k.param("num_photos",o.length,[0])]));}else return (k._({"*":"{name} wys\u0142a\u0142(a) {num_photos} zdj\u0119\u0107."},[k.param("name",n),k.param("num_photos",o.length,[0])]));},_renderAnimatedImagesAttachmentSnippetText:function(m,n,o){if(o.length===1){if(m){return (k._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) plik GIF.","16777216":"Wys\u0142a\u0142e\u015b plik GIF.","33554432":"Wys\u0142a\u0142a\u015b plik GIF.","__vcg":1}));}else return (k._("{name} wys\u0142a\u0142(a) plik GIF.",[k.param("name",n)]));}else if(m){return (k._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) {num_animated_images} plik\u00f3w GIF.","__vcg":1},[k.param("num_animated_images",o.length)]));}else return (k._("{name} wys\u0142a\u0142(a) {num_animated_images} plik\u00f3w GIF.",[k.param("name",n),k.param("num_animated_images",o.length)]));},renderOrionSnippetText:function(m,n,o,p){if(m){return (k._("Wys\u0142ano {amount} {currency}.",[k.param("currency",o),k.param("amount",p)]));}else return (k._("{name} wys\u0142a\u0142(a) Ci kwot\u0119 {amount} {currency}.",[k.param("name",n),k.param("currency",o),k.param("amount",p)]));}};e.exports=l;},null);
__d("P2PMercuryAttachmentSnippet.react",["CurrentUser","Image.react","MercuryAttachmentSnippetRenderer","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"P2PMercuryAttachment",propTypes:{sender:n.object,receiver:n.object,amount:n.string,currency:n.string},getDefaultProps:function(){return {sender:{},receiver:{}};},render:function(){var p=i.renderOrionSnippetText(g.getID()===this.props.sender.id,this.props.sender.name,this.props.currency,this.props.amount);return (j.createElement("span",{className:"uiIconText _3l6h _3_io"},j.createElement(h,{height:12,src:l('/images/p2p/attachment-snippet-icon.png'),width:12}),p));}});e.exports=o;},null);
__d("MercuryShareAttachmentRenderLocations",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={CHAT:'chat',CHAT_PREVIEW:'chat_preview',MESSENGER:'messenger',WEB_INBOX:'web_inbox',getValues:function(){return [g.CHAT,g.CHAT_PREVIEW,g.MESSENGER,g.WEB_INBOX];},isPreview:function(h){return h===g.CHAT_PREVIEW;}};e.exports=g;},null);
__d("MNCommerceAttachmentUtils",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={shouldRenderMap:function(h,i){return (!!h&&h.latitude&&h.longitude&&!!i);}};e.exports=g;},null);
__d("MercuryFallbackShareAttachmentSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryFallbackShareAttachmentSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o;if(this.props.isViewerSender){o=(j._("Udost\u0119pni\u0142e\u015b(a\u015b) link."));}else o=(j._("{sender name} udost\u0119pni\u0142(a) link.",[j.param("sender name",this.props.senderName)]));return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/messaging/docs/generic.png')}),o));}});e.exports=n;},null);
__d("P2PMercuryShareAttachmentSnippet.react",["MercuryShareAttachmentReactShape","P2PMercuryAttachmentSnippet.react","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i.createClass({displayName:"P2PMercuryShareAttachmentSnippet",propTypes:{attachment:g},render:function(){var k=this.props.attachment?this.props.attachment.target:{};return (i.createElement(h,i.__spread({},k)));}});e.exports=j;},null);
__d("MercuryPhotoShareSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryPhotoShareSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o=this.props.isViewerSender?j._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) zdj\u0119cie.","16777216":"Wys\u0142a\u0142e\u015b zdj\u0119cie.","33554432":"Wys\u0142a\u0142a\u015b zdj\u0119cie.","__vcg":1}):j._("{sender name} wys\u0142a\u0142(a) zdj\u0119cie.",[j.param("sender name",this.props.senderName)]);return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/icons/photo.gif')}),o));}});e.exports=n;},null);
__d("MercuryVideoShareSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryVideoShareSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o=this.props.isViewerSender?j._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) film.","16777216":"Wys\u0142a\u0142e\u015b film.","33554432":"Wys\u0142a\u0142a\u015b film.","__vcg":1}):j._("{sender name} wys\u0142a\u0142(a) film.",[j.param("sender name",this.props.senderName)]);return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/icons/video.gif')}),o));}});e.exports=n;},null);
__d("MercuryMessageLocationShareAttachmentSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryMessageLocationShareAttachmentSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o;if(this.props.isViewerSender){o=(j._({"*":"Wys\u0142a\u0142e\u015b(a\u015b) lokalizacj\u0119.","16777216":"Wys\u0142a\u0142e\u015b lokalizacj\u0119.","33554432":"Wys\u0142a\u0142a\u015b lokalizacj\u0119.","__vcg":1}));}else o=(j._("{sender name} wys\u0142a\u0142(a) lokalizacj\u0119.",[j.param("sender name",this.props.senderName)]));return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/messaging/location/location.png')}),o));}});e.exports=n;},null);
__d("MercuryAnimatedShareSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryAnimatedShareSnippet",propTypes:{isViewerSender:m.bool,senderName:m.string},render:function(){var o=this.props.isViewerSender?j._("Wys\u0142a\u0142e\u015b(a\u015b) plik GIF."):j._("U\u017cytkownik {sender name} przesy\u0142a plik GIF.",[j.param("sender name",this.props.senderName)]);return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/icons/photo.gif')}),o));}});e.exports=n;},null);
__d("MercuryShareStyleMap",["Map","MercuryConfig","MercuryShareAttachmentRenderLocations","MNCommerceAttachmentUtils","StoryAttachmentStyle","cx","emptyFunction","getModuleLoader","MercuryFallbackShareAttachmentSnippet.react","P2PMercuryShareAttachmentSnippet.react","MessengerMomentsAppSnippet.react","MercuryPhotoShareSnippet.react","MercuryVideoShareSnippet.react","MercuryMessageLocationShareAttachmentSnippet.react","MercuryAnimatedShareSnippet.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=new g();o.set(k.FALLBACK,{componentName:'MercuryFallbackShareAttachment.react',componentLoader:n(['MercuryFallbackShareAttachment.react']),getSnippetComponent:function(){return b('MercuryFallbackShareAttachmentSnippet.react');},cx:new g([[i.MESSENGER,"_5i_d"]]),requiresNoBubbleTail:function(q,r){return q.share.media.image&&r;}});o.set(k.ORION,{componentName:'P2PMercuryShareAttachment.react',componentLoader:n(['P2PMercuryShareAttachment.react']),getSnippetComponent:function(){return b('P2PMercuryShareAttachmentSnippet.react');},cx:new g([[i.MESSENGER,"_5i_d _3djc"]])});if(h.WWWMessengerCommerceGK){o.set(k.RETAIL_RECEIPT,{componentName:'MNCommerceReceiptMercuryShareAttachment.react',componentLoader:n(['MNCommerceReceiptMercuryShareAttachment.react']),cx:new g([[i.MESSENGER,"_5i_d _205d"]]),requiresNoBubbleTail:function(q){return q.share&&q.share.target&&Object.keys(q.share.target.items).length===1;}});o.set(k.RETAIL_CANCELLATION,{componentName:'MNCommerceCancelReturnMercuryShareAttachment.react',componentLoader:n(['MNCommerceCancelReturnMercuryShareAttachment.react']),cx:new g([[i.MESSENGER,"_5i_d _205d"]])});o.set(k.RETAIL_SHIPMENT,{componentName:'MNCommerceShippingMercuryShareAttachment.react',componentLoader:n(['MNCommerceShippingMercuryShareAttachment.react']),cx:new g([[i.MESSENGER,"_5i_d _205d"]]),requiresNoBubbleTail:function(q){var r=q.share&&q.share.target&&q.share.target;return r&&j.shouldRenderMap(r.destination,r.estimated_delivery_display_time);}});o.set(k.RETAIL_SHIPMENT_TRACKING_EVENT,{componentName:'MNCommerceShippingMercuryShareAttachment.react',componentLoader:n(['MNCommerceShippingMercuryShareAttachment.react']),cx:new g([[i.MESSENGER,"_5i_d _205d"]])});}if(h.MomentsMessengerWWWGK)o.set(k.MOMENTS_APP_INVITATION,{componentName:'MessengerMomentsAppShareAttachment.react',componentLoader:n(['MessengerMomentsAppShareAttachment.react']),getSnippetComponent:function(){return b('MessengerMomentsAppSnippet.react');},cx:new g([[i.MESSENGER,"_5i_d"]]),requiresNoBubbleTail:m.thatReturnsTrue});o.set(k.PHOTO,{componentName:'MercuryPhotoShareAttachment.react',componentLoader:n(['MercuryPhotoShareAttachment.react']),getSnippetComponent:function(){return b('MercuryPhotoShareSnippet.react');},cx:null,requiresNoBubbleTail:m.thatReturnsTrue,unwrapInStory:m.thatReturnsTrue});o.set(k.IMAGE_SHARE,{componentName:'MercuryImageShareAttachment.react',componentLoader:n(['MercuryImageShareAttachment.react']),getSnippetComponent:function(){return b('MercuryPhotoShareSnippet.react');},cx:null,requiresNoBubbleTail:m.thatReturnsTrue,unwrapInStory:m.thatReturnsTrue});o.set(k.VIDEO,{componentName:'MercuryVideoShareAttachment.react',componentLoader:n(['MercuryVideoShareAttachment.react']),getSnippetComponent:function(){return b('MercuryVideoShareSnippet.react');},cx:null,requiresNoBubbleTail:m.thatReturnsTrue,unwrapInStory:m.thatReturnsTrue});o.set(k.MESSAGE_LOCATION,{componentName:'MercuryMessageLocationShareAttachment.react',componentLoader:n(['MercuryMessageLocationShareAttachment.react']),getSnippetComponent:function(){return b('MercuryMessageLocationShareAttachmentSnippet.react');},cx:new g([[i.MESSENGER,"_5i_d"]]),requiresNoBubbleTail:function(q,r){return q.share.media.image&&r;}});o.set(k.ANIMATED_IMAGE_SHARE,{componentName:'MercuryAnimatedShareAttachment.react',componentLoader:n(['MercuryAnimatedShareAttachment.react']),getSnippetComponent:function(){return b('MercuryAnimatedShareSnippet.react');},cx:null,requiresNoBubbleTail:m.thatReturnsTrue,unwrapInStory:m.thatReturnsFalse});var p={getStyleFactory:function(q){if(!q||!q.style_list)return null;if(q.style_list[0]===k.ATTACHED_STORY){var r=q.subattachments,s=(r&&r.length)?r[0].style_list:[],t=this._getStyleMapEntry(s);if(t&&t.unwrapInStory&&t.unwrapInStory())return {attachment:r[0],factory:t};}var u=this._getStyleMapEntry(q.style_list);if(!u)return null;return {attachment:q,factory:u};},_getStyleMapEntry:function(q){for(var r=0;r<q.length;r++){var s=o.get(q[r]);if(s)return s;}return null;}};e.exports=p;},null);
__d("MercuryShareAttachmentSnippet.react",["MercuryShareAttachmentReactShape","MercuryShareStyleMap","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i,k=j.PropTypes,l=i.createClass({displayName:"MercuryShareAttachmentSnippet",propTypes:{attachment:g,isSenderViewer:k.bool,senderName:k.string},render:function(){var m=h.getStyleFactory(this.props.attachment);if(m.factory&&!!m.factory.getSnippetComponent){var n=m.factory.getSnippetComponent();return (i.createElement(n,i.__spread({},this.props,{attachment:m.attachment})));}return null;}});e.exports=l;},null);
__d("ImageSourceType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={PROFILE_PICTURE:'profile_picture',IMAGE:'image'};e.exports=g;},null);
__d("ImageSourceRequest",["CurrentUser","ImageSourceType","KeyedCallbackManager","PhotoResizeModeConst","MercuryServerDispatcher","arrayContains"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(){"use strict";this._request={fbid:null,type:null,width:null,height:null,resize_mode:null};this._callback=null;}m.prototype.setFBID=function(q){"use strict";this._request.fbid=q;return this;};m.prototype.setType=function(q){"use strict";if(!l([h.PROFILE_PICTURE,h.IMAGE],q))throw new TypeError('ImageSourceRequest.setType: invalid type '+q);this._request.type=q;return this;};m.prototype.setDimensions=function(q,r){"use strict";this._request.width=q;this._request.height=r;return this;};m.prototype.setResizeMode=function(q){"use strict";if(!l([j.COVER,j.CONTAIN],q))throw new TypeError('ImageSourceRequest.setResizeMode: invalid resize mode '+q);this._request.resize_mode=q;return this;};m.prototype.setCallback=function(q){"use strict";this._callback=q;return this;};m.prototype.send=function(){"use strict";if(!this._request.fbid||!this._request.width||!this._request.height||!this._request.type||!this._request.resize_mode||!this._callback)throw new Error('ImageSourceRequest: You must set all the fields');var q=o(),r=p(this._request);q.executeOrEnqueue(r,this._callback);if(q.getUnavailableResourcesFromRequest(r).length===1){k.trySend('/ajax/image_source.php',{requests:[this._request]});return true;}return false;};var n=null;function o(){if(n)return n;var q=new i();n=q;k.registerEndpoints({'/ajax/image_source.php':{request_user_id:g.getID(),mode:k.BATCH_DEFERRED_MULTI,batch_function:function(r,s){var t;(t=r.requests).push.apply(t,s.requests);return r;},handler:function(r,s){var t=s.getData().requests;for(var u=0;u<t.length;++u)q.setResource(p(t[u]),r[u]);}}});return q;}function p(q){return [q.fbid,q.type,q.width,q.height,q.resize_mode].join('|');}e.exports=m;},null);
__d("MercuryParticipantFetcher",["LogHistory","MercuryIDs","MercuryPayloadSource","MercuryServerRequests","Set","ShortProfiles","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=g.getInstance('short_profiles');function o(q){this.$MercuryParticipantFetcher0=j.getForFBID(q);this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2=new k();this.$MercuryParticipantFetcher3=new k();}o.prototype.fetch=function(q){this.$MercuryParticipantFetcher4(q);this.$MercuryParticipantFetcher5();};o.prototype.fetchMulti=function(q){q.forEach(function(r){return this.$MercuryParticipantFetcher4(r);}.bind(this));this.$MercuryParticipantFetcher5();};o.prototype.$MercuryParticipantFetcher4=function(q){if(!this.$MercuryParticipantFetcher3.has(q))this.$MercuryParticipantFetcher2.add(q);};o.prototype.$MercuryParticipantFetcher5=function(){if(this.$MercuryParticipantFetcher1||this.$MercuryParticipantFetcher2.size===0)return;this.$MercuryParticipantFetcher1=true;m(function(){this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2.forEach(function(q){return this.$MercuryParticipantFetcher3.add(q);}.bind(this));this.$MercuryParticipantFetcher6(this.$MercuryParticipantFetcher2,function(q){q.forEach(function(r){return this.$MercuryParticipantFetcher3["delete"](r.id);}.bind(this));this.$MercuryParticipantFetcher7(q);}.bind(this));this.$MercuryParticipantFetcher2.clear();}.bind(this));};o.prototype.$MercuryParticipantFetcher6=function(q,r){var s=[];q.forEach(function(t){var u=h.tokenize(t),v=u.type,w=u.value;v==='fbid'&&s.push(w);});if(s.length>0){l.getMulti(s,function(t){var u=[];for(var v in t)u.push(p(t[v],v));r(u);if(u.length!==s.length)n.error('server_fetch_participant_count_error',{expectedIDs:s,receivedIDs:Object.keys(t)});});n.debug('client_fetch_participants',{userIDs:s});}};o.prototype.$MercuryParticipantFetcher7=function(q){this.$MercuryParticipantFetcher0.handleUpdate({participants:q,from_client:false,payload_source:i.SERVER_FETCH_PARTICIPANTS});};function p(q,r){var s=Object.assign({gender:q.gender,fbid:q.id||r,href:q.uri,id:h.getParticipantIDFromUserID(q.id||r),image_src:q.thumbSrc,name:q.name,short_name:q.firstName,employee:q.employee,is_employee_away:q.is_employee_away,type:q.type,vanity:q.vanity,is_friend:q.is_friend,is_messenger_user:q.is_messenger_user,social_snippets:q.social_snippets},{});if(q.officeStatus){s.officeStatus=q.officeStatus;s.officeStatusStartDate=q.officeStatusStartDate;s.officeStatusEndDate=q.officeStatusEndDate;s.officeStatusComment=q.officeStatusComment;s.officeStatusLocation=q.officeStatusLocation;}return s;}e.exports=o;},null);
__d("MercuryParticipants",["CurrentUser","EventEmitter","ImageSourceRequest","ImageSourceType","ImmutableObject","KeyedCallbackManager","Map","MercuryAssert","MercuryIDs","MercuryParticipantFetcher","MercuryParticipantTypes","MercuryParticipantsConstants","MercuryServerRequests","PhotoResizeModeConst","Set","fbt","mapObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();'use strict';var x='change';function y(aa){this.$MercuryParticipants0=aa;this.$MercuryParticipants1=new h();this.$MercuryParticipants2=new l();this.$MercuryParticipants3=new p(this.$MercuryParticipants0);this.$MercuryParticipants4=new m();this.$MercuryParticipants5=s.getForFBID(this.$MercuryParticipants0);this.$MercuryParticipants5.subscribe('update-participants',function(ba,ca){if(ca.participants&&ca.participants.length>0){var da={};ca.participants.forEach(function(ea){da[ea.id]=ea;});this.$MercuryParticipants6(da);}}.bind(this));}y.prototype.addListener=function(aa,ba){return this.$MercuryParticipants1.addListener(aa,ba);};y.prototype.getIDFromVanityOrFBID=function(aa){if(!aa)return;if(this.$MercuryParticipants4.has(aa))return this.$MercuryParticipants4.get(aa);if(/^\d+$/.test(aa))return o.getParticipantIDFromUserID(aa);};y.prototype.getNow=function(aa){return this.$MercuryParticipants7(aa);};y.prototype.getOrFetch=function(aa){var ba=this.$MercuryParticipants7(aa);if(!ba)this.$MercuryParticipants3.fetch(aa);return ba;};y.prototype.get=function(aa,ba){n.isParticipantID(aa);return this.$MercuryParticipants8([aa],function(ca){ba(ca[aa]);});};y.prototype.getMulti=function(aa,ba){return this.$MercuryParticipants8(aa,ba);};y.prototype.getBigImageMulti=function(aa,ba){n.allParticipantIDs(aa);var ca=r.BIG_IMAGE_SIZE;return this.$MercuryParticipants8(aa,function(da){var ea={},fa=0,ga=new u(),ha=function(la,ma){fa++;ea[la]=ma;if(fa===aa.length){ba(ea);if(ga.size>0)this.$MercuryParticipants9(ga);}}.bind(this),ia=function(la,ma){this.$MercuryParticipants2.setResource(la,k.set(this.$MercuryParticipants2.getResource(la),{big_image_src:ma.uri}));ga.add(la);ha(la,ma.uri);}.bind(this);for(var ja in da){var ka=da[ja];if(!ka.big_image_src){new i().setFBID(o.getUserIDFromParticipantID(ja)).setType(j.PROFILE_PICTURE).setDimensions(ca,ca).setResizeMode(t.COVER).setCallback(ia.bind(null,ja)).send();}else ha(ka.id,ka.big_image_src);}}.bind(this));};y.prototype.getOrderedBigImageMulti=function(aa,ba){return this.getBigImageMulti(aa,function(ca){ba(aa.map(function(da){return ca[da];}));});};y.prototype.$MercuryParticipants8=function(aa,ba){n.allParticipantIDs(aa);var ca=this.$MercuryParticipants2.executeOrEnqueue(aa,ba),da=this.$MercuryParticipants2.getUnavailableResources(ca).filter(function(ea){var fa=o.tokenize(ea),ga=fa.type,ha=fa.value;if(ga==='email'){this.$MercuryParticipantsa(ea,ha);return false;}return true;}.bind(this));this.$MercuryParticipants3.fetchMulti(da);return this.$MercuryParticipantsb(ca);};y.prototype.$MercuryParticipants7=function(aa){var ba=this.$MercuryParticipants2.getResource(aa);if(!ba){var ca=o.tokenize(aa),da=ca.type,ea=ca.value;if(da==='email')ba=this.$MercuryParticipantsa(aa,ea);}return ba;};y.prototype.$MercuryParticipantsa=function(aa,ba){var ca=new k(z(aa,ba));this.$MercuryParticipants2.setResource(aa,ca);return ca;};y.prototype.$MercuryParticipants9=function(aa){this.$MercuryParticipants1.emit(x,aa);};y.prototype.$MercuryParticipants6=function(aa){aa=w(aa,function(ba,ca){if(ba.vanity)this.$MercuryParticipants4.set(ba.vanity,ca);return new k(this.$MercuryParticipantsc(ba));}.bind(this));this.$MercuryParticipants2.addResourcesAndExecute(aa);this.$MercuryParticipants9(new u(Object.keys(aa)));};y.prototype.$MercuryParticipantsc=function(aa){var ba=aa.type===q.USER||aa.type===q.FRIEND;if(!ba)return aa;if(!aa.name&&!aa.href&&!aa.vanity){var ca=v._("U\u017cytkownik Facebooka");aa.name=ca;aa.short_name=ca;}return aa;};y.prototype.$MercuryParticipantsb=function(aa){return {remove:function(){this.$MercuryParticipants2.unsubscribe(aa);}.bind(this)};};function z(aa,ba){return {gender:r.UNKNOWN_GENDER,href:null,id:aa,image_src:r.EMAIL_IMAGE,big_image_src:r.EMAIL_IMAGE,name:ba,short_name:ba,employee:false};}e.exports=new y(g.getID());},null);
__d("MercuryAttachmentSnippet.react",["EmoticonsList","Image.react","MercuryAttachment","MercuryAttachmentSnippetRenderer","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryIDs","P2PMercuryAttachmentSnippet.react","MercuryShareAttachmentSnippet.react","MercuryParticipants","React","StickerConstants","TextWithEmoticons.react","cx","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=q,x=w.PropTypes,y=q.createClass({displayName:"MercuryAttachmentSnippet",propTypes:{thread:x.object.isRequired,viewer:x.string.isRequired},componentWillMount:function(){this._ensureParticipant(this.props.thread.snippet_sender);this._setVariables(this.props);},componentWillReceiveProps:function(ba){this._ensureParticipant(ba.thread.snippet_sender);this._setVariables(ba);},componentWillUnmount:function(){this._cancelParticipantFetch();},render:function(){var ba=this._getSenderName(),ca=j.getAttachmentSnippetType(this._attachments);switch(ca){case k.PHOTO:return this._renderPhotoSnippet(ba);case k.GIF:return this._renderAnimatedImageSnippet(ba);case k.VIDEO:return this._renderVideoSnippet(ba);case k.AUDIO_CLIP:return this._renderAudioClipSnippet(ba);case k.STICKER:return this._renderStickerSnippet(ba);case k.ORION:return this._renderOrionSnippet(ba);case k.SHARE:return this._renderShareSnippet(ba);case k.ERROR:return this._renderError(ba);default:return this._renderMixedSnippet(ba);}},_renderPhotoSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.PHOTO,this._isViewerSender,ba,this._attachments));},_renderAnimatedImageSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.GIF,this._isViewerSender,ba,this._attachments));},_renderVideoSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.VIDEO,this._isViewerSender,ba));},_renderAudioClipSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.AUDIO_CLIP,this._isViewerSender,ba));},_renderStickerSnippet:function(ba){if(z(this._attachments[0].metadata.stickerID)){return (q.createElement(s,{renderEmoticons:true,text:g.symbols.like}));}else return (q.createElement("span",null,j.renderAttachmentSnippetText(k.STICKER,this._isViewerSender,ba)));},_renderOrionSnippet:function(ba){return (q.createElement("span",null,q.createElement(n,q.__spread({},this._attachments[0].metadata))));},_renderShareSnippet:function(ba){if(!!this._attachments[0].share)return (q.createElement(o,{attachment:this._attachments[0].share,senderName:ba,isViewerSender:this._isViewerSender}));return this._renderSnippet(j.renderAttachmentSnippetText(k.SHARE,this._isViewerSender,ba));},_renderMixedSnippet:function(ba){return (q.createElement("span",null,this._attachments.filter(function(ca){return ca.attach_type===l.FILE||ca.attach_type===l.PHOTO||ca.attach_type===l.VIDEO;}).map(function(ca,da){return this._renderSnippet(ca.name,ca.icon_type,da);}.bind(this))));},_renderSnippet:function(ba,ca,da){var ea=i.getAttachIconClass(ca||this._attachments[0].icon_type),fa=v(ea,"uiIconText _3l6h");return (q.createElement("span",{className:fa,key:da},q.createElement(h,{src:u('/images/messaging/docs/generic.png')}),ba));},_renderError:function(ba){var ca=j.renderAttachmentSnippetText(k.ERROR,this._isViewerSender,ba);return this._renderSnippet(ca);},_setVariables:function(ba){this._viewer=ba.viewer;this._sender=ba.thread.snippet_sender;this._attachments=ba.thread.snippet_attachments;this._isViewerSender=aa(this._sender,this._viewer);},_getSenderName:function(){if(!this._sender||this._isViewerSender)return null;var ba=p.getNow(this._sender);if(!ba)return null;return ba.short_name;},_ensureParticipant:function(ba){if(!ba)return;this._cancelParticipantFetch();if(!p.getNow(ba))this._sub=p.get(ba,function(ca){return this.forceUpdate();}.bind(this));},_cancelParticipantFetch:function(){this._sub&&this._sub.remove();}});function z(ba){return (ba==r.LIKE_STICKER_ID||ba==r.HOT_LIKE_SMALL_STICKER_ID||ba==r.HOT_LIKE_MEDIUM_STICKER_ID||ba==r.HOT_LIKE_LARGE_STICKER_ID);}function aa(ba,ca){return !!(ba&&m.getParticipantIDFromUserID(ca)==ba);}e.exports=y;},null);
__d("MercuryParticipantsImage.react",["MercuryParticipants","React","SplitImage.react","areEqual"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MercuryParticipantsImage",_bigImageToken:(null),propTypes:{participants:l.array.isRequired,size:l.number},getInitialState:function(){return {participantImages:[]};},componentDidMount:function(){this._getParticipantImages(this.props);},componentWillReceiveProps:function(n){this._getParticipantImages(n);},componentWillUnmount:function(){this._bigImageToken&&this._bigImageToken.remove();},shouldComponentUpdate:function(n,o){return (n.size!==this.props.size||!o||!j(o.participantImages,this.state.participantImages));},render:function(){if(this.state.participantImages.length>0)return (h.createElement(i,{border:true,className:this.props.className,srcs:this.state.participantImages,size:this.props.size}));return null;},_getParticipantImages:function(n){this._bigImageToken&&this._bigImageToken.remove();(this)._bigImageToken=g.getOrderedBigImageMulti(n.participants,function(o){this.isMounted()&&this.setState({participantImages:o});}.bind(this));}});e.exports=m;},null);
__d("MercuryThreadImage.react",["ImmutableObject","MercuryIDs","MercuryParticipantsImage.react","MercuryParticipantsConstants","Pixelz.react","React","areEqual"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=l,o=n.PropTypes,p=l.createClass({displayName:"MercuryThreadImage",propTypes:{thread:o.instanceOf(g).isRequired,viewer:o.string.isRequired,size:o.number,useBackground:o.bool},shouldComponentUpdate:function(q,r){return (q.thread.image_src!==this.props.thread.image_src||!m(q.thread.participants,this.props.thread.participants)||q.size!==this.props.size||q.viewer!==this.props.viewer||q.useBackground!==this.props.useBackground);},render:function(){var q=this.props.size||j.BIG_IMAGE_SIZE,r=this.props.thread.image_src;if(r){if(this.props.useBackground)return (l.createElement("div",{style:{height:q,backgroundImage:("url("+r+")"),backgroundPosition:'50% 50%',backgroundRepeat:'no-repeat',backgroundSize:'cover',width:q}}));return (l.createElement(k,{height:q,resizeMode:'cover',src:r,width:q}));}var s=h.getParticipantIDFromUserID(this.props.viewer),t=this.props.thread.participants.filter(function(v){return v!==s;}),u=[];if(!t.length){u=[s];}else if(t.length==1){u=t;}else u=t.slice(0,3);return (l.createElement(i,{participants:u,size:q}));}});e.exports=p;},null);
__d("MercuryParticipantListRenderer",["fbt"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(){this.$MercuryParticipantListRenderer0=false;this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=function(r){return this.$MercuryParticipantListRenderer1?r.short_name:r.name;}.bind(this);}h.prototype.renderParticipantList=function(r){var s=r.map(this.$MercuryParticipantListRenderer3);switch(s.length){case 0:return i(this.$MercuryParticipantListRenderer0);case 1:return j(s);case 2:return this.$MercuryParticipantListRenderer2?l(s):k(s);case 3:return this.$MercuryParticipantListRenderer2?n(s):m(s);default:return this.$MercuryParticipantListRenderer2?p(s):o(s);}};h.prototype.setIsNewThread=function(r){this.$MercuryParticipantListRenderer0=r;return this;};h.prototype.setNameRenderer=function(r){this.$MercuryParticipantListRenderer3=r;return this;};h.prototype.setUseShortName=function(r){this.$MercuryParticipantListRenderer1=r;return this;};h.prototype.setUseAndSeparator=function(r){this.$MercuryParticipantListRenderer2=r;return this;};function i(r){if(r){return (g._("Nowa wiadomo\u015b\u0107"));}else return (g._("Brak uczestnik\u00f3w"));}function j(r){return r[0];}function k(r){return (g._("{participant1} i {participant2}",[g.param("participant1",r[0]),g.param("participant2",r[1])]));}function l(r){return (g._("{participant1} i {participant2}",[g.param("participant1",r[0]),g.param("participant2",r[1])]));}function m(r){return (g._("{participant1}, {participant2} i {participant3}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2])]));}function n(r){return (g._("{participant1}, {participant2} i {participant3}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2])]));}function o(r){return (g._("{participant1}, {participant2}, {participant3}, {others_link}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2]),g.param("others_link",q(r.length-3))]));}function p(r){return (g._("{participant1}, {participant2} i {others_link}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("others_link",q(r.length-2))]));}function q(r){if(r>1){return (g._({"*":"inne osoby: {others_count}"},[g.param("others_count",r,[0])]));}else return (g._("1 inna osoba"));}e.exports=h;},null);
__d("MercuryThreadTitle.react",["MercuryIDs","MercuryParticipantListRenderer","MercuryParticipants","React","TextWithEmoticons.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"MercuryThreadTitle",propTypes:{isNewThread:n.bool,thread:n.object.isRequired,viewer:n.string.isRequired,showUnreadCount:n.bool,useShortName:n.bool,useAndSeparator:n.bool},getDefaultProps:function(){return {isNewThread:false,showUnreadCount:false,useShortName:false,useAndSeparator:false};},getInitialState:function(){return {participantNames:''};},componentDidMount:function(){this._renderParticipantsList(this.props);},componentWillReceiveProps:function(p){this._renderParticipantsList(p);},render:function(){return (j.createElement("span",{className:this.props.className},this.props.thread.name?this._renderThreadTitle():this.state.participantNames,this.props.children));},getTitle:function(){return this.state.participantNames;},_renderThreadTitle:function(){var p=this.props.thread,q=j.createElement(k,{renderEmoticons:true,renderEmoji:true,text:p.name});if(!p.unread_count||!this.props.showUnreadCount)return q;return this._renderTitleWithUnreadCount(q,p.unread_count);},_renderParticipantsList:function(p){if(p.thread.name)return;var q=g.getParticipantIDFromUserID(p.viewer),r=p.thread.participants;if(r.length>1)r=r.filter(function(s){return s!=q;});i.getMulti(r,function(s){if(!this.isMounted())return;var t=r.map(function(w){return s[w];}),u=new h().setUseShortName(this.props.useShortName).setUseAndSeparator(this.props.useAndSeparator).setIsNewThread(this.props.isNewThread).renderParticipantList(t),v=(p.showUnreadCount&&p.thread.unread_count)?this._renderTitleWithUnreadCount(u,p.thread.unread_count):u;this.setState({participantNames:v});}.bind(this));},_renderTitleWithUnreadCount:function(p,q){return (l._("{conversation-title} ({unread-count})",[l.param("conversation-title",p),l.param("unread-count",q)]));}});e.exports=o;},null);
__d("WebMessengerThreadPermalinks",["MercuryIDs","MessagingTag","URI","WebMessengerPermalinkConstants","WWWBase","requireWeak"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m={getThreadURI:function(q,r,s){if(g.isCanonical(q)){n(q,r,s);}else o(q,r,s);}};function n(q,r,s){var t=new i(k.uri),u=g.tokenize(q).value;t.setPath(p(s)+'/'+u);r&&r(t.toString());}function o(q,r,s){l(['MercuryThreadIDMap'],function(t){var u=t.get();u.getFBIDFromClientID(q,function(v){var w=new i(k.uri);w.setPath(j.getURIPathForThreadID(v,p(s)));r&&r(w.toString());});});}function p(q){var r=j.BASE_PATH;if(q&&q!=h.INBOX)r+='/'+q;return r;}e.exports=m;},null);
__d("MercuryThreadInfo",["CurrentUser","MercuryThreadMode"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={canReply:function(k){return !!(k.is_subscribed&&k.mode!=h.OBJECT_ORIGINATED&&!k.has_email_participant&&!k.read_only&&(k.recipients_loadable||k.recipients_loadable===(void 0)));},getMuteSetting:function(k){return (k.mute_settings&&k.mute_settings[j(g.getID())]);},isMuted:function(k){return i.getMuteSetting(k)!==(void 0);}};function j(k){return k+'@facebook.com';}e.exports=i;},null);
__d("MercuryMessages",["BanzaiODS","EventEmitter","ImmutableObject","LogHistory","Map","MercuryActionStatus","MercuryActionType","MercuryAssert","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySingletonMixin","MercuryMessageActions","MercuryMessageIDs","RangedCallbackManager","MercurySendMessageFields","MercuryServerRequests","MercuryThreadActions","MercuryThreadInformer","MercuryThreads","URI","copyProperties","invariant","isMessengerDotComURI","mergeDeep"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){b.__markCompiled&&b.__markCompiled();'use strict';var fa=new h(),ga=j.getInstance('mercury_messages');function ha(qa,ra){var sa=ra;if(qa._localIdsMap[ra])sa=qa._localIdsMap[ra];return qa._messages.get(sa);}function ia(qa){switch(qa){case q.UNKNOWN:case q.SERVER_INITIAL_DATA:case q.SERVER_FETCH_THREAD_INFO:case q.SERVER_THREAD_SYNC:return true;}return false;}function ja(qa,ra){if(!qa._threadsToMessages[ra])qa._threadsToMessages[ra]=new u(function(sa){return ha(qa,sa).timestamp;},function(sa,ta){return ta-sa;});return qa._threadsToMessages[ra];}function ka(qa,ra,sa){ra.forEach(function(ta){var ua=ja(qa,ta);ua.setReachedEndOfArray();qa._emitReorderedChange(ta,sa);});}function la(qa){this._fbid=qa;this._messageActions=s.getForFBID(this._fbid);this._serverRequests=w.getForFBID(this._fbid);this._threadInformer=y.getForFBID(this._fbid);this._threads=z.getForFBID(this._fbid);this._threadActions=x.getForFBID(this._fbid);this._didChange=false;this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new k();this._localIdsMap={};this._serverRequests.subscribe('update-messages',function(ra,sa){var ta=(sa.actions||[]).filter(function(va){var wa=va.action_type,xa=((va.is_forward||va.thread_id)&&(wa==m.LOG_MESSAGE||wa==m.USER_GENERATED_MESSAGE||wa==m.SEND_MESSAGE||wa==m.DELETE_THREAD||wa==m.DELETE_MESSAGES||wa==m.MARK_MESSAGES_SPAM)),ya=((va.upload_id&&va.upload_data)&&(wa==m.CANCEL_ATTACHMENT_PLACEHOLDER||wa==m.CONFIRM_ATTACHMENT_PLACEHOLDER));return xa||ya;}),ua=ia(sa.payload_source);this.handleUpdates(ta,ua,sa.payload_source,sa.from_client);if(sa.end_of_history)ka(this,sa.end_of_history,sa.payload_source);if(this._didChange){this._didChange=false;fa.emit('change');}}.bind(this));ga.debug('constructed',{fbid:this._fbid});}ba(la.prototype,{getMessagesFromIDs:function(qa){return (qa||[]).map(ha.bind(null,this)).filter(function(ra){return ra;});},hasLoadedNMessages:function(qa,ra){var sa=ja(this,qa);return sa.hasReachedEndOfArray()||sa.getCurrentArraySize()>=ra;},hasLoadedExactlyNMessages:function(qa,ra){var sa=ja(this,qa);return sa.getCurrentArraySize()==ra;},clearMercuryInternalState_DO_NOT_USE:function(){this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new k();this._localIdsMap={};},getThreadMessagesRange:function(qa,ra,sa,ta,ua,va){var wa=ja(this,qa),xa=function(hb){ta(ma(this,hb));}.bind(this),ya=wa.executeOrEnqueue(ra,sa,xa),za=wa.getUnavailableResources(ya),ab=this._failedHistoryFetchThreads[qa];if(za.length&&!ab){var bb=wa.getCurrentArraySize(),cb=this._localTitanMessagesCount[qa]||0,db=bb-cb,eb=za.length+cb,fb=this.getCurrentlyLoadedMessages(qa),gb=fb.length?fb[0].timestamp:0;ga.debug('fetch_missing_messages',{threadID:qa,offset:ra,limit:sa,timestamp:gb,missingIndices:za,messageCount:bb,localMessageCount:cb});this._serverRequests.fetchThreadMessages(qa,db,eb,gb,ua,va);}else this._failedHistoryFetchThreads[qa]=false;return ya;},getThreadMessagesRangeNow:function(qa,ra,sa){var ta=ja(this,qa),ua=[];for(var va=ra;va<ra+sa;va++){var wa=ta.getResourceAtIndex(va),xa=ha(this,wa);xa&&ua.push(xa);}return ua;},getThreadMessagesSinceTimestamp:function(qa,ra){var sa=ja(this,qa),ta=sa.getElementsUntil(ra);return ma(this,ta);},hasLoadedAllMessages:function(qa){return ja(this,qa).hasReachedEndOfArray();},getCurrentlyLoadedMessages:function(qa){var ra=ja(this,qa).getAllResources();return ma(this,ra);},unsubscribe:function(qa,ra){n.isThreadID(ra);var sa=ja(this,ra);sa.unsubscribe(qa);},_addNewMessage:function(qa,ra){pa(ra);this._messages.set(qa,new i(ra));},_updateMessage:function(qa,ra,sa){var ta=i.set(ra,sa);this._messages.set(qa,ta);return ta;},_shouldSortOutOfOrderMessages:function(qa,ra,sa){if(qa==q.CLIENT_CHANNEL_MESSAGE){var ta=this.getThreadMessagesSinceTimestamp(ra,sa);if(ta.length>0){g.bumpEntityKey('chat.web','channel.messages_reordered');return true;}}return false;},_preprocessIncomingAction:function(qa,ra){var sa=qa.action_type;if(ra==q.CLIENT_CHANNEL_MESSAGE&&sa==m.USER_GENERATED_MESSAGE&&qa.threading_id&&this._localIdsMap[qa.threading_id]===qa.threading_id){qa.client_message_id=qa.threading_id;qa.status=l.SUCCESS;qa.action_type=m.SEND_MESSAGE;sa=qa.action_type;}if(ra===q.CLIENT_CHANNEL_MESSAGE&&sa==m.USER_GENERATED_MESSAGE){var ta=this._threads.getThreadMetaNow(qa.thread_id);if(ta&&ta.folder)qa.folder=ta.folder;}return qa;},handleUpdates:function(qa,ra,sa,ta){var ua,va={},wa={};for(var xa=0;xa<qa.length;xa++){var ya=this._preprocessIncomingAction(qa[xa],sa),za=ya.action_type,ab=ha(this,ya.message_id);if(ya.is_forward||sa==q.SERVER_SEARCH){if(!this._messages.has(ya.message_id))this._addNewMessage(ya.message_id,ya);continue;}else if(ya.client_state===p.SEND_TO_SERVER){this._addNewMessage(ya.message_id,ya);continue;}else if(za==m.SEND_MESSAGE){var bb=ya.client_message_id;if(bb&&this._localIdsMap[bb]&&ya.status){var cb=ha(this,bb),db=cb.status;if(cb.status==l.SUCCESS)continue;if(ya.status==l.UNCONFIRMED){if(!wa[ya.thread_id])wa[ya.thread_id]=[];wa[ya.thread_id].push(bb);}else if(!va[ya.thread_id])va[ya.thread_id]=[];this._updateLocalMessage(ya);if(typeof db!==(void 0)||ya.status==l.FAILED_UNKNOWN_REASON||ya.status==l.UNABLE_TO_CONFIRM||ya.status==l.SUCCESS||ya.status==l.ERROR)this._emitUpdatedChange(ya.thread_id,ha(this,bb).message_id,sa);}continue;}else if(za==m.DELETE_THREAD){ja(this,ya.thread_id).removeAllResources();continue;}else if(za==m.DELETE_MESSAGES){this._deleteMessages(ya.thread_id,ya.message_ids,sa);continue;}else if(za===m.MARK_MESSAGES_SPAM){this._markMessagesSpam(ya,sa);continue;}else if((ya.threading_id&&this._localIdsMap[ya.threading_id])||(ab&&!ab.is_forward)){if(ab&&ya.ranges&&ya.ranges.length>0){var eb=ab.message_id;this._updateMessage(this._localIdsMap[eb]||eb,ab,{ranges:qa.ranges});this._emitUpdatedChange(ab.thread_id,ab.message_id,'link_shim');}continue;}else if(za===m.CONFIRM_ATTACHMENT_PLACEHOLDER){this._confirmAttachmentPlaceholder(ya.upload_id,ya.upload_data);continue;}else if(za===m.CANCEL_ATTACHMENT_PLACEHOLDER){this._cancelAttachmentPlaceholder(ya.upload_id,ya.upload_data);continue;}else{if(sa===q.CLIENT_SEND_MESSAGE){this._localIdsMap[ya.message_id]=ya.message_id;if(ya.thread_id=='root:'+ya.message_id)ja(this,ya.thread_id).setReachedEndOfArray();}if(za==m.LOG_MESSAGE&&ya.log_message_type==o.SERVER_ERROR)this._failedHistoryFetchThreads[ya.thread_id]=true;if(ya.client_state===p.DO_NOT_SEND_TO_SERVER&&ya.upload_id)this._uploadMessages[ya.upload_id]=ya;if(!va[ya.thread_id])va[ya.thread_id]=[];va[ya.thread_id].push(ya.message_id);this._addNewMessage(ya.message_id,ya);if(ya.threading_id&&ya.threading_id!=ya.message_id)t.addServerID(ya.threading_id,ya.message_id);if(ya[v.MANUAL_RETRY_CNT]>0){ua=ja(this,ya.thread_id);ua.resortResources([ya.message_id]);this._emitReorderedChange(ya.thread_id,q.CLIENT_SEND_MESSAGE);}ra=ra||this._shouldSortOutOfOrderMessages(sa,ya.thread_id,ya.timestamp);if(!ra)this._emitReceivedChange(ha(this,ya.message_id));continue;}}for(var fb in va){ua=ja(this,fb);var gb=ua.getAllResources(),hb=gb.filter(function(jb){var kb=this._messages.get(jb);return kb.action_type==m.LOG_MESSAGE&&kb.log_message_type==o.SERVER_ERROR;}.bind(this));ua.removeResources(hb);if(ta)na(this,fb,va[fb]);if(ra){ua.addResources(va[fb]);this._emitReorderedChange(fb,sa);}else ua.addResourcesWithoutSorting(va[fb].reverse(),0);this._threadInformer.updatedThread(fb);}var ib=Object.keys(wa);if(ib.length)this._serverRequests.requestMessageConfirmation(wa);this._didChange&&ga.debug('handle_updates',{localMessageCounts:ea(this._localTitanMessagesCount)});},isFirstMessage:function(qa){var ra=ja(this,qa.thread_id);if(ra.getCurrentArraySize()===0)return false;var sa=ra.getResourceAtIndex(ra.getCurrentArraySize()-1),ta=ha(this,sa).message_id,ua=ha(this,qa.message_id).message_id;return ra.hasReachedEndOfArray()&&ta==ua;},_markMessagesSpam:function(qa,ra){var sa=qa,ta=sa.thread_id,ua=sa.message_ids;if(!ua.length)return;this._deleteIndividualMessages(ta,ua,ra);this._serverRequests.markMessagesSpam(ta,ua);},_deleteMessages:function(qa,ra,sa){if(!ra.length)return;this._deleteIndividualMessages(qa,ra,sa);if(sa!==q.CLIENT_CHANNEL_MESSAGE)this._serverRequests.deleteMessages(qa,ra);},_deleteIndividualMessages:function(qa,ra,sa){var ta=ra.map(function(va){return ha(this,va).message_id;},this),ua=ja(this,qa);ua.removeResources(ta);this._emitReorderedChange(qa,sa);},_updateLocalMessage:function(qa){var ra=ha(this,qa.client_message_id),sa={};sa.status=qa.status;if(qa.status===l.SUCCESS||qa.error_data)sa.error_data=qa.error_data;var ta=qa.message_id,ua=qa.client_message_id;if(this._messages.has(ta)){this._updateMessage(ta,ra,sa);return false;}if(qa.timestamp)sa.timestamp=qa.timestamp;if(qa.log_message_data)sa.log_message_data=qa.log_message_data;if(qa.ranges&&qa.ranges.length){pa(qa);sa.ranges=qa.ranges;}if(qa.attachments&&qa.attachments.length){sa.raw_attachments=null;sa.attachments=qa.attachments;}this._localIdsMap[ua]=ta;t.addServerID(ua,ta);var va=this._updateMessage(ta,ra,sa);this._messages.set(ua,new i());if(oa(va))this._localTitanMessagesCount[va.thread_id]--;return true;},getNumberLocalMessages:function(qa){return this._localTitanMessagesCount[qa]||0;},_uploadMessages:{},_confirmAttachmentPlaceholder:function(qa,ra){var sa=this._popPendingAttachmentMessage(qa,ra);this._serverRequests.sendNewMessage(sa);},_cancelAttachmentPlaceholder:function(qa,ra){var sa=this._popPendingAttachmentMessage(qa,ra);this._deleteIndividualMessages(sa.thread_id,[sa.message_id]);if(this._localTitanMessagesCount[sa.thread_id])this._localTitanMessagesCount[sa.thread_id]--;},_popPendingAttachmentMessage:function(qa,ra){var sa=this._uploadMessages[qa];ca(sa);sa.image_ids=ra.image_ids;sa.file_ids=ra.file_ids;sa.audio_ids=ra.audio_ids;sa.gif_ids=ra.gif_ids;sa.client_state=p.SEND_TO_SERVER;delete this._uploadMessages[qa];return sa;},_emitUpdatedChange:function(qa,ra,sa){this._didChange=true;this._threadInformer.updatedMessage(qa,ra,sa);},_emitReceivedChange:function(qa){this._didChange=true;this._threadInformer.receivedMessage(qa);},_emitReorderedChange:function(qa,ra){this._didChange=true;this._threadInformer.reorderedMessages(qa,ra);}});Object.assign(la,r,{addListener:function(qa,ra){return fa.addListener(qa,ra);}});function ma(qa,ra){var sa=ra.map(ha.bind(null,qa));return sa.reverse();}function na(qa,ra,sa){var ta=sa.filter(function(ua){return oa(ha(qa,ua));});if(!qa._localTitanMessagesCount[ra])qa._localTitanMessagesCount[ra]=0;qa._localTitanMessagesCount[ra]+=ta.length;}function oa(qa){var ra=qa.action_type;if(ra==m.USER_GENERATED_MESSAGE)return true;switch(qa.log_message_type){case o.SUBSCRIBE:case o.UNSUBSCRIBE:case o.SERVER_ERROR:case o.LIVE_LISTEN:return false;default:return true;}}function pa(qa){if(!qa.ranges)return;qa.ranges.forEach(function(ra){if(!ra.entity||ra.entity.external||!ra.entity.url)return;var sa=new aa(ra.entity.url);if(da(aa.getRequestURI())&&!sa.getDomain()){sa.setProtocol('https').setDomain('www.facebook.com');ra.entity.url=sa.toString();}});}e.exports=la;},null);
__d("MercuryChannelHandler",["Arbiter","ChannelConstants","MercuryActionType","MercuryGlobalActionType","MercuryMessages","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin","MercuryThreadInformer","MercuryViewer","MessagingEvent","MessagingReliabilityLogger","MessagingTag","PresenceUtil","copyProperties","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=v(n);for(var x in w)if(w.hasOwnProperty(x))z[x]=w[x];var y=w===null?null:w.prototype;z.prototype=Object.create(y);z.prototype.constructor=z;z.__superConstructor__=w;function z(aa){"use strict";this.$MercuryChannelHandler0=aa;this.__serverRequests=m.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler1=o.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler2=k.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler3=[];}z.prototype.getInstanceFBID=function(){"use strict";return this.$MercuryChannelHandler0;};z.prototype.$MercuryChannelHandler4=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!ba.obj.message){r.addEntry('channel_receive','invalid_data');return;}var ca=ba.obj.message,da=ca.other_user_fbid?ca.other_user_fbid:ca.thread_fbid,ea={author:ca.mercury_author_id,author_email:ca.mercury_author_email,body:ca.body,subject:ca.subject,has_attachment:ca.has_attachment,attachments:ca.attachments,html_body:ca.html_body,thread_id:ca.tid,thread_fbid:ca.thread_fbid,other_user_fbid:ca.other_user_fbid,message_id:ca.mid,coordinates:ca.mercury_coordinates,is_spoof_warning:ca.is_spoof_warning,ranges:ca.ranges,source:ca.mercury_source,source_tags:ca.mercury_source_tags,threading_id:ca.threading_id,timestamp:ca.timestamp,timestamp_absolute:ca.timestamp_absolute,timestamp_relative:ca.timestamp_relative,timestamp_time_passed:ca.timestamp_time_passed,action_type:i.USER_GENERATED_MESSAGE,is_unread:ca.is_unread,is_forward:false,forward_count:ca.forward_count||ca.forward,forward_message_ids:ca.forward_msg_ids,location_text:ca.location_text,folder:ba.obj.folder};if("sync_id" in ca){ea.sync_id=ca.sync_id;}else ea.action_id=ca.action_id;var fa=[u({},ea)];fa=fa.concat(ca.forward_actions||[]);var ga=l.CLIENT_CHANNEL_MESSAGE;this.__serverRequests.handleUpdateWaitForThread({actions:fa,payload_source:ga},da);if(!ca.is_unread&&p.isViewer(ca.mercury_author_id)){var ha={};ha[da]=ba.obj.folder;this.$MercuryChannelHandler6(this.__getMessagingPayloadType(),{obj:{event:q.READ,thread_fbids:ca.thread_fbid?[ca.thread_fbid]:[],other_user_fbids:ca.other_user_fbid?[ca.other_user_fbid]:[],folder_info:ha,timestamp:ca.timestamp}});}r.addEntry('channel_receive','success',[da,ea.message_id,t.getSessionID()]);};z.prototype.$MercuryChannelHandler6=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=[],da=ba.obj.event==q.READ;(ba.obj.thread_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,thread_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});(ba.obj.other_user_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,other_user_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});this.__serverRequests.handleUpdate({actions:ca,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler7=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!(ba.obj.thread_fbids||ba.obj.other_user_fbids))return;var ca=[];(ba.obj.thread_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,thread_fbid:da});});(ba.obj.other_user_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,other_user_fbid:da});});this.__serverRequests.handleUpdate({actions:ca,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler8=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids)||!ba.obj.mids)return;var ca=ba.obj.thread_fbids.length?ba.obj.thread_fbids[0]:null,da=ba.obj.other_user_fbids.length?ba.obj.other_user_fbids[0]:null,ea={action_type:i.DELETE_MESSAGES,action_id:null,thread_fbid:ca,other_user_fbid:da,message_ids:ba.obj.mids};this.__serverRequests.handleUpdate({actions:[ea],threads:[ba.obj.updated_thread],payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler9=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!ba.obj.folder)return;var ca={action_type:j.MARK_ALL_READ,action_id:ba.obj.action_id,folder:ba.obj.folder};this.__serverRequests.handleUpdate({global_actions:[ca]});};z.prototype.$MercuryChannelHandlera=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=l.CLIENT_CHANNEL_MESSAGE;(ba.obj.thread_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:da,other_user_fbid:null,archived:ba.obj.state};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ca},da);},this);(ba.obj.other_user_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:null,other_user_fbid:da,archived:ba.obj.state};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ca},da);},this);};z.prototype.$MercuryChannelHandlerb=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=l.CLIENT_CHANNEL_MESSAGE,da;(ba.obj.thread_fbids||[]).forEach(function(ea){if(ba.obj.event==q.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?s.SPAM:s.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,thread_fbid:ea,other_user_fbid:null,new_folder:da};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},fa)],payload_source:ca},ea);},this);(ba.obj.other_user_fbids||[]).forEach(function(ea){if(ba.obj.event==q.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?s.SPAM:s.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,other_user_fbid:ea,thread_fbid:null,new_folder:da};this.__serverRequests.handleUpdateWaitForThread({actions:[u({},fa)],payload_source:ca},ea);},this);};z.prototype.$MercuryChannelHandlerc=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj.tag)return;switch(ba.obj.tag){case s.ACTION_ARCHIVED:this.$MercuryChannelHandlera(aa,ba);break;case s.INBOX:case s.OTHER:this.$MercuryChannelHandlerb(aa,ba);break;}};z.prototype.__markAsSeen=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlerd(aa)||!ba.obj||!ba.obj.seen_timestamp)return;this.__serverRequests.handleUpdate({message_counts:[{seen_timestamp:ba.obj.seen_timestamp,folder:s.INBOX}],unseen_thread_fbids:[{thread_fbids:[],other_user_fbids:[],folder:s.INBOX}],payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.__updateModelsFromMercuryPayload=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlere(aa)||!ba.obj)return;this.$MercuryChannelHandler1.synchronizeInforms(function(){var ca=ba.obj,da=[];(ca.actions||[]).forEach(function(ea){var fa=i.USER_GENERATED_MESSAGE;if(ea.action_type==i.LOG_MESSAGE){var ga=l.CLIENT_CHANNEL_MESSAGE,ha;ha=ea.other_user_fbid||ea.thread_fbid;this.__serverRequests.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ga},ha);}else if(ea.action_type!=fa)da.push(ea);},this);ca.actions=da;ca.payload_source=l.CLIENT_CHANNEL_MESSAGE;this.__serverRequests.handleUpdate(ca);}.bind(this));};z.prototype.$MercuryChannelHandlerf=function(aa,ba){"use strict";this.__serverRequests.handleRoger(ba.obj);};z.prototype.$MercuryChannelHandlerg=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||ba.obj.mute_settings===(void 0)||(!ba.obj.thread_fbid&&!ba.obj.other_user_fbid))return;var ca=i.CHANGE_MUTE_SETTINGS,da=[{action_type:ca,action_id:null,thread_fbid:ba.obj.thread_fbid,other_user_fbid:ba.obj.other_user_fbid,mute_settings:ba.obj.mute_settings}];this.__serverRequests.handleUpdate({actions:da,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.__handleMessagingPayload=function(aa,ba){"use strict";switch(ba.obj.event){case q.DELIVER:this.$MercuryChannelHandler4(aa,ba);break;case q.READ:case q.UNREAD:this.$MercuryChannelHandler6(aa,ba);break;case q.READ_ALL:this.$MercuryChannelHandler9(aa,ba);break;case q.DELETE:this.$MercuryChannelHandler7(aa,ba);break;case q.DELETE_MESSAGES:this.$MercuryChannelHandler8(aa,ba);break;case q.TAG:this.$MercuryChannelHandlerc(aa,ba);break;case q.REPORT_SPAM:this.$MercuryChannelHandlerb(aa,ba);break;case q.READ_RECEIPT:this.$MercuryChannelHandlerf(aa,ba);break;case q.CHANGE_MUTE_SETTINGS:this.$MercuryChannelHandlerg(aa,ba);break;}};z.prototype.getRouting=function(){"use strict";return {mercury:this.__updateModelsFromMercuryPayload,messaging:this.__handleMessagingPayload,inbox:this.__markAsSeen};};z.prototype.__getMessagingPayloadType=function(){"use strict";return h.getArbiterType('messaging');};z.prototype.__getMercuryPayloadType=function(){"use strict";return h.getArbiterType('mercury');};z.prototype.__getInboxPayloadType=function(){"use strict";return h.getArbiterType('inbox');};z.prototype.$MercuryChannelHandler5=function(aa){"use strict";return (aa==this.__getMessagingPayloadType());};z.prototype.$MercuryChannelHandlere=function(aa){"use strict";return (aa==this.__getMercuryPayloadType());};z.prototype.$MercuryChannelHandlerd=function(aa){"use strict";return (aa==this.__getInboxPayloadType());};z.prototype.turnOn=function(){"use strict";if(!this.$MercuryChannelHandler3.length){var aa=this.getRouting();for(var ba in aa)this.$MercuryChannelHandler3.push(g.subscribe(h.getArbiterType(ba),aa[ba].bind(this)));}return this;};z.prototype.turnOff=function(){"use strict";if(this.$MercuryChannelHandler3.length){this.$MercuryChannelHandler3.forEach(g.unsubscribe);this.$MercuryChannelHandler3=[];}return this;};u(z,n);e.exports=z;},null);
__d("MercuryRoger",["Arbiter","ArbiterMixin","immutable","JSLogger","MercuryActionStatus","MercuryServerRequests","MercurySingletonMixin","MercuryThreads","mixin","mapObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=k.SUCCESS,r=o(h);for(var s in r)if(r.hasOwnProperty(s))u[s]=r[s];var t=r===null?null:r.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=r;function u(x){"use strict";this.$MercuryRoger0={};this.$MercuryRoger1=[];this.$MercuryRoger2=x;this.$MercuryRoger3=l.getForFBID(this.$MercuryRoger2);this.$MercuryRoger4=n.getForFBID(this.$MercuryRoger2);this.$MercuryRoger3.subscribe('update-roger',function(y,z){for(var aa in z){var ba=this.$MercuryRoger0[aa]||i.OrderedMap();ba=ba.withMutations(function(ca){for(var da in z[aa]){var ea=this.$MercuryRoger4.getThreadMetaNow(aa);if(ea&&ea.participants)if(ea.participants.indexOf(da)==-1){this.$MercuryRoger0.push(w(this.$MercuryRoger0));continue;}var fa=ca.get(da),ga=z[aa][da];if(!fa||ga>fa)ca.set(da,ga);}}.bind(this));this.$MercuryRoger0[aa]=ba.sort();}z&&this.inform('change',z);}.bind(this));g.subscribe(j.DUMP_EVENT,function(y,z){z.bad_read_receipts={receipts:this.$MercuryRoger1};}.bind(this));}u.prototype.getSeenBy=function(x,y){"use strict";if(!x)return [];var z=[],aa=this.$MercuryRoger0[x.thread_id];if(!aa)return z;aa.forEach(function(ba,ca){if(v(x,ba,ca,y))z.push(ca);});return z;};u.prototype.wasSeenByAll=function(x){"use strict";if(!x)return false;var y=this.$MercuryRoger0[x.thread_id];if(!y)return false;return y.every(function(z,aa){return v(x,z,aa);});};u.prototype.getSeenTimestamps=function(x){"use strict";var y=this.$MercuryRoger0[x];if(!y){y=i.OrderedMap();this.$MercuryRoger0[x]=y;}return y;};u.prototype.getSeenTimestamp=function(x,y){"use strict";var z=this.$MercuryRoger0[x];return z?z.get(y):null;};Object.assign(u,m);function v(x,y,z,aa){return !!(y>x.timestamp&&(x.status===(void 0)||x.status===q)&&(!aa||z!=x.author));}function w(x){return p(x,function(y){return y.toJS();});}e.exports=u;},null);
__d("MercuryDelayedRoger",["ArbiterMixin","LiveTimer","MercuryActionStatus","MercuryConfig","setTimeoutAcrossTransitions","MercuryMessages","MercuryRoger","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=b('MercuryMessages').get(),m=b('MercuryRoger').get(),n=b('MercuryThreadInformer').get(),o=b('MercuryThreads').get(),p={},q={},r=j['roger.seen_delay'],s={getSeenBy:function(y,z){if(q[y])return [];return m.getSeenBy(t(y),z);},wasSeenByAll:function(y){if(q[y])return false;return m.wasSeenByAll(t(y));}};Object.assign(s,g);function t(y){if(!p[y]){var z=o.getThreadMetaNow(y);if(z)p[y]={thread_id:y,author:z.participants[0],timestamp:z.timestamp};}return p[y];}function u(y){var z=false;l.getThreadMessagesRange(y,0,1,function(aa){var ba=aa[0];if(!ba)return;var ca=ba.timestamp;if(ba.action_id||ba.status==i.SUCCESS)ca-=h.getServerTimeOffset();var da=s.getSeenBy(y);if(q[y]){clearTimeout(q[y]);delete q[y];}var ea=ca+r,fa=ea-Date.now();if(fa>0)q[y]=k(function(){delete q[y];v(y);},fa);p[y]=ba;var ga=s.getSeenBy(y);if(da.length||ga.length)z=true;});return z;}function v(y){var z={};z[y]=true;w(z);}function w(y){s.inform('state-changed',y);s.inform('change');}function x(event,y){var z={};for(var aa in y)if(u(aa))z[aa]=true;for(var ba in z){w(z);break;}}m.subscribe('change',function(y,z){for(var aa in z)!q[aa]&&v(aa);});n.subscribe('messages-received',x);n.subscribe('messages-reordered',x);n.subscribe('messages-updated',x);e.exports=s;},null);
__d("MercuryUnseenState",["MercuryFolders","KeyedCallbackManager","LogHistory","MercuryActionType","MercurySingletonMixin","MercuryThreadInfo","MercuryThreadlistConstants","MercuryThreadIDMap","MessagingTag","MercuryServerRequests","MercuryThreadInformer","MercuryThreads","copyProperties","createObjectFrom","isEmpty"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=m.MAX_UNSEEN_COUNT,w='unseen_thread_hash',x='unseen_thread_list',y=i.getInstance('mercury_unseen_state');function z(oa){this._fbid=oa;this._serverRequests=p.getForFBID(this._fbid);this._threadIDMap=n.getForFBID(this._fbid);this._threads=r.getForFBID(this._fbid);this._threadInformer=q.getForFBID(this._fbid);this._initialUnseenCount=null;this._lastSeenTimestamp=0;this._maxCount=false;this._pendingServerUpdates=false;this._unseenResources=new h();this._serverRequests.subscribe('update-unseen',function(pa,qa){fa(this,qa);}.bind(this));this._serverRequests.subscribe('update-thread-ids',function(pa,qa){la(this,qa);}.bind(this));}s(z.prototype,{getUnseenCount:function(){if(this.exceedsMaxCount()){y.error('unguarded_unseen_count_fetch',{});return 0;}return ea(this)||0;},exceedsMaxCount:function(){return this._maxCount||(ea(this)>v);},markAsSeen:function(){var oa=ea(this);if(oa===null){this._pendingServerUpdates=true;}else if(oa>0||this._maxCount){this._serverRequests.markSeen();var pa=this._serverRequests.getLastActionTimestamp();ga(this,pa,[]);}}});s(z,k);function aa(oa,pa,qa){var ra={};ra[pa]=0;ia(oa,ra,qa);}function ba(oa,pa){oa._unseenResources.setResource(w,pa);oa._unseenResources.setResource(x,Object.keys(pa));}function ca(oa,pa){var qa=oa._unseenResources.executeOrEnqueue(w,pa),ra=oa._unseenResources.getUnavailableResources(qa);if(ra.length)oa._serverRequests.fetchUnseenThreadIDs();}function da(oa){return oa._unseenResources.getResource(w);}function ea(oa){var pa=oa._unseenResources.getResource(x);if(pa){return pa.length;}else return oa._initialUnseenCount;}function fa(oa,pa){var qa=na(pa);if(pa.unseen_thread_fbids){pa.unseen_thread_fbids.forEach(function(bb){if(bb.folder!=o.INBOX)return;var cb=bb.thread_fbids||[];cb=cb.concat(bb.other_user_fbids||[]);var db=ka(oa,cb),eb=oa._lastSeenTimestamp;if(qa&&qa.seen_timestamp)eb=qa.seen_timestamp;ga(oa,eb,db);if(qa&&qa.unseen_count>v)oa._maxCount=true;});}else if(qa&&qa.seen_timestamp){oa._lastSeenTimestamp=qa.seen_timestamp;if(qa.unseen_count>v){oa._maxCount=true;ba(oa,{});}else{oa._initialUnseenCount=qa.unseen_count;if(oa._initialUnseenCount===0)ba(oa,{});}}else{if(oa._maxCount)return;var ra=pa.actions;if(!ra||!(ra.length))return;var sa={},ta={};for(var ua=0;ua<ra.length;ua++){var va=ra[ua];if(va.is_forward)continue;var wa=va.action_type,xa=va.other_user_fbid?va.other_user_fbid:va.thread_fbid,ya=va.thread_id?va.thread_id:xa;if(wa==j.MARK_THREAD_SEEN){aa(oa,ya,va.persistent);continue;}if(!ma(oa,va))continue;if(wa==j.USER_GENERATED_MESSAGE||wa==j.LOG_MESSAGE){var za=sa[ya]?va.timestamp>sa[ya]:false,ab=za||!sa[ya];if(va.is_unread&&ab)oa._threads.getThreadMeta(ya,function(bb){var cb=false;if(bb&&bb.last_read_timestamp)if(bb.last_read_timestamp>=va.timestamp)cb=true;if(!l.isMuted(bb)&&!cb)sa[ya]=va.timestamp;});}else if(wa==j.CHANGE_READ_STATUS&&va.mark_as_read)ta[ya]=va.timestamp;}ha(oa,sa);ia(oa,ta);}if(oa._pendingServerUpdates){oa._pendingServerUpdates=false;oa.markAsSeen();}}function ga(oa,pa,qa){var ra=da(oa);if(ra===(void 0)||pa>oa._lastSeenTimestamp||oa._maxCount){oa._lastSeenTimestamp=pa;qa=qa||[];if(qa.length<=v)oa._maxCount=false;var sa={},ta=da(oa)||{};for(var ua in ta)if(ta[ua]!==true){var va=ta[ua];if(ja(oa,va))sa[ua]=va;}var wa=s(t(qa,true),sa);ba(oa,wa);oa._threadInformer.updatedUnseenState();}}function ha(oa,pa){if(oa._maxCount)return;var qa={},ra=false;for(var sa in pa){var ta=pa[sa];if(ja(oa,ta)){qa[sa]=ta;ra=true;}}if(!ra)return;ca(oa,function(ua){for(var va in qa){var wa=qa[va];if(!ua[va]&&ja(oa,wa))ua[va]=qa[va];}ba(oa,ua);oa._threadInformer.updatedUnseenState();});}function ia(oa,pa,qa){var ra=false;if(!u(pa))ra=true;if(ra)ca(oa,function(sa){var ta=false;for(var ua in pa){var va=pa[ua],wa=va>sa[ua];if(sa[ua]&&(!va||wa)){delete sa[ua];ta=true;}}if(ta){ba(oa,sa);oa._threadInformer.updatedUnseenState();if(qa&&ea(oa)===0)oa._serverRequests.markSeen();}});}function ja(oa,pa){return pa>oa._lastSeenTimestamp;}function ka(oa,pa){return pa.map(oa._threadIDMap.convertThreadIDIfAvailable,oa._threadIDMap);}function la(oa,pa){var qa=da(oa);if(!qa)return;for(var ra in pa){var sa=pa[ra];if(qa[ra]){qa[sa]=qa[ra];delete qa[ra];}}ba(oa,qa);}function ma(oa,pa){var qa=pa.thread_id?oa._threads.getThreadMetaNow(pa.thread_id):null,ra=qa?g.getFromMeta(qa):pa.folder;return ra===o.INBOX||ra===(void 0);}function na(oa){var pa=(oa.message_counts||[]);for(var qa=0;qa<pa.length;qa++)if(pa[qa].folder==o.INBOX)return pa[qa];return null;}e.exports=z;},null);
__d("P2PActionConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={CREDIT_CARDS_UPDATED:'credit_cards_updated',CREDIT_CARD_ADDED:'credit_card_added',CREDIT_CARD_ADDED_ERROR:'credit_card_added_error',CREDIT_CARD_DELETED:'credit_card_deleted',CREDIT_CARD_DELETED_ERROR:'credit_card_deleted_error',CREDIT_CARD_UPDATED:'credit_card_updated',CREDIT_CARD_UPDATED_ERROR:'credit_card_updated_error',PRESET_CREDIT_CARD_UPDATED:'preset_credit_card_updated',PRESET_CREDIT_CARD_UPDATED_ERROR:'preset_credit_card_updated_error',CREDIT_CARD_VERIFIED:'credit_card_verified',CREDIT_CARD_VERIFIED_ERROR:'credit_card_verified_error',TRANSFERS_UPDATED:'transfers_updated',TRANSFERS_UPDATED_ERROR:'transfers_updated_error',NUX_TRANSFERS_UPDATED:'nux_transfers_updated',TRANSFER_ADDED:'transfer_added',TRANSFER_ADDED_ERROR:'transfer_added_error',TRANSFER_UPDATED:'transfer_updated',TRANSFER_UPDATED_ERROR:'transfer_updated_error',TRANSFER_ACCEPTED:'transfer_accepted',TRANSFER_DECLINED:'transfer_declined',CHAT_SEND_VIEW_OPENED:'chat_send_view_opened',CHAT_SEND_VIEW_CLOSED:'chat_send_view_closed',BIN_NUMBER_VALIDATED:'bin_number_validated',BIN_NUMBER_VALIDATED_ERROR:'bin_number_validated_error',USER_ELIGIBILITY_UDPATED:'user_eligibility_updated',DIALOG_SHOWN:'dialog_shown',DIALOG_CLOSED:'dialog_closed'};e.exports=g;},null);
__d("P2PDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
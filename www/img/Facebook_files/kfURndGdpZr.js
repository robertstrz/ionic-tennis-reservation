/*!CK:4011210019!*//*1434123762,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["ZV6DN"]); }

__d("HashtagParser",["URLMatcher","getHashtagRegex"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=100,j=30,k=/@\[([0-9]+):([0-9]+):((?:[^\\\]]*(?:\\.)*)*)\]/g;function l(da){var ea=y(da),fa=0,ga=0;return n(da).map(function(ha){while(fa<ea.length){var ia=ea[fa],ja=ia.offset-ga;if(ja<ha.offset){ga+=ia.token.length-ia.name.length;fa++;}else break;}return {marker:ha.marker,tag:ha.hashtag,rawOffset:ha.offset+ga,offset:ha.offset};});}function m(da){return o(da,t(da));}function n(da){var ea=aa(da);return o(ea,p(da,ea));}function o(da,ea){return r(da).slice(0,j).filter(function(fa){var ga=v(fa.offset,fa.hashtag.length,ea);return !ga&&fa.hashtag.length<=i;});}function p(da,ea){return u(s(da),t(ea));}var q=h();function r(da){var ea=[];da.replace(q,function(fa,ga,ha,ia,ja){ea.push({marker:ha,hashtag:ia,offset:ja+ga.length});});return ea;}function s(da){return ba(da).map(function(ea){return [ea.offset,ea.name.length];});}function t(da){var ea=[],fa,ga=0;while((fa=g.permissiveMatch(da))){var ha=da.indexOf(fa);ea.push([ga+ha,fa.length]);da=da.substring(ha+fa.length);ga+=ha+fa.length;}return ea;}function u(da,ea){var fa=[],ga=0,ha=0,ia=0;while(ga<da.length&&ha<ea.length)if(da[ga][0]>ea[ha][0]){fa[ia++]=ea[ha++];}else fa[ia++]=da[ga++];return fa.concat(da.slice(ga),ea.slice(ha));}function v(da,ea,fa){if(!fa)return false;var ga=x(fa,da);return w(da,ea,fa,ga)||w(da,ea,fa,ga+1);}function w(da,ea,fa,ga){if(!fa[ga])return false;var ha=fa[ga][0],ia=fa[ga][1];return !((da+ea-1<ha)||(da>ha+ia-1));}function x(da,ea){var fa=0,ga=da.length-1;while(fa<=ga){var ha=Math.floor((fa+ga)/2),ia=da[ha][0];if(ia==ea){return ha;}else if(ia<ea){fa=ha+1;}else ga=ha-1;}return ga;}function y(da){var ea=[];da.replace(k,function(fa,ga,ha,ia,ja){ea.push({token:fa,id:ga,type:ha,name:ia,offset:ja});});return ea;}function z(da){return da?da.replace(/\\([^\\])/g,'$1').replace(/\\\\/g,'\\'):null;}function aa(da){return da.replace(k,function(ea,fa,ga,ha,ia){return z(ha);});}function ba(da){var ea=0,fa=0;return y(da).map(function(ga){var ha=da.indexOf(ga.token,fa);fa=ha+1;ha-=ea;var ia=z(ga.name);ea+=ga.token.length-ia.length;if(ha>=0)return {id:ga.id,name:ia,type:ga.type,offset:ha};});}var ca={};ca.parse=l;ca.parseWithoutMentions=m;e.exports=ca;},null);
__d("FacebarResultStoreUtils",["FacebarGlobalOptions"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={getQueryFeatures:function(i){var j={};if(g.enableBootstrapRanking){if(i.raw_text)j.FEATURE_QUERY_LENGTH=i.raw_text.length;if(i.tokens){j.FEATURE_QUERY_TOKENS=i.tokens.length;j.FEATURE_QUERY_TOKEN_LENGTH_SUM=0;for(var k=0;k<i.tokens.length;k++)j.FEATURE_QUERY_TOKEN_LENGTH_SUM+=i.tokens[k].length;}}return j;},addFeatures:function(i,j,k,l,m,n){if(!i.features)return;i.features={FEATURE_QUERY_LENGTH:l.FEATURE_QUERY_LENGTH,FEATURE_QUERY_TOKENS:l.FEATURE_QUERY_TOKENS,FEATURE_QUERY_TOKEN_LENGTH_SUM:l.FEATURE_QUERY_TOKEN_LENGTH_SUM};i.features.FEATURE_IS_EXACT_NAME_MATCH=m;i.features.FEATURE_IS_STOP_WORD_MATCH=n;if(j&&j.length>0){var o=j.split(' ').length,p=0;for(var q=0;q<i.termMatches.length;++q)if(j.search(i.termMatches[q])>=0)p++;i.features.FEATURE_TITLE_TOKEN_MATCH_FRACTION=p/o;}if(k.tokens&&k.tokens.length>0){var r=j.search(k.tokens[0]);i.features.FEATURE_FIRST_TERM_MATCH_POSITION=r;i.features.FEATURE_FIRST_TERM_MATCH_TOKEN=j.substring(0,r+k.tokens[0].length).split(' ').length;i.termMatches.some(function(s){if(s.search(k.tokens[0])===0){i.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=k.tokens[0].length/s.length;return true;}return false;});i.features.FEATURE_IN_ORDER_MATCH=1;if(k.tokens.length>1){r=j.search(k.tokens[1]);i.features.FEATURE_SECOND_TERM_MATCH_POSITION=r;i.features.FEATURE_SECOND_TERM_MATCH_TOKEN=j.substring(0,r+k.tokens[1].length).split(' ').length;i.termMatches.some(function(s){if(s.search(k.tokens[1])===0){i.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=k.tokens[0].length/s.length;return true;}return false;});if(i.features.FEATURE_SECOND_TERM_MATCH_TOKEN<i.features.FEATURE_FIRST_TERM_MATCH_POSITION)i.features.FEATURE_IN_ORDER_MATCH=0;}}return i;},processEntityResult:function(i,j,k,l,m,n,o,p,q){var r={semantic:j.toString(),structure:[{type:'ent:'+i,text:k,uid:j}],type:i,cost:l,cache_id_length:0,features:[]};r.tuid=JSON.stringify({semantic:r.semantic,structure:r.structure});if(g.enableBootstrapRanking){r.termMatches=o[j.toString()];r=this.addFeatures(r,k.toLowerCase(),m,n,p,q);}return r;},getRawTextFromStructured:function(i){var j=i.map(function(k){return k.getText();});return j.join('');},getTextFromResult:function(i){var j=i.structure,k='';j.forEach(function(l){k+=l.text;});return k;}};e.exports=h;},null);
__d("HashtagSearchResultUtils",["FacebarResultStoreUtils","HashtagParser","HashtagSearchResultConfig","URI","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={getHashtagFromQuery:function(m){var n=h.parse(m);if(n&&n.length===1&&n[0].offset===0)return n[0].tag;return false;},makeTypeaheadResult:function(m){var n=k._("Znacznik #");return {category:n,path:new j('/hashtag/'+m).toString(),photo:i.image_url,rankType:null,replace_results:i.boost_result?true:false,scaled_score:1,score:0,text:'#'+m,type:'hashtag_exact',uid:'hashtag:'+m};},makeFacebarEntry:function(m){var n=k._("Znacznik #");return {category:n,path:new j('/hashtag/'+m).toString(),photo:i.image_url,replace_results:i.boost_result?true:false,text:'#'+m,type:'hashtag_exact',uid:'hashtag:'+m};},makeFacebarResult:function(m){var n=g.processEntityResult('hashtag_exact','hashtag:'+m,'#'+m,i.hashtag_cost);n.parse={display:[{type:'ent:hashtag_exact',uid:'hashtag:'+m}],remTokens:[],suffix:''};n.tags={hashtag:'hashtag'};return n;}};e.exports=l;},null);
__d("isEmail",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=/^[\w!#\$%&'\*\+\/\=\?\^`\{\|\}~\-]+(:?\.[\w!#\$%&'\*\+\/\=\?\^`\{\|\}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?$/i;function h(i){return g.test(i);}e.exports=h;},null);
__d("SearchSingleState",["fbt"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(j,k,l,m){return {classNames:'grammar',groupIndex:0,indexInGroup:j,path:k,text:l,type:'grammar',uid:m};}var i={getSuggestions:function(j,k,l){if(l==='ent:user'){return this.getSuggestionsForUser(j,k);}else if(l==='ent:page'){return this.getSuggestionsForPage(j,k);}else if(l==='ent:app'){return this.getSuggestionsForApp(j,k);}else if(l==='ent:group')return this.getSuggestionsForGroup(j,k);},getSuggestionsForUser:function(j,k){return [h(0,'/search/'+j+'/photos-of',g._("zdj\u0119cia u\u017cytkownika {full name}",[g.param("full name",k)]),'photos_of_user'),h(1,'/search/'+j+'/friends',g._("znajomi u\u017cytkownika {full name}",[g.param("full name",k)]),'friends_of_user'),h(2,'/search/'+j+'/pages-liked',g._("ulubione strony u\u017cytkownika {full name}",[g.param("full name",k)]),'pages_liked_user'),h(3,'/search/str/'+k+'/users-named',g._("znajd\u017a wszystkich u\u017cytkownik\u00f3w o nazwie \u201e{full name}\u201d",[g.param("full name",k)]),'people_named_text')];},getSuggestionsForPage:function(j,k){return [h(0,'/search/'+j+'/photos-of',g._("zdj\u0119cia strony {name of page}",[g.param("name of page",k)]),'photos_of_page'),h(1,'/search/'+j+'/likers',g._("u\u017cytkownicy, kt\u00f3rzy lubi\u0105 stron\u0119 {name of page}",[g.param("name of page",k)]),'page_likers'),h(2,'/search/str/'+k+'/pages-named',g._("znajd\u017a wszystkie strony o nazwie \u201e{name of page}\u201d",[g.param("name of page",k)]),'pages_named_text')];},getSuggestionsForGroup:function(j,k){return [h(0,'/search/'+j+'/members',g._("Cz\u0142onkowie grupy {name of group}",[g.param("name of group",k)]),'members_of_group'),h(1,'/search/'+j+'/photos-in',g._("zdj\u0119cia w grupie {name of groups}",[g.param("name of groups",k)]),'photos_in_group'),h(2,'/search/'+j+'/creators',g._("Tw\u00f3rcy grupy {name of group}",[g.param("name of group",k)]),'creators_of_group'),h(3,'/search/'+j+'/admins',g._("Administratorzy grupy {name of group}",[g.param("name of group",k)]),'admins_of_group')];},getSuggestionsForApp:function(j,k){return [h(0,'/search/'+j+'/apps-similar-to',g._("aplikacje podobne do {name of app}",[g.param("name of app",k)]),'similar_apps'),h(1,'/search/'+j+'/app-users',g._("u\u017cytkownicy aplikacji {name of app}",[g.param("name of app",k)]),'app_users'),h(2,'/search/str/'+k+'/pages-named',g._("znajd\u017a wszystkie aplikacje o nazwie \u201e{name of page}\u201d",[g.param("name of page",k)]),'apps_named_text')];}};e.exports=i;},null);
__d("SearchDataSource",["Event","Arbiter","AsyncResponse","DataSource","HashtagSearchResultUtils","copyProperties","createArrayFromMixed","PageTransitions","SearchSingleState","UnicodeCJK","debounce","errorCode"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s=100,t='/typeahead/search/facebar/nullstate/';for(var u in j)if(j.hasOwnProperty(u))w[u]=j[u];var v=j===null?null:j.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=j;function w(x){"use strict";this._token=x.token||'';this._lazyonload=x.lazyonload===false?false:true;this._extraTypes=x.extraTypes;this._buckets=x.buckets;this._noMultiFetch=x.noMultiFetch||false;this._nullStateConfig=x.nullStateConfig||{};var y=x.maxResults||8;j.call(this,x);this._numResults={min:3,max:y};this.recordingRoute='non_banzai';this._enabledHashtag=x.enabledHashtag||false;this.logBackendQueriesWindow=x.logBackendQueriesWindow||25;this._genTime=x.genTime;this._bootstrapError=false;this.cacheUnicodeMatch.setConfigs({prefix_hangul_conjoining_jamo:true,prefix_kana_drop_trailing_latin:x.cjkDropLatinInCjTokens,prefix_kana_hiragana_to_katakana:x.cjkUiCacheHiraganaToKatakana});this.backendUnicodeMatch.setConfigs({prefix_kana_drop_trailing_latin:x.cjkDropLatinInCjTokens});}w.prototype.init=function(){"use strict";v.init.call(this);this._leanPayload=null;this._bootstrapRequestsPending=0;this._criticalOnly=true;this._updateMaxResults();var x=q(this._updateMaxResults,s,this,true);g.listen(window,'resize',x);if(this._nullStateConfig.prefetchNullState)this.fetchNullState('');if(this._nullStateConfig.singleState)h.subscribe('page_transition',this.handlePageTransition.bind(this));if(this._nullStateConfig.prefetchNullState||this._nullStateConfig.singleState)h.subscribe('search/updateNullState',this.updateNullState.bind(this));if(this._nullStateConfig.recent)h.subscribe('search/refreshRecentSearchesNullstate',this.refreshRecentSearches.bind(this));};w.prototype.refreshRecentSearches=function(){"use strict";this.nullStateData=null;};w.prototype.handlePageTransition=function(){"use strict";this.nullStateParams={};};w.prototype.updateNullState=function(event,x){"use strict";this.nullStateParams=x;this.fetchNullState();};w.prototype.markResultsAsNullState=function(x){"use strict";var y,z,aa;if(x){var ba;for(y=x,z=Array.isArray(y),aa=0,y=z?y:y[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(z){if(aa>=y.length)break;ba=y[aa++];}else{aa=y.next();if(aa.done)break;ba=aa.value;}ba.isNullState=true;}}};w.prototype.markResultsAsSingleState=function(x){"use strict";var y,z,aa;if(x){var ba;for(y=x,z=Array.isArray(y),aa=0,y=z?y:y[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(z){if(aa>=y.length)break;ba=y[aa++];}else{aa=y.next();if(aa.done)break;ba=aa.value;}ba.isSingleState=true;}}};w.prototype.fetchNullState=function(x){"use strict";this.lastNullOrSingleStateFetchStartTime=Date.now();if(!this._nullStateConfig.hasNullState)return;var y=null;if(this.nullStateParams&&this.nullStateParams.uid){this.nullStateParams.query=x||'';y=this._fetchDataForSingleState();this.markResultsAsNullState(y);}else{y=this._fetchDataForNullState();this.markResultsAsSingleState(y);}if(y)this.inform('respond',{value:this.nullStateParams?this.nullStateParams.query:'',results:y,isAsync:false,nullState:true});};w.prototype._fetchDataForSingleState=function(){"use strict";if(this.nullStateDataWithProfile&&this.nullStateParams.uid===this.nullStateDataWithProfile.profileID)return this.nullStateDataWithProfile.data;if(this.nullStateParams.type==='ent:app'||this.nullStateParams.type==='ent:group'||this.nullStateParams.type==='ent:page'){this.fetch(t,{profile_id:this.nullStateParams.uid,ent_type:this.nullStateParams.type},{singleState:true});this.nullStateDataWithProfile={profileID:this.nullStateParams.uid};return;}var x=o.getSuggestions(this.nullStateParams.uid,this.nullStateParams.text,this.nullStateParams.type);if(!x)return this._fetchDataForNullState();this.nullStateDataWithProfile={data:x,profileID:this.nullStateParams.uid};return x;};w.prototype._shouldRefreshNullState=function(){"use strict";if(!this._nullStateConfig.recent)return false;var x=window.location.href;if(!x)return false;if(x.contains('allactivity')&&x.contains('log_filter=search'))return true;return false;};w.prototype._fetchDataForNullState=function(){"use strict";if(this.nullStateData&&!this._shouldRefreshNullState()){this.markResultsAsNullState(this.nullStateData);setTimeout(function(){this.inform('respond',{value:'',results:this.nullStateData,isAsync:true,nullState:true});}.bind(this),0);return;}if(!this.fetchingNullState){this.fetchingNullState=true;this.fetch(t,{value:""},{nullState:true,value:''});}return null;};w.prototype.dirty=function(){"use strict";v.dirty.call(this);this._bootstrapError=false;this._fetchOnUseRequests=[];};w.prototype.asyncErrorHandler=function(x,y){"use strict";if(y.nullState)this.fetchingNullState=false;if(y.bootstrap)this._bootstrapError=true;this.inform('fetchError',{response:x,fetch_context:y});if(window.Dialog&&window.Dialog.getCurrent()==null&&x.getError()==1400003)i.verboseErrorHandler(x);};w.prototype.fetch=function(x,y,z){"use strict";z=z||{};z.fetch_start=Date.now();var aa=n.getMostRecentURI().path;y=l(y,{path:aa});v.fetch.call(this,x,y,z);};w.prototype.fetchHandler=function(x,y){"use strict";if(y.nullState){this.fetchingNullState=false;this.nullStateData=x.getPayload().entries;this.markResultsAsNullState(this.nullStateData);this.inform('respond',{value:'',results:this.nullStateData,isAsync:true,nullState:true});return;}if(y.singleState){this.nullStateDataWithProfile.data=x.getPayload().entries;this.markResultsAsSingleState(this.nullStateDataWithProfile.data);this.inform('respond',{results:this.nullStateDataWithProfile.data,isAsync:true,value:this.nullStateParams?this.nullStateParams.query:'',nullState:true});return;}var z=x.getPayload(),aa=l({fetch_end:Date.now()},y),ba=aa.value?h.BEHAVIOR_EVENT:h.BEHAVIOR_PERSISTENT;this.inform('beginFetchHandler',{response:x});if(y.bootstrap)this._bootstrapError=false;if(y.type=='lean'){this._leanPayload=z;this._processLean();}else{if(z.coeff2_ts)aa.coeff2_ts=z.coeff2_ts;v.fetchHandler.call(this,x,y);if(y.bootstrap&&!x.getRequest().getData().no_cache)aa.browserCacheHit=(z.timestamp<this._genTime);if(y.bootstrap&&!z.no_data&&this._bootstrapRequestsPending>0){y.bootstrap=false;--this._bootstrapRequestsPending;!this._bootstrapRequestsPending&&this._bootstrapPostProcess();}if(z.no_data||z.stale||z.token!==this._token){var ca=l({},x.getRequest().getData());if(ca.lazy){delete ca.lazy;ca.token=this._token;this._fetchOnUse(ca,y);}}}this.inform('endpointStats',{info:aa,response:x},ba);if(y&&!!y.value)this.inform('completeFetch',{response:x,stats:aa});};w.prototype.respond=function(x,y,z){"use strict";this.inform('respondValidUids',y);this.inform('reorderResults',y);var aa=this.buildData(y,x);aa.forEach(function(ba,ca){ba.origIndex=ca;ba.fromCache=!z;});this.inform('respond',{value:x,results:aa,isAsync:!!z});return aa;};w.prototype.buildData=function(x,y){"use strict";if(!x||x.length===0)return [];var z=x.map(this.getEntry,this);z.length=Math.min(z.length,this._maxResults);return z;};w.prototype.fetchLean=function(){"use strict";this._fetchLean();};w.prototype._isQueryTooShort=function(x){"use strict";return x.length<this._minQueryLength&&!p.hasIdeoOrSyll(x);};w.prototype.shouldFetchMoreResults=function(x){"use strict";return x.length<this._maxResults;};w.prototype._bootstrapPostProcess=function(){"use strict";var x={time:Date.now()};this.inform('bootstrapped',x,h.BEHAVIOR_PERSISTENT);this._processLean();};w.prototype._processLean=function(){"use strict";if(this._leanPayload){var x,y=this._leanPayload.entries;for(var z in y){x=this.getEntry(z);x&&(x.index=y[z]);}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}};w.prototype._updateMaxResults=function(){"use strict";var x=window.innerHeight||document.documentElement.clientHeight;this.setMaxResults(Math.max(this._numResults.min,Math.min(this._numResults.max,Math.ceil(2+((x-370)/56)))));};w.prototype._bootstrapFetch=function(x,y){"use strict";var z=l(y,this.bootstrapData);if(this._criticalOnly&&this._lazyonload)z.lazy=1;this.fetch(this.bootstrapEndpoint,z,{bootstrap:true,type:x});++this._bootstrapRequestsPending;};w.prototype._fetchOnUse=function(x,y){"use strict";for(var z in this.bootstrapData)!x.hasOwnProperty(z)&&(x[z]=this.bootstrapData[z]);if(this._criticalOnly){this._fetchOnUseRequests.push({args:x,ctx:y});}else this.fetch(this.bootstrapEndpoint,x,y);};w.prototype._fetchLean=function(){"use strict";var x={no_cache:1};x.options=m(x.options);x.options.push('lean');this._fetchOnUse(x,{type:'lean'});};w.prototype.bootstrap=function(x){"use strict";if(!x){this._criticalOnly=false;this._flushFetchOnUseRequests();}if(this._bootstrapped)return;var y={filter:['event'],no_cache:1};this._fetchOnUse(y,{type:'event'});var z=['app','page','group','friendlist'];z=z.concat(this._extraTypes||[]);if(this._noMultiFetch){z.push('user');this._bootstrapFetch('user',{filter:z});}else{this._bootstrapFetch('other',{filter:z});if(this._buckets){for(var aa=0;aa<this._buckets.length;++aa){var ba={filter:['user'],buckets:this._buckets[aa]};this._bootstrapFetch('user',ba);}}else this._bootstrapFetch('user',{filter:['user']});}this._fetchLean();this._bootstrapped=true;};w.prototype.getBootstrapError=function(){"use strict";return this._bootstrapError;};w.prototype._flushFetchOnUseRequests=function(){"use strict";var x=this._fetchOnUseRequests.length;for(var y=0;y<x;++y){var z=this._fetchOnUseRequests[y];this.fetch(this.bootstrapEndpoint,z.args,z.ctx);}if(x>0)this.inform('extra_bootstrap',{time:Date.now()},h.BEHAVIOR_PERSISTENT);this._fetchOnUseRequests=[];};w.prototype.onLoad=function(x,y){"use strict";this.inform('onload',{time:Date.now()},h.BEHAVIOR_PERSISTENT);if(x)setTimeout(this.bootstrap.bind(this,y),0);};w.prototype.mergeUids=function(x,y,z,aa){"use strict";var ba=this.getDynamicHashtagResult(aa);if(aa&&ba&&y.indexOf(ba)<=0)y.unshift(ba);var ca=z[0]?this.getEntry(z[0]):null,da=y[0]?this.getEntry(y[0]):null,ea=(ca&&ca.replace_results)?ca:null;ea=(!ea&&da&&da.replace_results)?da:ea;var fa=v.mergeUids.call(this,x,y,z,aa);if(ea){this.inform('backend_topreplace',{});return this.deduplicateByKey([ea.uid].concat(fa));}return fa;};w.prototype.getTextToIndexFromFields=function(x,y){"use strict";var z=[],aa=x.tokenVersion==="v2";for(var ba=0;ba<y.length;++ba){if(aa&&(y[ba]==="text"||y[ba]==="alias"))continue;var ca=x[y[ba]];if(ca)z.push(ca.join?ca.join(' '):ca);}return z.join(' ');};w.prototype.getDynamicHashtagResult=function(x){"use strict";if(!x||!this._enabledHashtag)return;var y=k.getHashtagFromQuery(x);if(!y)return;var z='hashtag:'+y,aa=this.getEntry(z);if(!aa)this.processEntries([k.makeTypeaheadResult(y)],x);return z;};e.exports=w;},null);
__d("legacy:SearchDataSource",["SearchDataSource"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();a.SearchDataSource=b('SearchDataSource');},3);
__d("SearchTypeaheadCore",["Arbiter","DOM","Event","Input","Parent","ScriptPath","TypeaheadCore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q){"use strict";m.call(this,q);}p.prototype.init=function(q,r,s){"use strict";o.init.call(this,q,r,s);var t=k.byTag(s,'form'),u=this.reset.bind(this);g.subscribe('pre_page_transition',function(event,w){var x=/^\/search/,y=x.test(w.from.path),z=x.test(w.to.path);if(y&&!z)setTimeout(u,0);});if(t){var v=h.find(t,'input.search_sid_input');i.listen(t,'submit',function(){if(this.data&&this.data.queryData)v.value=this.data.queryData.sid;setTimeout(u,0);}.bind(this),i.Priority.URGENT);}};p.prototype.select=function(){"use strict";this.reset();this.element.focus();setTimeout((function(){this.element.blur();}).bind(this),0);l.setClickPointInfo({click:'Search'});};p.prototype.handleTab=function(event){"use strict";var q=this.view.getQuerySuggestion(this.value);if(q){j.setValue(this.element,q);this.checkValue();event.kill();}else o.handleTab.call(this,event);};p.prototype.getSearchType=function(){"use strict";return 'regular';};p.prototype.focus=function(){"use strict";o.focus.call(this);if(this.getValue().length===0||this.element.getAttribute('singlestate')==='true')this.data.fetchNullState(this.getValue());};p.prototype.keyup=function(){"use strict";o.keyup.call(this);if(this.getValue().length===0)this.data.fetchNullState(this.getValue());this.element.setAttribute('singlestate',false);};e.exports=p;},null);
__d("legacy:SearchTypeaheadCore",["SearchTypeaheadCore"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();a.SearchTypeaheadCore=b('SearchTypeaheadCore');},3);
__d("SearchPeopleSeeMore",["TokenizeUtil","URI","fbt","invariant"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l,m){"use strict";var n=m.placement,o=m.strategy,p=m.min_users,q=m.query_to_show;this.seeMoreUri=l;this.placement=n;this.strategy=o;this.min_users=p;this.query_to_show=q;}k.prototype.injectInto=function(l,m){"use strict";if(!l||l.length===0)return;var n=this.$SearchPeopleSeeMore0(l,m);if(!n)return;var o=this.createFindAllPeopleResult(n);this.$SearchPeopleSeeMore1(o,l);};k.prototype.$SearchPeopleSeeMore0=function(l,m){"use strict";if(this.strategy==='disabled')return null;if(l[0].type!=='user')return null;var n=l.filter(function(r){return r.type==='user';});if(n.length<this.min_users){return null;}else if(n.length>this.min_users)n=n.slice(0,this.min_users);var o,p=n[0];switch(this.strategy){case 'all_identical':var q=n.every(function(r){return this.$SearchPeopleSeeMore2(p.text,r.text);}.bind(this));o=q?p.text:null;break;case 'top_results_prefix':o=n.reduce(function(r,s){return this.$SearchPeopleSeeMore3(r,s.text);}.bind(this),p.text);break;default:j(false);}if(!o)return null;return this.query_to_show==='common'?o:m;};k.prototype.$SearchPeopleSeeMore1=function(l,m){"use strict";if(this.placement==='last'){var n=m.filter(function(p){return p.type==='user';}).length;m.splice(n,0,l);}else{var o=parseInt(this.placement,10);m.splice(o,0,l);}};k.prototype.createFindAllPeopleResult=function(l){"use strict";var m=i._("Znajd\u017a wszystkie osoby, kt\u00f3re nazywaj\u0105 si\u0119 \u201e{query}\u201d",[i.param("query",l.toLowerCase())]),n=new h(this.seeMoreUri).addQueryData({q:l,init:'psm'}).toString();return {uid:'people_search',type:'user',text:m,classNames:'seeAllUser',photo:'/images/search_typeahead/people_see_more.png',path:n};};k.prototype.$SearchPeopleSeeMore2=function(l,m){"use strict";if(l===m)return true;var n=g.tokenize(l),o=g.tokenize(m);if(n.length!==o.length)return false;return n.every(function(p,q){return p===o[q];});};k.prototype.$SearchPeopleSeeMore3=function(l,m){"use strict";if(!l||!m)return;if(l===m)return l;var n=g.tokenize(l),o=g.tokenize(m),p=[];for(var q=0;q<n.length&&q<o.length;q++)if(n[q]===o[q]){p.push(n[q]);}else break;if(p.length===0)return null;return p.join(' ');};e.exports=k;},null);
__d("SearchPeopleFriendsOf",["TokenizeUtil","URI","fbt"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k,l){"use strict";this.friendsOfUri=k;this.placementStrategy=l.placement_strategy;this.placementParams=l.placement_params;this.triggerStrategy=l.trigger_strategy;this.triggerParams=l.trigger_params;}j.prototype.injectInto=function(k,l){"use strict";if(!k||k.length===0||!this.$SearchPeopleFriendsOf0(k,l))return;if(k[0].type!=="user")return;var m=this.createFindAllFriendsOf(k[0].text,k[0].uid);this.$SearchPeopleFriendsOf1(m,k);};j.prototype.$SearchPeopleFriendsOf1=function(k,l){"use strict";var m=this.$SearchPeopleFriendsOf2(l);if(m==='last'){var n=l.filter(function(o){return o.type==='user';}).length;m=n;}l.splice(m,0,k);};j.prototype.$SearchPeopleFriendsOf0=function(k,l){"use strict";var m=this.$SearchPeopleFriendsOf3(this.triggerStrategy);return m(k,this.triggerParams,l);};j.prototype.$SearchPeopleFriendsOf2=function(k){"use strict";var l=this.$SearchPeopleFriendsOf3(this.placementStrategy);return l(k,this.placementParams);};j.prototype.$SearchPeopleFriendsOf3=function(k){"use strict";return this["$SearchPeopleFriendsOf_"+k];};j.prototype.$SearchPeopleFriendsOf4=function(k,l,m){"use strict";return false;};j.prototype.$SearchPeopleFriendsOf5=function(k,l,m){"use strict";return true;};j.prototype.$SearchPeopleFriendsOf6=function(k,l,m){"use strict";var n=parseInt(l,10),o=0;for(var p=0;p<k.length;p++){var q=k[p];if(q.type==='user'&&q.index_rank==-1)o++;if(o>n)return false;}return true;};j.prototype.$SearchPeopleFriendsOf7=function(k,l,m){"use strict";var n=parseInt(l,10),o=g.tokenize(m);o=o.map(function(w){return w.toLowerCase();});var p=0;for(var q=0;q<k.length;q++){var r=k[q];if(r.type!=='user'||r.index_rank!=-1)continue;var s=g.tokenize(r.text);s=s.map(function(w){return w.toLowerCase();});if(s.length<o.length)continue;var t=true;for(var u=0;u<o.length-1;u++)if(o[u]!==s[u]){t=false;break;}var v=o.length-1;if(t&&s[v].startsWith(o[v])){p++;if(p>=n)return false;}}return true;};j.prototype.$SearchPeopleFriendsOf8=function(k,l){"use strict";return "last";};j.prototype.$SearchPeopleFriendsOf9=function(k,l){"use strict";return 1;};j.prototype.createFindAllFriendsOf=function(k,l){"use strict";var m=i._("Znajomi u\u017cytkownika {name}",[i.param("name",k)]),n=new h(this.friendsOfUri).addQueryData({q:"",init:'psm',fofid:l}).toString();return {uid:'people_search',type:'user',text:m,classNames:'seeAllUser',photo:'/images/search_typeahead/people_see_more.png',logType:'grammar',path:n};};e.exports=j;},null);
__d("SearchTypeaheadView",["Arbiter","ContextualLayerUpdateOnScroll","ContextualTypeaheadView","copyProperties","DOM","goURI","MusicConstants","MusicEvents","SearchPeopleSeeMore","SearchPeopleSeeMoreOptions","SearchPeopleFriendsOf","SearchPeopleFriendsOfOptions","URI","fbt","isEmail"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();for(var v in i)if(i.hasOwnProperty(v))x[v]=i[v];var w=i===null?null:i.prototype;x.prototype=Object.create(w);x.prototype.constructor=x;x.__superConstructor__=i;function x(z,aa){"use strict";i.call(this,z,aa);this._peopleSeeMore=new o(this.getSeeMoreEndpoint('',true),p);this._peopleFriendsOf=new q(this.getSeeMoreEndpoint('',true),r);}x.prototype.initializeLayer=function(){"use strict";w.initializeLayer.call(this);this.layer.setOffsetY(-1);this.layer.enableBehavior(h);};x.prototype.ignoreClick=function(event){"use strict";event.prevent();};x.prototype.render=function(z,aa,ba){"use strict";if(!aa)return;if(this._bucketize)aa=y(aa);if(this.showPeopleSeeMore&&z)this._peopleSeeMore.injectInto(aa,z);if(this.showPeopleFriendsOf&&z)this._peopleFriendsOf.injectInto(aa,z);var ca={results:aa,value:z};this.inform('finalResultsReordering',ca);return w.render.call(this,z,ca.results,ba);};x.prototype.disableBucketization=function(){"use strict";this._bucketize=false;};x.prototype.buildBuckets=function(z,aa){"use strict";var ba=aa.length,ca=0,da;for(da=0;da<ba;++da)if(aa[da].type=='user')ca++;this._redirectToUsersResultsPage=this.showFilterResults&&ca===ba;this.setWebSuggLoggingParams(z,aa);if(!z&&this.showFindPeople)aa.unshift(this.buildFindPeople());if(this._bucketize)aa=w.buildBuckets.call(this,z,aa);if(z&&this._shouldShowSeeMore){aa.push(this.buildSeeMore(z,ba));if(u(z)&&(ca<1))aa.push(this.buildInvite(z));}return aa;};x.prototype.buildFindPeople=function(){"use strict";var z=t._("Znajd\u017a osoby");return {classNames:'seeAllUser seeAllUserNullState',logType:'grammar',path:this.getSeeMoreEndpoint(null,true),photo:'/images/search_typeahead/people_see_more.png',text:z,type:'no_header'};};x.prototype.buildSeeMore=function(z,aa){"use strict";var ba=this.getSeeMoreText(z,aa),ca=this.getSeeMoreSubtext(aa),da=k.create('li',{className:'calltoaction'},[k.create('a',{href:this.getSeeMoreEndpoint(z),rel:'ignore'},[k.create('span',{className:'text'},[k.create('span',{className:'seeMore'},[ba,k.create('span',{className:'arrow'})]),k.create('span',{className:'subtext'},[ca])])])]);da.setAttribute('aria-label',ba);return {uid:'search',node:da,search:true};};x.prototype.getSeeMoreText=function(z,aa){"use strict";if(this.showKeywordResultsPage)return t._("Szukaj \u201e{query}\u201d",[t.param("query",z)]);if(aa<=0)return t._("Zobacz wyniki dla {query}",[t.param("query",z)]);if(this._redirectToUsersResultsPage)return t._("Filtruk wyniki wyszukiwania {query}",[t.param("query",z)]);return t._("Zobacz wi\u0119cej wynik\u00f3w dla {query}",[t.param("query",z)]);};x.prototype.getSeeMoreSubtext=function(z){"use strict";if(z===0)return t._("Brak wynik\u00f3w do wy\u015bwietlenia");if(z===1)return t._("Wy\u015bwietlanie najpopularniejszych wynik\u00f3w");return t._({"*":"Wy\u015bwietlanie {number} najlepszych wynik\u00f3w"},[t.param("number",z,[0])]);};x.prototype.buildInvite=function(z){"use strict";var aa=t._("Zapro\u015b {query} do Facebooka",[t.param("query",z)]),ba=k.create('li',{className:'calltoaction'},[k.create('a',{href:this.getInviteEndpoint(z),rel:'ignore'},[k.create('span',{className:'text'},[k.create('span',{className:'invite'},[aa])])])]);ba.setAttribute('aria-label',aa);return {uid:'invite',node:ba,search:true};};x.prototype.searchPageQueryData=function(z){"use strict";return j({q:z},this.queryData||{});};x.prototype.searchPageTypeData=function(z){"use strict";return this._redirectToUsersResultsPage||z?{type:"users"}:{};};x.prototype.select=function(z){"use strict";var aa=this.index,ba=this.results[aa];if(!ba||ba.type=='header')return;var ca=this.items[aa],da=k.scry(ca,'a')[0];if(ba.song){if(da)n.inform(m.MUSIC_BUTTON.ACTIVATE,da);z&&this.inform('highlight',{index:aa,selected:ba});}else{w.select.call(this,z);if(da&&da.href)if(da.target=='_blank'){window.open(da.href);}else l(da.href);}};x.prototype.setSid=function(z){"use strict";this.queryData.tas=z;};x.prototype.getSeeMoreEndpoint=function(z,aa){"use strict";return new s(this.seeMoreEndpoint).addQueryData(this.searchPageQueryData(z)).addQueryData(this.searchPageTypeData(aa)).toString();};x.prototype.getInviteEndpoint=function(z){"use strict";return new s('/invite.php').addQueryData({email_list:z});};x.prototype.show=function(){"use strict";if(!this.isVisible()){g.inform('layer_shown',{type:'SearchTypeahead'});w.show.call(this);}};x.prototype.hide=function(){"use strict";if(this.isVisible()){g.inform('layer_hidden',{type:'SearchTypeahead'});w.hide.call(this);}};x.prototype.getQuerySuggestion=function(z){"use strict";var aa=this.results[this.index],ba=aa&&aa.type!='header'?aa.text.toLowerCase():'';return ba==z.toLowerCase()?'':ba;};x.prototype.setWebSuggLoggingParams=function(z,aa){"use strict";var ba=0,ca=0;for(var da=0;da<aa.length;da++)if(aa[da].type==='websuggestion'){if(ca===0)ca=da+1;var ea='FR'+(da-ba)+'AS'+ba,fa=da+1;aa[da].path+='&wssk='+ea+'&wssp='+fa+'&wspq='+encodeURIComponent(z);aa[da].path+='&wssrc='+aa[da].websuggestion_source;ba++;}var ga='&wssc='+aa.length+'-'+z.length+'&wsbp='+ba+'-'+ca;for(da=0;da<aa.length;da++)if(aa[da].type==='websuggestion')aa[da].path+=ga;};function y(z){var aa,ba,ca,da,ea=[],fa={};ba=z.length;for(aa=0;aa<ba;aa++){ca=z[aa];da=ca.render_type||ca.type;if(!fa.hasOwnProperty(da)){fa[da]=ea.length;ea.push([]);}ea[fa[da]].push(ca);}var ga=[];ba=ea.length;for(aa=0;aa<ba;++aa){ca=ea[aa][0];da=ca.render_type||ca.type;ga=ga.concat(ea[aa]);}return ga;}j(x.prototype,{_shouldShowSeeMore:true,_bucketize:true,queryData:{init:'quick'}});e.exports=x;},null);
__d("legacy:SearchTypeaheadView",["SearchTypeaheadView"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();a.SearchTypeaheadView=b('SearchTypeaheadView');},3);
__d("legacy:Typeahead",["Typeahead"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();a.Typeahead=b('Typeahead');},3);
__d("SearchTypeaheadRecorder",["AsyncRequest","Banzai","BanzaiNectar","BanzaiScuba","CurrentUser","Event","FacebarGlobalOptions","Keys","TokenizeUtil","Vector","clickRefAction","copyProperties","mapObject","ge","throttle","whitelistObjectKeys"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w={WAITING:'WAITING',SUCCESS:'SUCCESS',NO_RESULTS:'NO_RESULTS',ERROR:'ERROR'};function x(z){"use strict";this.init(z);this.initEvents();}x.prototype.init=function(z){"use strict";this.core=z.getCore();this.data=z.getData();this.view=z.getView();this.element=this.core.getElement();this.initTime=Date.now();this._onloadTime=0;this._extraRecorder=[];this.performanceTimings={};var aa=t('search_first_focus');this.initStartTime=aa&&aa.value;this.bootstrapStats={bootstrapped:0};this.type="legacy_search";this._reset();};x.prototype._reset=function(){"use strict";this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this.backendQueriesStatus={};this._topreplace=false;this._inflightRequests={};var z=Math.random().toString();this.data.setQueryData({sid:z});this.view.setSid(z);this.recordStat('sid',z);this.recordStat('keypressed',0);};x.prototype.initEvents=function(){"use strict";this.core.subscribe('focus',function(event){if(!this.stats.session_start_time){this.recordStat('session_start_time',Date.now());var z=new Date(),aa=z.getTimezoneOffset(),ba=Date.now()-aa*60*1000;this.recordStat('session_start_time_user_timezone',ba);}}.bind(this));this.core.subscribe('blur',function(event){var z=Date.now();for(var aa in this._inflightRequests){var ba=this._inflightRequests[aa],ca=z-ba;this.recordAvgStat('search_endpoint_ms_from_js',ca);}this.recordStat('session_end_time',z);this.submit();}.bind(this));this.view.subscribe('select',function(z,aa){this.recordSelectInfo(aa);}.bind(this));this.view.subscribe('render',function(z,aa){this.recordRender(aa);}.bind(this));this.data.subscribe('logPerformanceTiming',function(z,aa){this.performanceTimings[aa.field]=aa.value;}.bind(this));this.data.subscribe('activity',function(z,aa){this.recordStat('pending_request',aa.activity);}.bind(this));this.data.subscribe('respondValidUids',function(z,aa){this.validUids=aa.slice(0);}.bind(this));this.data.subscribe('beforeQuery',function(z,aa){if(!aa.value){this.query='';this.results=[];this.data.lastNullOrSingleStateFetchStartTime=Date.now();return;}if(!this.stats.first_query_time)this.recordStat('first_query_time',Date.now());this.query=aa.value;if(!this.queryStartTime)this.queryStartTime=[];this.queryStartTime[this.query]=Date.now();this.recordCountStat('num_queries');}.bind(this));this.data.subscribe('queryEndpoint',function(z,aa){this.recordCountStat('num_search_ajax_requests');this.recordAvgStat('endpoint_query_length',aa.value.length);this._inflightRequests[aa.value]=Date.now();}.bind(this));this.data.subscribe('onload',function(z,aa){this._onloadTime=aa.time;}.bind(this));this.data.subscribe('bootstrapped',function(z,aa){this.bootstrapStats.endTime=aa.time;this.bootstrapStats.bootstrapped=1;}.bind(this));this.core.subscribe('recordFunction',function(z,aa){this._extraRecorder.push(aa);}.bind(this));this.data.subscribe('endpointStats',function(z,aa){var ba=aa.info,ca=ba.fetch_end-ba.fetch_start;if(ba.value){this.recordAvgStat('search_endpoint_ms_from_js',ca);}else this.bootstrapStats[ba.type]=ca;if(ba.coeff2_ts)this.bootstrapStats.coeff2_ts=ba.coeff2_ts;if(typeof ba.browserCacheHit!='undefined')this.recordCountStat(ba.browserCacheHit?'bootstrap_cachehits':'bootstrap_cachemisses');if(this._inflightRequests[ba.value])delete this._inflightRequests[ba.value];}.bind(this));this.data.subscribe('fetchComplete',function(z,aa){var ba=aa.entries,ca=aa.value;if(ca&&this.backendQueriesStatus[ca]){this._addDurationForBackendQuery(this.backendQueriesStatus[ca]);this.backendQueriesStatus[ca].status=ba&&ba.length>0?w.SUCCESS:w.NO_RESULTS;}}.bind(this));this.data.subscribe('fetchError',function(z,aa){var ba=aa.fetch_context,ca=ba.value;if(ba.bootstrap||!ca)return;if(this.backendQueriesStatus[ca]){this.backendQueriesStatus[ca].status=w.ERROR;this._addDurationForBackendQuery(this.backendQueriesStatus[ca]);}}.bind(this));this.data.subscribe('query',function(z,aa){this.recordAvgStat('num_results_from_cache',aa.results.length);}.bind(this));this.data.subscribe('backend_topreplace',function(z,aa){if(false===this._topreplace){this.recordStat("backend_topreplace",1);this._topreplace=true;}}.bind(this));this.data.subscribe('completeFetch',function(z,aa){if(this.core.scubaInfo){var ba=aa.response,ca={recv:aa.stats.fetch_end-aa.stats.fetch_start,render:Date.now()-aa.stats.fetch_start,payload_size:JSON.stringify(ba).length};if(!ba.payload.entities)ba.payload.entities=this.buildResults();this.logToScuba(ba,ca,this.core.scubaInfo,this.query,this.type);}}.bind(this));this.data.subscribe('completeCacheFetch',u(function(z,aa){if(this.core.scubaInfo)this.logToScuba({},{},this.core.scubaInfo,this.query,this.type);}.bind(this),500));l.listen(this.element,'keydown',function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(l.getKeyCode(event)==n.BACKSPACE){if(!this._backspacing&&this.query){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.query);}}else this._backspacing=false;}.bind(this));this.data.subscribe('beforeFetch',function(z,aa){var ba=aa.request.data.value;if(!ba)return;this.backendQueries.push(ba);this.backendQueriesStatus[ba]={status:w.WAITING,start_time:Date.now()};}.bind(this));};x.prototype.recordStat=function(z,aa){"use strict";this.stats[z]=aa;};x.prototype.recordCountStat=function(z){"use strict";var aa=this.stats[z];this.stats[z]=aa?aa+1:1;};x.prototype.recordAvgStat=function(z,aa){"use strict";if(this.avgStats[z]){this.avgStats[z][0]+=aa;++this.avgStats[z][1];}else this.avgStats[z]=[aa,1];};x.prototype.recordAppendStat=function(z,aa){"use strict";if(!this.appendStats.hasOwnProperty(z))this.appendStats[z]=[];this.appendStats[z].push(aa);};x.prototype.recordRender=function(z){"use strict";this.results=z.filter(function(ha){return (ha.uid!='search'&&ha.type!='disabled_result'&&ha.type!='header');}).map(function(ha){return r(null,ha);});var aa=null;if(this.queryStartTime)aa=this.queryStartTime[this.query];var ba=this.results.every(function(ha){return ha.fromCache;}),ca=this.results.every(function(ha){return ha.isFromGSEF||ha.fromCache;}),da=this.results.every(function(ha){return ha.isNullState;}),ea=this.results.every(function(ha){return ha.isSingleState;});if(this.results.length&&this.data.lastNullOrSingleStateFetchStartTime&&da){this.recordStat('time_render_null_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}else if(this.data.lastNullOrSingleStateFetchStartTime&&this.results.length&&ea){this.recordStat('time_render_single_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}else if(aa){var fa=Date.now()-aa;this.recordAppendStat(ba?'times_render_local':'times_render_remote',fa);if(!ba&&ca)this.recordAppendStat('time_render_gs_early_fetch',fa);}var ga=p.getViewportDimensions();this.recordStat('window_size_width',ga.x);this.recordStat('window_size_height',ga.y);if(this.results.length>0&&!this.stats.first_result_time)this.recordStat('first_result_time',Date.now());};x.prototype.recordSelectInfo=function(z){"use strict";var aa=z.selected,ba=z.index;if(aa.groupIndex!==(void 0))ba=z.index-aa.groupIndex-1;var ca={href:aa.path},da=aa.dataGT?{gt:JSON.parse(aa.dataGT)}:{};q('click',ca,null,null,da);if(aa.uid=='search'||aa.uid=='people_search'){this.recordStat('selected_search',1);}else if(aa.uid=='invite'){this.recordStat('selected_invite',1);}else{var ea=aa.log_type||aa.rankType||aa.render_type||aa.type,fa=(ea=='friend'?'user':ea);this.recordStat('selected_'+fa,1);this.recordStat('selected_position',ba);this.recordStat('selected_type',ea);this.recordStat('selected_name_length',aa.text.length);this.recordStat('selected_id',aa.uid);this.recordStat('selected_degree',aa.bootstrapped?1:2);this.recordStat('selected_recent_search',aa.recent_search);var ga=o.parse(this.data.getTextToIndex(aa)).tokens,ha=y(ga,this.query);if(ha)this.recordStat('matched_terms',ha);}var ia={};this._extraRecorder.forEach(function(ja){ja(z,this.results,ia);}.bind(this));this.recordStat('extra_select_info',JSON.stringify(ia));if(aa.type==='websuggestion'){this.recordStat('selected_memcached_websuggestion',aa.fromMemcache);this.recordStat('selected_websuggestion_source',aa.websuggestion_source);}this.recordStat('selected_with_mouse',z.clicked?1:0);};x.prototype._addDurationForBackendQuery=function(z){"use strict";if(z.start_time){z.duration=Date.now()-z.start_time;delete z.start_time;}};x.prototype._dataToSubmit=function(){"use strict";this.recordStat('candidate_results',this.buildResults());this.recordStat('query',this.query);this.recordStat('init_time',this.initTime);if(this.initStartTime){this.recordStat('init_start_time',this.initStartTime);this.recordStat('onload_time',this._onloadTime);this.initStartTime=0;}this.recordStat('bootstrapped',this.bootstrapStats.bootstrapped);if(this.bootstrapStats.endTime){this.recordStat('bootstrapped_time',this.bootstrapStats.endTime);this.recordStat('user_bootstrap_ms',this.bootstrapStats.user);this.recordStat('other_bootstrap_ms',this.bootstrapStats.other);this.bootstrapStats.endTime=0;}var z=this.data.getBootstrapError();if(z)this.recordStat('bootstrap_error',1);this.recordStat('coeff2_ts',this.bootstrapStats.coeff2_ts);this.recordStat('max_results',this.data._maxResults);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);var aa=v(this.backendQueriesStatus,this.backendQueries);s(aa,this._addDurationForBackendQuery,this);this.recordStat('backend_queries_status',aa);}if(m.taSessionLoggingSample){var ba=[];this.results.forEach(function(ga){ba.push([ga.text||'',ga.category||'',ga.subtext||'']);});this.recordStat('raw_suggestions_text',ba);}var ca=this.stats;for(var da in this.avgStats){var ea=this.avgStats[da];ca[da]=ea[0]/ea[1];}for(var fa in this.appendStats)ca[fa]=JSON.stringify(this.appendStats[fa]);return ca;};x.prototype.buildResults=function(){"use strict";var z=(this.results||[]).map(function(aa,ba){var ca=o.parse(this.data.getTextToIndex(aa)).tokens,da=aa.rankType||aa.render_type||aa.type,ea=aa.bootstrapped?1:0,fa=aa.s_token||'',ga=(typeof aa.index=='undefined')?100:aa.index,ha=y(ca,this.query)||this.query,ia=aa,ja=ia.index_rank,ka=ia.match_type,la=ia.l_type,ma=ia.vertical_type,na=ia.prefix_match,oa=ia.prefix_length,pa=ia.text,qa=ia.category,ra=ia.subtext,sa=ia.fromCache,ta=ia.isNullState,ua=ia.isSingleState;if(typeof aa.groupIndex=='number')return [aa.groupIndex,aa.indexInGroup,aa.uid,da,ea,fa,ha,ja,ka,na,oa,aa.origIndex,la,ma,pa,qa,ra,ga,sa,ta,ua];return [0,ba,aa.uid,da,ea,fa,ha,ja,ka,na,oa,aa.origIndex,la,ma,pa,qa,ra,ga,sa,ta,ua];}.bind(this));return JSON.stringify(z);};x.prototype.submit=function(){"use strict";var z=this._dataToSubmit();switch(this.data.recordingRoute){case 'banzai_vital':h.post(this._banzaiRoute,z,{delay:0,retry:true});break;default:this.submitThroughAsyncRequest(z);}this._reset();};x.prototype.addLatencyToSample=function(z,aa,ba,ca){"use strict";z.addInteger(ca+'query_start',ba.queryStart);z.addInteger(ca+'query_end',ba.queryEnd);z.addInteger(ca+'keypress_query_end',ba.keyPressToQueryEnd);z.addInteger(ca+'render',ba.render);z.addInteger(ca+'keypress_render',ba.keyPressToRender);aa[ca+'query_start']=ba.queryStart;aa[ca+'query_end']=ba.queryEnd;aa[ca+'keypress_query_end']=ba.keyPressToQueryEnd;aa[ca+'render']=ba.render;aa[ca+'keypress_render']=ba.keyPressToRender;};x.prototype.logToScuba=function(z,aa,ba,ca,da){"use strict";var ea={},fa=new j('search_facebar_js',null,{addBrowserFields:true,addPredictedGeographyFields:true,addUser:true,addSearchVersion:true,addGatekeepers:{facebarGKs:true}});fa.addInteger('sample_rate',ba.sample_rate);ea.sample_rate=ba.sample_rate;fa.addNormal('site',ba.site);ea.site=ba.site;fa.addDenorm('query',ca);ea.query=ca;var ga=z.payload||{};if(ga.entities){fa.addInteger('num_entities',ga.entities.length);ea.num_entities=ga.entities.length;}Object.keys(this.performanceTimings).forEach(function(ia){fa.addInteger(ia,this.performanceTimings[ia]);ea[ia]=this.performanceTimings[ia];}.bind(this),this);if(ga.results||ga.entries){var ha=(ga.results||ga.entries).length;fa.addInteger('num_results',ha);ea.num_results=ha;}if(ga.gzipped_payload_size!==(void 0)){fa.addInteger('gzipped_payload_size',ga.gzipped_payload_size);ea.gzipped_payload_size=ga.gzipped_payload_size;}if(aa.recv&&aa.render>aa.recv){fa.addInteger('time_render',aa.render-aa.recv);ea.time_render=aa.render-aa.recv;fa.addInteger('time_js_async',aa.recv);ea.time_js_async=aa.recv;}if(aa.payload_size){fa.addInteger('payload_size',aa.payload_size);ea.payload_size=aa.payload_size;}if(this.stats.time_render_null_state&&(!ca||ca.length===0)){fa.addInteger('time_render_null_state',this.stats.time_render_null_state);ea.time_render_null_state=this.stats.time_render_null_state;}fa.addInteger('query_id',z.queryId);ea.query_id=z.queryId;fa.addDenorm('user_id',k.getID());ea.user_id=k.getID();fa.addDenorm('session_id',this.stats.sid);ea.session_id=this.stats.sid;fa.addNormal('typeahead_type',da);ea.typeahead_type=da;if(aa.remoteQueryLatencies){this.addLatencyToSample(fa,ea,aa.remoteQueryLatencies,'remote_');fa.addInteger('remote_keypress_query_dispatch',aa.remoteQueryLatencies.keyPressToQueryDispatch);ea.remote_keypress_query_dispatch=aa.remoteQueryLatencies.keyPressToQueryDispatch;fa.addInteger('remote_keypress_query_start',aa.remoteQueryLatencies.keyPressToQueryStart);ea.remote_keypress_query_start=aa.remoteQueryLatencies.keyPressToQueryStart;fa.addNormal('inflight_requests',aa.remoteQueryLatencies.inflightRequests);fa.addInteger('inflight_requests',aa.remoteQueryLatencies.inflightRequests);ea.inflight_requests=aa.remoteQueryLatencies.inflightRequests;fa.addNormal('waiting_queries',aa.remoteQueryLatencies.waitingQueries);fa.addInteger('waiting_queries',aa.remoteQueryLatencies.waitingQueries);ea.waiting_queries=aa.remoteQueryLatencies.waitingQueries;}if(aa.cacheQueryLatencies)this.addLatencyToSample(fa,ea,aa.cacheQueryLatencies,'cache_');fa.post();i.log('search_facebar_js','typeahead',ea);};x.prototype.submitThroughAsyncRequest=function(z){"use strict";if(Object.keys(z).length>0)new g().setURI(this._endPoint).setMethod('POST').setData({stats:z}).setOption('handleErrorAfterUnload',true).setErrorHandler(function(aa){z.retry=true;new g().setURI(this._endPoint).setMethod('POST').setData({stats:z}).setOption('asynchronous',false).send();}.bind(this)).send();};var y=function(z,aa){if(!z||!aa)return;var ba=o.parse(aa);if(ba.flatValue[ba.flatValue.length-1]===' ')return ba.flatValue;var ca=ba.tokens[ba.tokens.length-1],da={};z.forEach(function(ia){da[ia]=(da[ia]||0)+1;});var ea={},fa=ba.tokens.slice(0,ba.tokens.length-1);fa.forEach(function(ia){ea[ia]=(ea[ia]||0)+1;});for(var ga=0;ga<z.length;++ga){var ha=z[ga];if(ha.indexOf(ca)===0&&(da[ha]-(ea[ha]||0)>0)){fa.push(ha);return fa.join(' ');}}return (void 0);};r(x.prototype,{_endPoint:'/ajax/typeahead/record_metrics.php',_banzaiRoute:'search'});e.exports=x;},null);
__d("TypeaheadSearchRecorderBasic",["SearchTypeaheadRecorder","copyProperties","emptyFunction"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this._typeahead=k;}j.prototype.enable=function(){"use strict";new g(this._typeahead);};h(j.prototype,{disable:i});e.exports=j;},null);
__d("legacy:SearchRecorderBasicTypeaheadBehavior",["TypeaheadSearchRecorderBasic"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.searchRecorderBasic=function(h){h.enableBehavior(g);};},3);
__d("SearchTypeaheadRenderer",["BadgeHelper","DOM","fbt","MusicButtonManager","TokenizeUtil","TypeaheadFacepile","URI","WWWBase"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=' \u00B7 ';function p(q,r){var s=[],t=q.photos||q.photo;if(t){if(t instanceof Array){t=l.render(t);}else t=h.create('img',{alt:'',src:t});s.push(t);if(q.song){s.push(h.create('span',{className:'playButton'}));s.push(h.create('span',{className:'playLoader'}));}}var u;if(q.text){var v=q.alias,w=this.value,x=q.text;u=[x];if(v&&k.isQueryMatch(w,v)&&!k.isQueryMatch(w,x))u.push(h.create('span',{className:'alias'},[' \xB7 '+v]));if(q.is_verified){u.push(g.renderBadge('xsmall','verified'));}else if(q.is_work_user)u.push(g.renderBadge('xsmall','work'));s.push(h.create('span',{className:'text'},u));}if(q.category){var y=[q.category];if(q.is_external)y.push(h.create('span',{className:'arrow'}));var z=q.message?'preCategory':'category';s.push(h.create('span',{className:z},y));}if(q.message)s.push(h.create('span',{className:'category'},[q.message]));var aa=q.subtextOverride||q.subtext;if(aa){var ba=[aa];if(q.saved_context){var ca=h.create('span',{className:'saved'},[q.saved_context]);ba.unshift(ca,o);}s.push(h.create('span',{className:'subtext'},ba));}var da=q.classNames||q.type||'',ea=q.is_external?'_blank':'',fa=!q.song&&q.path||'';if(fa){if(!(/^https?\:\/\//).test(fa))fa=n.uri+fa.substr(1);fa+=(fa.indexOf('?')>0?'&':'?')+'ref=ts&fref=ts';}var ga=h.create('a',{href:fa,rel:'ignore',target:ea},s);if(q.song){ga.id='mb_'+(Math.random()*1e+06|0);setTimeout(j.addButton.bind(null,q.song.provider,ga.id,q.song.url,q.song.context,q.song.media_type),0);ga.onclick=this.ignoreClick;}var ha=null;if(q.uid==='recent'&&q.type==='header'){var ia=new m('/profile.php');ia.setQueryData({sk:'allactivity',log_filter:'search'});ha=h.create('a',{href:ia,className:'recentSearchEditLink'},i._("EDYTUJ"));ga.setAttribute('class','recentSearchHeaderLink');da=da+' recentHeader';}var ja=h.create('li',{className:da},[ga,ha]);if(q.text){ja.setAttribute('title',q.text);ja.setAttribute('aria-label',q.text);}return ja;}p.className='search';e.exports=p;},null);
__d("legacy:SearchTypeaheadRenderer",["SearchTypeaheadRenderer"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();if(!a.TypeaheadRenderers)a.TypeaheadRenderers={};a.TypeaheadRenderers.search=b('SearchTypeaheadRenderer');},3);
void(0);
__d("XSearchFacebarSurveyController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/search\/facebar_survey\/",{id:{type:"String",required:true},query:{type:"String"},session_id:{type:"String",required:true}});},null);
__d("AbandonedSessionSurvey",["AsyncRequest","SubscriptionsHandler","XSearchFacebarSurveyController","getOrCreateDOMID"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l){"use strict";this.core=l.getCore();this.data=l.getData();this.view=l.getView();this.subscriptionsHandler=new h();}k.prototype.enable=function(){"use strict";this.subscriptionsHandler.addSubscriptions(this.core.subscribe('focus',function(){this.searchBoxFocused=true;this.resultSelected=false;}.bind(this)),this.data.subscribe('beforeQuery',function(l,m){this.query=m.value||'';}.bind(this)),this.view.subscribe('select',function(){this.resultSelected=true;}.bind(this)),this.core.subscribe('blur',function(){if(this.searchBoxFocused&&!this.resultSelected){this.resultSelected=false;this.searchBoxFocused=false;this.openSurvey();}}.bind(this)));};k.prototype.disable=function(){"use strict";this.subscriptionsHandler.release();this.request&&this.request.abort();};k.prototype.openSurvey=function(){"use strict";if(this.openedSurvey)return;this.openedSurvey=true;var l=i.getURIBuilder().setString('id',j(this.core.element)).setString('query',this.query||'').setString('session_id',this.data.queryData.sid);this.request=(new g()).setMethod('post').setURI(l.getURI());this.request.send();};e.exports=k;},null);
__d("TypeaheadSearchFilter",["Arbiter","copyProperties"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){"use strict";this._typeahead=j;}i.prototype.enable=function(){"use strict";var j=this._typeahead,k=j.getView().seeMoreEndpoint;this._subscriptions=[g.subscribe('search/typeahead/updateFilter',function(l,m){if(m.filter_type=='web')j.getView().queryData.form='FBKBFR';j.getView().queryData.type=m.filter_type;}),g.subscribe('search/typeahead/updateSeeMoreEndpoint',function(l,m){j.getView().seeMoreEndpoint=m;}),g.subscribe('page_transition',function(l,m){if(j.getView().queryData.form)delete j.getView().queryData.form;delete j.getView().queryData.type;j.getView().seeMoreEndpoint=k;},g.SUBSCRIBE_NEW)];};i.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(j){j.unsubscribe();});this._subscriptions=null;};h(i.prototype,{_subscription:null});e.exports=i;},null);
__d("legacy:SearchFilterTypeaheadBehavior",["TypeaheadSearchFilter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.initFilters=function(h){h.enableBehavior(g);};},3);
__d("TypeaheadDetectQueryLocale",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){"use strict";this._typeahead=h;this._data=h.getData();this._queryCache={'':this._data.queryCache,ja_JP:{},zh_TW:{}};}g.prototype.enable=function(){"use strict";this._previousLocale='';this._reset=this._typeahead.subscribe('reset',this._swapQueryCache.bind(this,''));this._beforeQuery=this._data.subscribe('beforeQuery',function(h,i){var j=i.value;if(j===''){this._swapQueryCache('');return;}var k=null,l=j.charCodeAt(j.length-1);if(12352<=l&&l<=12543){k='ja_JP';}else if(12544<=l&&l<=12735)k='zh_TW';this._swapQueryCache(k);}.bind(this));};g.prototype.disable=function(){"use strict";this._swapQueryCache('');this._data.unsubscribe(this._beforeQuery);this._typeahead.ubsubscribe(this._reset);};g.prototype._swapQueryCache=function(h){"use strict";if(h===null||h===this._previousLocale)return;this._data.queryCache=this._queryCache[h];this._data.setQueryData({query_locale:h});this._previousLocale=h;};e.exports=g;},null);
__d("TypeaheadExcludeBootstrapFromQueryCache",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){"use strict";this._data=h.getData();}g.prototype.enable=function(){"use strict";this._buildingQueryCache=false;this._buildQueryCache=this._data.subscribe('buildQueryCache',function(){this._buildingQueryCache=true;}.bind(this));this._mergeUids=this._data.subscribe('mergeUids',function(h,i){if(this._buildingQueryCache)i.local_uids.splice(0,i.local_uids.length);}.bind(this));this._fetchComplete=this._data.subscribe('fetchComplete',function(){this._buildingQueryCache=false;}.bind(this));};g.prototype.disable=function(){"use strict";this._data.unsubscribe(this._buildQueryCache);this._data.unsubscribe(this._mergeUids);this._data.unsubscribe(this._fetchComplete);};e.exports=g;},null);
__d("TypeaheadRecentSearchUpdater",["Arbiter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i){"use strict";this.view=i.getView();}h.prototype.enable=function(){"use strict";this.updaterSubscription=this.view.subscribe('select',function(){g.inform('search/refreshRecentSearchesNullstate',{},g.BEHAVIOR_STATE);});};h.prototype.disable=function(){"use strict";this.view.unsubscribe(this.updaterSubscription);};e.exports=h;},null);